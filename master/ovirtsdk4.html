<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 15.0.4"/>
    <title>ovirtsdk4 API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note{color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.tip{color:#0a3622;background-color:#d1e7dd;border-color:#a3cfbb;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%230a3622%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2%206a6%206%200%201%201%2010.174%204.31c-.203.196-.359.4-.453.619l-.762%201.769A.5.5%200%200%201%2010.5%2013a.5.5%200%200%201%200%201%20.5.5%200%200%201%200%201l-.224.447a1%201%200%200%201-.894.553H6.618a1%201%200%200%201-.894-.553L5.5%2015a.5.5%200%200%201%200-1%20.5.5%200%200%201%200-1%20.5.5%200%200%201-.46-.302l-.761-1.77a2%202%200%200%200-.453-.618A5.98%205.98%200%200%201%202%206m6-5a5%205%200%200%200-3.479%208.592c.263.254.514.564.676.941L5.83%2012h4.342l.632-1.467c.162-.377.413-.687.676-.941A5%205%200%200%200%208%201%22/%3E%3C/svg%3E");}.pdoc .alert.important{color:#055160;background-color:#cff4fc;border-color:#9eeaf9;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23055160%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2%200a2%202%200%200%200-2%202v12a2%202%200%200%200%202%202h12a2%202%200%200%200%202-2V2a2%202%200%200%200-2-2zm6%204c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%204.995A.905.905%200%200%201%208%204m.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.caution{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M11.46.146A.5.5%200%200%200%2011.107%200H4.893a.5.5%200%200%200-.353.146L.146%204.54A.5.5%200%200%200%200%204.893v6.214a.5.5%200%200%200%20.146.353l4.394%204.394a.5.5%200%200%200%20.353.146h6.214a.5.5%200%200%200%20.353-.146l4.394-4.394a.5.5%200%200%200%20.146-.353V4.893a.5.5%200%200%200-.146-.353zM8%204c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%204.995A.905.905%200%200%201%208%204m.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */.decorator{display:none;}</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>

            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>


            <h2>Submodules</h2>
            <ul>
                    <li><a href="ovirtsdk4/http.html">http</a></li>
                    <li><a href="ovirtsdk4/reader.html">reader</a></li>
                    <li><a href="ovirtsdk4/readers.html">readers</a></li>
                    <li><a href="ovirtsdk4/service.html">service</a></li>
                    <li><a href="ovirtsdk4/services.html">services</a></li>
                    <li><a href="ovirtsdk4/types.html">types</a></li>
                    <li><a href="ovirtsdk4/version.html">version</a></li>
                    <li><a href="ovirtsdk4/writer.html">writer</a></li>
                    <li><a href="ovirtsdk4/writers.html">writers</a></li>
                    <li><a href="ovirtsdk4/xml.html">xml</a></li>
            </ul>

            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="function" href="#get_version">get_version</a>
            </li>
            <li>
                    <a class="class" href="#Error">Error</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Error.__init__">Error</a>
                        </li>
                        <li>
                                <a class="variable" href="#Error.code">code</a>
                        </li>
                        <li>
                                <a class="variable" href="#Error.fault">fault</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#AuthError">AuthError</a>
                            <ul class="memberlist">
                </ul>

            </li>
            <li>
                    <a class="class" href="#ConnectionError">ConnectionError</a>
                            <ul class="memberlist">
                </ul>

            </li>
            <li>
                    <a class="class" href="#NotFoundError">NotFoundError</a>
                            <ul class="memberlist">
                </ul>

            </li>
            <li>
                    <a class="class" href="#TimeoutError">TimeoutError</a>
                            <ul class="memberlist">
                </ul>

            </li>
            <li>
                    <a class="class" href="#List">List</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#List.__init__">List</a>
                        </li>
                        <li>
                                <a class="variable" href="#List.href">href</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Struct">Struct</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Struct.__init__">Struct</a>
                        </li>
                        <li>
                                <a class="variable" href="#Struct.href">href</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Connection">Connection</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Connection.__init__">Connection</a>
                        </li>
                        <li>
                                <a class="function" href="#Connection.send">send</a>
                        </li>
                        <li>
                                <a class="function" href="#Connection.authenticate">authenticate</a>
                        </li>
                        <li>
                                <a class="function" href="#Connection.wait">wait</a>
                        </li>
                        <li>
                                <a class="variable" href="#Connection.url">url</a>
                        </li>
                        <li>
                                <a class="function" href="#Connection.system_service">system_service</a>
                        </li>
                        <li>
                                <a class="function" href="#Connection.service">service</a>
                        </li>
                        <li>
                                <a class="function" href="#Connection.test">test</a>
                        </li>
                        <li>
                                <a class="function" href="#Connection.is_link">is_link</a>
                        </li>
                        <li>
                                <a class="function" href="#Connection.follow_link">follow_link</a>
                        </li>
                        <li>
                                <a class="function" href="#Connection.close">close</a>
                        </li>
                        <li>
                                <a class="function" href="#Connection.check_xml_content_type">check_xml_content_type</a>
                        </li>
                        <li>
                                <a class="function" href="#Connection.check_json_content_type">check_json_content_type</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#ConnectionBuilder">ConnectionBuilder</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#ConnectionBuilder.__init__">ConnectionBuilder</a>
                        </li>
                        <li>
                                <a class="function" href="#ConnectionBuilder.build">build</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
ovirtsdk4    </h1>

                
                        <input id="mod-ovirtsdk4-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-ovirtsdk4-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">   1</span></a><span class="c1"># -*- coding: utf-8 -*-</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">   2</span></a>
</span><span id="L-3"><a href="#L-3"><span class="linenos">   3</span></a><span class="c1">#</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">   4</span></a><span class="c1"># Copyright (c) 2016 Red Hat, Inc.</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">   5</span></a><span class="c1">#</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">   6</span></a><span class="c1"># Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">   7</span></a><span class="c1"># you may not use this file except in compliance with the License.</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">   8</span></a><span class="c1"># You may obtain a copy of the License at</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">   9</span></a><span class="c1">#</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos">  10</span></a><span class="c1">#   http://www.apache.org/licenses/LICENSE-2.0</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos">  11</span></a><span class="c1">#</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos">  12</span></a><span class="c1"># Unless required by applicable law or agreed to in writing, software</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos">  13</span></a><span class="c1"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos">  14</span></a><span class="c1"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos">  15</span></a><span class="c1"># See the License for the specific language governing permissions and</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos">  16</span></a><span class="c1"># limitations under the License.</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos">  17</span></a><span class="c1">#</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos">  18</span></a>
</span><span id="L-19"><a href="#L-19"><span class="linenos">  19</span></a><span class="kn">import</span> <span class="nn">io</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos">  20</span></a><span class="kn">import</span> <span class="nn">json</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos">  21</span></a><span class="kn">import</span> <span class="nn">os</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos">  22</span></a><span class="kn">import</span> <span class="nn">pycurl</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos">  23</span></a><span class="kn">import</span> <span class="nn">re</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos">  24</span></a><span class="kn">import</span> <span class="nn">sys</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos">  25</span></a><span class="kn">import</span> <span class="nn">threading</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos">  26</span></a>
</span><span id="L-27"><a href="#L-27"><span class="linenos">  27</span></a><span class="k">try</span><span class="p">:</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos">  28</span></a>    <span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">urlencode</span><span class="p">,</span> <span class="n">urlparse</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos">  29</span></a><span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos">  30</span></a>    <span class="kn">from</span> <span class="nn">urllib</span> <span class="kn">import</span> <span class="n">urlencode</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos">  31</span></a>    <span class="kn">from</span> <span class="nn">urlparse</span> <span class="kn">import</span> <span class="n">urlparse</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos">  32</span></a>
</span><span id="L-33"><a href="#L-33"><span class="linenos">  33</span></a><span class="kn">from</span> <span class="nn">ovirtsdk4.http</span> <span class="kn">import</span> <span class="n">Response</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos">  34</span></a>
</span><span id="L-35"><a href="#L-35"><span class="linenos">  35</span></a>
</span><span id="L-36"><a href="#L-36"><span class="linenos">  36</span></a><span class="k">def</span> <span class="nf">get_version</span><span class="p">():</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos">  37</span></a>    <span class="kn">from</span> <span class="nn">ovirtsdk4</span> <span class="kn">import</span> <span class="n">version</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos">  38</span></a>    <span class="k">return</span> <span class="n">version</span><span class="o">.</span><span class="n">VERSION</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos">  39</span></a>
</span><span id="L-40"><a href="#L-40"><span class="linenos">  40</span></a>
</span><span id="L-41"><a href="#L-41"><span class="linenos">  41</span></a><span class="k">class</span> <span class="nc">Error</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos">  42</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos">  43</span></a><span class="sd">    General exception which is thrown by SDK,</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos">  44</span></a><span class="sd">    indicates that some exception happened in SDK.</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos">  45</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos">  46</span></a>
</span><span id="L-47"><a href="#L-47"><span class="linenos">  47</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">code</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fault</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos">  48</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos">  49</span></a><span class="sd">        Creates an instance of Error class.</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos">  50</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos">  51</span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">Error</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos">  52</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos">  53</span></a><span class="sd">        Creates an instance of Error class.</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos">  54</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos">  55</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">code</span> <span class="o">=</span> <span class="n">code</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos">  56</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos">  57</span></a><span class="sd">        An error code associated to the error. For HTTP related</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos">  58</span></a><span class="sd">        errors, this will be the HTTP response code returned by the server.</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos">  59</span></a><span class="sd">        For example, if retrieving of a virtual machine fails because it</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos">  60</span></a><span class="sd">        doesn&#39;t exist this attribute will contain the integer value 404. Note</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos">  61</span></a><span class="sd">        that this may be `nil` if the error is not HTTP related.&quot;&quot;&quot;</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos">  62</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fault</span> <span class="o">=</span> <span class="n">fault</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos">  63</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos">  64</span></a><span class="sd">        The `Fault` object associated to the error.</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos">  65</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos">  66</span></a>
</span><span id="L-67"><a href="#L-67"><span class="linenos">  67</span></a>
</span><span id="L-68"><a href="#L-68"><span class="linenos">  68</span></a><span class="k">class</span> <span class="nc">AuthError</span><span class="p">(</span><span class="n">Error</span><span class="p">):</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos">  69</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos">  70</span></a><span class="sd">    This class of error indicates that an authentiation or authorization</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos">  71</span></a><span class="sd">    problem happenend, like incorrect user name, incorrect password, or</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos">  72</span></a><span class="sd">    missing permissions.</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos">  73</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos">  74</span></a>    <span class="k">pass</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos">  75</span></a>
</span><span id="L-76"><a href="#L-76"><span class="linenos">  76</span></a>
</span><span id="L-77"><a href="#L-77"><span class="linenos">  77</span></a><span class="k">class</span> <span class="nc">ConnectionError</span><span class="p">(</span><span class="n">Error</span><span class="p">):</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos">  78</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos">  79</span></a><span class="sd">    This class of error indicates that the name of the server or the name of</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos">  80</span></a><span class="sd">    the proxy can&#39;t be resolved to an IP address, or that the connection</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos">  81</span></a><span class="sd">    can&#39;t be stablished because the server is down or unreachable.</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos">  82</span></a>
</span><span id="L-83"><a href="#L-83"><span class="linenos">  83</span></a><span class="sd">    Note that for this class of error the `code` and `fault` attributes will</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos">  84</span></a><span class="sd">    always be empty, as no response from the server will be available to</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos">  85</span></a><span class="sd">    populate them.</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos">  86</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos">  87</span></a>    <span class="k">pass</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos">  88</span></a>
</span><span id="L-89"><a href="#L-89"><span class="linenos">  89</span></a>
</span><span id="L-90"><a href="#L-90"><span class="linenos">  90</span></a><span class="k">class</span> <span class="nc">NotFoundError</span><span class="p">(</span><span class="n">Error</span><span class="p">):</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos">  91</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos">  92</span></a><span class="sd">    This class of error indicates that an object can&#39;t be found.</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos">  93</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos">  94</span></a>    <span class="k">pass</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos">  95</span></a>
</span><span id="L-96"><a href="#L-96"><span class="linenos">  96</span></a>
</span><span id="L-97"><a href="#L-97"><span class="linenos">  97</span></a><span class="k">class</span> <span class="nc">TimeoutError</span><span class="p">(</span><span class="n">Error</span><span class="p">):</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos">  98</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos">  99</span></a><span class="sd">    This class of error indicates that an operation timed out.</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos"> 100</span></a>
</span><span id="L-101"><a href="#L-101"><span class="linenos"> 101</span></a><span class="sd">    Note that for this class of error the `code` and `fault` attributes will</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos"> 102</span></a><span class="sd">    always be empty, as no response from the server will be available to</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos"> 103</span></a><span class="sd">    populate them.</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos"> 104</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos"> 105</span></a>    <span class="k">pass</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos"> 106</span></a>
</span><span id="L-107"><a href="#L-107"><span class="linenos"> 107</span></a>
</span><span id="L-108"><a href="#L-108"><span class="linenos"> 108</span></a><span class="k">class</span> <span class="nc">List</span><span class="p">(</span><span class="nb">list</span><span class="p">):</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos"> 109</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos"> 110</span></a><span class="sd">    This is the base class for all the list types of the SDK. It contains the</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos"> 111</span></a><span class="sd">    utility methods used by all of them.</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos"> 112</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos"> 113</span></a>
</span><span id="L-114"><a href="#L-114"><span class="linenos"> 114</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">href</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos"> 115</span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">List</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos"> 116</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_href</span> <span class="o">=</span> <span class="n">href</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos"> 117</span></a>
</span><span id="L-118"><a href="#L-118"><span class="linenos"> 118</span></a>    <span class="nd">@property</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos"> 119</span></a>    <span class="k">def</span> <span class="nf">href</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos"> 120</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos"> 121</span></a><span class="sd">        Returns the value of the `href` attribute.</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos"> 122</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos"> 123</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_href</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos"> 124</span></a>
</span><span id="L-125"><a href="#L-125"><span class="linenos"> 125</span></a>    <span class="nd">@href</span><span class="o">.</span><span class="n">setter</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos"> 126</span></a>    <span class="k">def</span> <span class="nf">href</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos"> 127</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos"> 128</span></a><span class="sd">        Sets the value of the `href` attribute.</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos"> 129</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos"> 130</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_href</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos"> 131</span></a>
</span><span id="L-132"><a href="#L-132"><span class="linenos"> 132</span></a>
</span><span id="L-133"><a href="#L-133"><span class="linenos"> 133</span></a><span class="k">class</span> <span class="nc">Struct</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos"> 134</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos"> 135</span></a><span class="sd">    This is the base class for all the struct types of the SDK. It contains</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos"> 136</span></a><span class="sd">    the utility methods used by all of them.</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos"> 137</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos"> 138</span></a>
</span><span id="L-139"><a href="#L-139"><span class="linenos"> 139</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">href</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos"> 140</span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">Struct</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos"> 141</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_href</span> <span class="o">=</span> <span class="n">href</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos"> 142</span></a>
</span><span id="L-143"><a href="#L-143"><span class="linenos"> 143</span></a>    <span class="nd">@property</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos"> 144</span></a>    <span class="k">def</span> <span class="nf">href</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos"> 145</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos"> 146</span></a><span class="sd">        Returns the value of the `href` attribute.</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos"> 147</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos"> 148</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_href</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos"> 149</span></a>
</span><span id="L-150"><a href="#L-150"><span class="linenos"> 150</span></a>    <span class="nd">@href</span><span class="o">.</span><span class="n">setter</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos"> 151</span></a>    <span class="k">def</span> <span class="nf">href</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos"> 152</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos"> 153</span></a><span class="sd">        Sets the value of the `href` attribute.</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos"> 154</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos"> 155</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_href</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos"> 156</span></a>
</span><span id="L-157"><a href="#L-157"><span class="linenos"> 157</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos"> 158</span></a>    <span class="k">def</span> <span class="nf">_check_type</span><span class="p">(</span><span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">expected</span><span class="p">):</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos"> 159</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos"> 160</span></a><span class="sd">        Checks that the given types match, and generates an exception if</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos"> 161</span></a><span class="sd">        they don&#39;t.</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos"> 162</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos"> 163</span></a>        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos"> 164</span></a>            <span class="n">actual</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos"> 165</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">actual</span> <span class="o">==</span> <span class="n">expected</span><span class="p">:</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos"> 166</span></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">((</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos"> 167</span></a>                    <span class="s2">&quot;The type &#39;</span><span class="si">{actual}</span><span class="s2">&#39; isn&#39;t valid for &quot;</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos"> 168</span></a>                    <span class="s2">&quot;attribute &#39;</span><span class="si">{attribute}</span><span class="s2">&#39;, it must be &quot;</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos"> 169</span></a>                    <span class="s2">&quot;&#39;</span><span class="si">{expected}</span><span class="s2">&#39;&quot;</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos"> 170</span></a>                <span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos"> 171</span></a>                    <span class="n">attribute</span><span class="o">=</span><span class="n">attribute</span><span class="p">,</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos"> 172</span></a>                    <span class="n">actual</span><span class="o">=</span><span class="n">actual</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos"> 173</span></a>                    <span class="n">expected</span><span class="o">=</span><span class="n">expected</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos"> 174</span></a>                <span class="p">))</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos"> 175</span></a>
</span><span id="L-176"><a href="#L-176"><span class="linenos"> 176</span></a>
</span><span id="L-177"><a href="#L-177"><span class="linenos"> 177</span></a><span class="k">class</span> <span class="nc">Connection</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos"> 178</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos"> 179</span></a><span class="sd">    This class is responsible for managing an HTTP connection to the engine</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos"> 180</span></a><span class="sd">    server. It is intended as the entry point for the SDK, and it provides</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos"> 181</span></a><span class="sd">    access to the `system` service and, from there, to the rest of the</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos"> 182</span></a><span class="sd">    services provided by the API.</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos"> 183</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos"> 184</span></a>
</span><span id="L-185"><a href="#L-185"><span class="linenos"> 185</span></a>    <span class="c1"># Regular expression used to check XML content type.</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos"> 186</span></a>    <span class="n">__XML_CONTENT_TYPE_RE</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^\s*(application|text)/xml\s*(;.*)?$&quot;</span><span class="p">)</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos"> 187</span></a>
</span><span id="L-188"><a href="#L-188"><span class="linenos"> 188</span></a>    <span class="c1"># Regular expression used to check JSON content type.</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos"> 189</span></a>    <span class="n">__JSON_CONTENT_TYPE_RE</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^\s*(application|text)/json\s*(;.*)?$&quot;</span><span class="p">)</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos"> 190</span></a>
</span><span id="L-191"><a href="#L-191"><span class="linenos"> 191</span></a>    <span class="c1"># The typical URL path, used just to generate informative error messages.</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos"> 192</span></a>    <span class="n">__TYPICAL_PATH</span> <span class="o">=</span> <span class="s1">&#39;/ovirt-engine/api&#39;</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos"> 193</span></a>
</span><span id="L-194"><a href="#L-194"><span class="linenos"> 194</span></a>    <span class="c1"># Debug types that we know how to handle. Everything else will be</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos"> 195</span></a>    <span class="c1"># silently ignored.</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos"> 196</span></a>    <span class="n">__KNOWN_DEBUG_TYPES</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos"> 197</span></a>        <span class="n">pycurl</span><span class="o">.</span><span class="n">INFOTYPE_TEXT</span><span class="p">,</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos"> 198</span></a>        <span class="n">pycurl</span><span class="o">.</span><span class="n">INFOTYPE_HEADER_IN</span><span class="p">,</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos"> 199</span></a>        <span class="n">pycurl</span><span class="o">.</span><span class="n">INFOTYPE_HEADER_OUT</span><span class="p">,</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos"> 200</span></a>        <span class="n">pycurl</span><span class="o">.</span><span class="n">INFOTYPE_DATA_IN</span><span class="p">,</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos"> 201</span></a>        <span class="n">pycurl</span><span class="o">.</span><span class="n">INFOTYPE_DATA_OUT</span><span class="p">,</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos"> 202</span></a>    <span class="p">]</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos"> 203</span></a>
</span><span id="L-204"><a href="#L-204"><span class="linenos"> 204</span></a>    <span class="c1"># Prefixes to use for debug data types:</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos"> 205</span></a>    <span class="n">__DEBUG_PREFIXES</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos"> 206</span></a>        <span class="n">pycurl</span><span class="o">.</span><span class="n">INFOTYPE_TEXT</span><span class="p">:</span> <span class="s1">&#39;* &#39;</span><span class="p">,</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos"> 207</span></a>        <span class="n">pycurl</span><span class="o">.</span><span class="n">INFOTYPE_HEADER_IN</span><span class="p">:</span> <span class="s1">&#39;&gt; &#39;</span><span class="p">,</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos"> 208</span></a>        <span class="n">pycurl</span><span class="o">.</span><span class="n">INFOTYPE_HEADER_OUT</span><span class="p">:</span> <span class="s1">&#39;&lt; &#39;</span><span class="p">,</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos"> 209</span></a>        <span class="n">pycurl</span><span class="o">.</span><span class="n">INFOTYPE_DATA_IN</span><span class="p">:</span> <span class="s1">&#39;&gt; &#39;</span><span class="p">,</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos"> 210</span></a>        <span class="n">pycurl</span><span class="o">.</span><span class="n">INFOTYPE_DATA_OUT</span><span class="p">:</span> <span class="s1">&#39;&lt; &#39;</span><span class="p">,</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos"> 211</span></a>    <span class="p">}</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos"> 212</span></a>
</span><span id="L-213"><a href="#L-213"><span class="linenos"> 213</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos"> 214</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos"> 215</span></a>        <span class="n">url</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos"> 216</span></a>        <span class="n">username</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos"> 217</span></a>        <span class="n">password</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos"> 218</span></a>        <span class="n">token</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos"> 219</span></a>        <span class="n">insecure</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos"> 220</span></a>        <span class="n">ca_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos"> 221</span></a>        <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos"> 222</span></a>        <span class="n">log</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos"> 223</span></a>        <span class="n">kerberos</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos"> 224</span></a>        <span class="n">timeout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos"> 225</span></a>        <span class="n">compress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos"> 226</span></a>        <span class="n">sso_url</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos"> 227</span></a>        <span class="n">sso_revoke_url</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos"> 228</span></a>        <span class="n">sso_token_name</span><span class="o">=</span><span class="s1">&#39;access_token&#39;</span><span class="p">,</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos"> 229</span></a>        <span class="n">headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos"> 230</span></a>        <span class="n">pipeline</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos"> 231</span></a>        <span class="n">connections</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos"> 232</span></a>    <span class="p">):</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos"> 233</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos"> 234</span></a><span class="sd">        Creates a new connection to the API server.</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos"> 235</span></a>
</span><span id="L-236"><a href="#L-236"><span class="linenos"> 236</span></a><span class="sd">        This method supports the following parameters:</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos"> 237</span></a>
</span><span id="L-238"><a href="#L-238"><span class="linenos"> 238</span></a><span class="sd">        `url` \n</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos"> 239</span></a><span class="sd">        A string containing the base URL of the server, usually</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos"> 240</span></a><span class="sd">        something like `https://server.example.com/ovirt-engine/api`.</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos"> 241</span></a>
</span><span id="L-242"><a href="#L-242"><span class="linenos"> 242</span></a><span class="sd">        `username` \n</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos"> 243</span></a><span class="sd">        The name of the user, something like `admin@internal`.</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos"> 244</span></a>
</span><span id="L-245"><a href="#L-245"><span class="linenos"> 245</span></a><span class="sd">        `password` \n</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos"> 246</span></a><span class="sd">        The name password of the user.</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos"> 247</span></a>
</span><span id="L-248"><a href="#L-248"><span class="linenos"> 248</span></a><span class="sd">        `token` \n</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos"> 249</span></a><span class="sd">        The token to be used to access API. Optionally, user can</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos"> 250</span></a><span class="sd">        use token, instead of username and password to access API. If user</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos"> 251</span></a><span class="sd">        don&#39;t specify `token` parameter, SDK will automatically create one.</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos"> 252</span></a>
</span><span id="L-253"><a href="#L-253"><span class="linenos"> 253</span></a><span class="sd">        `insecure` \n</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos"> 254</span></a><span class="sd">        A boolean flag that indicates if the server TLS</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos"> 255</span></a><span class="sd">        certificate and host name should be checked.</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos"> 256</span></a>
</span><span id="L-257"><a href="#L-257"><span class="linenos"> 257</span></a><span class="sd">        `ca_file` \n</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos"> 258</span></a><span class="sd">        A PEM file containing the trusted CA certificates. The</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos"> 259</span></a><span class="sd">        certificate presented by the server will be verified using these CA</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos"> 260</span></a><span class="sd">        certificates. If `ca_file` parameter is not set, system wide</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos"> 261</span></a><span class="sd">        CA certificate store is used.</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos"> 262</span></a>
</span><span id="L-263"><a href="#L-263"><span class="linenos"> 263</span></a><span class="sd">        `debug` \n</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos"> 264</span></a><span class="sd">        A boolean flag indicating if debug output should be</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos"> 265</span></a><span class="sd">        generated. If the value is `True` and the `log` parameter isn&#39;t</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos"> 266</span></a><span class="sd">        `None` then the data sent to and received from the server will</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos"> 267</span></a><span class="sd">        be written to the log. Be aware that user names and passwords will</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos"> 268</span></a><span class="sd">        also be written, so handle it with care.</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos"> 269</span></a>
</span><span id="L-270"><a href="#L-270"><span class="linenos"> 270</span></a><span class="sd">        `log` \n</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos"> 271</span></a><span class="sd">        The logger where the log messages will be written.</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos"> 272</span></a>
</span><span id="L-273"><a href="#L-273"><span class="linenos"> 273</span></a><span class="sd">        `kerberos` \n</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos"> 274</span></a><span class="sd">        A boolean flag indicating if Kerberos</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos"> 275</span></a><span class="sd">        authentication should be used instead of the default basic</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos"> 276</span></a><span class="sd">        authentication.</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos"> 277</span></a>
</span><span id="L-278"><a href="#L-278"><span class="linenos"> 278</span></a><span class="sd">        `timeout` \n</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos"> 279</span></a><span class="sd">        The maximum total time to wait for the response, in</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos"> 280</span></a><span class="sd">        seconds. A value of zero (the default) means wait for ever. If</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos"> 281</span></a><span class="sd">        the timeout expires before the response is received an exception</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos"> 282</span></a><span class="sd">        will be raised.</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos"> 283</span></a>
</span><span id="L-284"><a href="#L-284"><span class="linenos"> 284</span></a><span class="sd">        `compress` \n</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos"> 285</span></a><span class="sd">        A boolean flag indicating if the SDK should ask</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos"> 286</span></a><span class="sd">        the server to send compressed responses. The default is `True`.</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos"> 287</span></a><span class="sd">        Note that this is a hint for the server, and that it may return</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos"> 288</span></a><span class="sd">        uncompressed data even when this parameter is set to `True`.</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos"> 289</span></a><span class="sd">        Note that compression will be disabled if user pass `debug`</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos"> 290</span></a><span class="sd">        parameter set to `true`, so the debug messages are in plain text.</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos"> 291</span></a>
</span><span id="L-292"><a href="#L-292"><span class="linenos"> 292</span></a><span class="sd">        `sso_url` \n</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos"> 293</span></a><span class="sd">        A string containing the base SSO URL of the serve.</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos"> 294</span></a><span class="sd">        Default SSO url is computed from the `url` if no `sso_url` is provided.</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos"> 295</span></a>
</span><span id="L-296"><a href="#L-296"><span class="linenos"> 296</span></a><span class="sd">        `sso_revoke_url` \n</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos"> 297</span></a><span class="sd">        A string containing the base URL of the SSO</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos"> 298</span></a><span class="sd">        revoke service. This needs to be specified only when using</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos"> 299</span></a><span class="sd">        an external authentication service. By default this URL</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos"> 300</span></a><span class="sd">        is automatically calculated from the value of the `url` parameter,</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos"> 301</span></a><span class="sd">        so that SSO token revoke will be performed using the SSO service</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos"> 302</span></a><span class="sd">        that is part of the engine.</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos"> 303</span></a>
</span><span id="L-304"><a href="#L-304"><span class="linenos"> 304</span></a><span class="sd">        `sso_token_name` \n</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos"> 305</span></a><span class="sd">        The token name in the JSON SSO response returned</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos"> 306</span></a><span class="sd">        from the SSO server. Default value is `access_token`.</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos"> 307</span></a>
</span><span id="L-308"><a href="#L-308"><span class="linenos"> 308</span></a><span class="sd">        `headers` \n</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos"> 309</span></a><span class="sd">        A dictionary with headers which should be send with every</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos"> 310</span></a><span class="sd">        request.</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos"> 311</span></a>
</span><span id="L-312"><a href="#L-312"><span class="linenos"> 312</span></a><span class="sd">        `connections` \n</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos"> 313</span></a><span class="sd">        The maximum number of connections to open to the host.</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos"> 314</span></a><span class="sd">        If the value is `0` (the default) then the number of connections will</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos"> 315</span></a><span class="sd">        be unlimited.</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos"> 316</span></a>
</span><span id="L-317"><a href="#L-317"><span class="linenos"> 317</span></a><span class="sd">        `pipeline` \n</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos"> 318</span></a><span class="sd">        The maximum number of request to put in an HTTP pipeline</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos"> 319</span></a><span class="sd">        without waiting for the response. If the value is `0` (the default)</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos"> 320</span></a><span class="sd">        then pipelining is disabled.</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos"> 321</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos"> 322</span></a>
</span><span id="L-323"><a href="#L-323"><span class="linenos"> 323</span></a>        <span class="c1"># Check mandatory parameters:</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos"> 324</span></a>        <span class="k">if</span> <span class="n">url</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos"> 325</span></a>            <span class="k">raise</span> <span class="n">Error</span><span class="p">(</span><span class="s1">&#39;The </span><span class="se">\&#39;</span><span class="s1">url</span><span class="se">\&#39;</span><span class="s1"> parameter is mandatory&#39;</span><span class="p">)</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos"> 326</span></a>
</span><span id="L-327"><a href="#L-327"><span class="linenos"> 327</span></a>        <span class="c1"># Check that the CA file exists if insecure is not set:</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos"> 328</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">insecure</span><span class="p">:</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos"> 329</span></a>            <span class="k">if</span> <span class="n">ca_file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">ca_file</span><span class="p">):</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos"> 330</span></a>                <span class="k">raise</span> <span class="n">Error</span><span class="p">(</span><span class="s1">&#39;The CA file </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1"> doesn</span><span class="se">\&#39;</span><span class="s1">t exist&#39;</span> <span class="o">%</span> <span class="n">ca_file</span><span class="p">)</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos"> 331</span></a>
</span><span id="L-332"><a href="#L-332"><span class="linenos"> 332</span></a>        <span class="c1"># Save the URL:</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos"> 333</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_url</span> <span class="o">=</span> <span class="n">url</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos"> 334</span></a>
</span><span id="L-335"><a href="#L-335"><span class="linenos"> 335</span></a>        <span class="c1"># Save the logger:</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos"> 336</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span> <span class="o">=</span> <span class="n">log</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos"> 337</span></a>
</span><span id="L-338"><a href="#L-338"><span class="linenos"> 338</span></a>        <span class="c1"># Save the credentials:</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos"> 339</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_username</span> <span class="o">=</span> <span class="n">username</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos"> 340</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_password</span> <span class="o">=</span> <span class="n">password</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos"> 341</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sso_token</span> <span class="o">=</span> <span class="n">token</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos"> 342</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_kerberos</span> <span class="o">=</span> <span class="n">kerberos</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos"> 343</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_ca_file</span> <span class="o">=</span> <span class="n">ca_file</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos"> 344</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_insecure</span> <span class="o">=</span> <span class="n">insecure</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos"> 345</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_timeout</span> <span class="o">=</span> <span class="n">timeout</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos"> 346</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_debug</span> <span class="o">=</span> <span class="n">debug</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos"> 347</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_compress</span> <span class="o">=</span> <span class="n">compress</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos"> 348</span></a>
</span><span id="L-349"><a href="#L-349"><span class="linenos"> 349</span></a>        <span class="c1"># The curl object can be used by several threads, but not</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos"> 350</span></a>        <span class="c1"># simultaneously, so we need a lock to prevent that:</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos"> 351</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_curl_lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos"> 352</span></a>
</span><span id="L-353"><a href="#L-353"><span class="linenos"> 353</span></a>        <span class="c1"># Set SSO attributes:</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos"> 354</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sso_url</span> <span class="o">=</span> <span class="n">sso_url</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos"> 355</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sso_revoke_url</span> <span class="o">=</span> <span class="n">sso_revoke_url</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos"> 356</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sso_token_name</span> <span class="o">=</span> <span class="n">sso_token_name</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos"> 357</span></a>
</span><span id="L-358"><a href="#L-358"><span class="linenos"> 358</span></a>        <span class="c1"># Headers:</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos"> 359</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_headers</span> <span class="o">=</span> <span class="n">headers</span> <span class="ow">or</span> <span class="p">{}</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos"> 360</span></a>
</span><span id="L-361"><a href="#L-361"><span class="linenos"> 361</span></a>        <span class="c1"># Create the curl handle that manages the pool of connections:</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos"> 362</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_multi</span> <span class="o">=</span> <span class="n">pycurl</span><span class="o">.</span><span class="n">CurlMulti</span><span class="p">()</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos"> 363</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_multi</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">M_PIPELINING</span><span class="p">,</span> <span class="nb">bool</span><span class="p">(</span><span class="n">pipeline</span><span class="p">))</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos"> 364</span></a>        <span class="c1"># Since libcurl 7.30.0:</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos"> 365</span></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">pycurl</span><span class="p">,</span> <span class="s1">&#39;M_MAX_PIPELINE_LENGTH&#39;</span><span class="p">):</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos"> 366</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_multi</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">M_MAX_PIPELINE_LENGTH</span><span class="p">,</span> <span class="n">pipeline</span><span class="p">)</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos"> 367</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_multi</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">M_MAX_HOST_CONNECTIONS</span><span class="p">,</span> <span class="n">connections</span><span class="p">)</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos"> 368</span></a>
</span><span id="L-369"><a href="#L-369"><span class="linenos"> 369</span></a>        <span class="c1"># Connections:</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos"> 370</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_curls</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos"> 371</span></a>
</span><span id="L-372"><a href="#L-372"><span class="linenos"> 372</span></a>        <span class="c1"># Initialize the reference to the system service:</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos"> 373</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__system_service</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos"> 374</span></a>
</span><span id="L-375"><a href="#L-375"><span class="linenos"> 375</span></a>    <span class="k">def</span> <span class="nf">send</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos"> 376</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos"> 377</span></a><span class="sd">        Sends an HTTP request and waits for the response.</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos"> 378</span></a>
</span><span id="L-379"><a href="#L-379"><span class="linenos"> 379</span></a><span class="sd">        This method is intended for internal use by other components of the</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos"> 380</span></a><span class="sd">        SDK. Refrain from using it directly, as backwards compatibility isn&#39;t</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos"> 381</span></a><span class="sd">        guaranteed.</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos"> 382</span></a>
</span><span id="L-383"><a href="#L-383"><span class="linenos"> 383</span></a><span class="sd">        This method supports the following parameters.</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos"> 384</span></a>
</span><span id="L-385"><a href="#L-385"><span class="linenos"> 385</span></a><span class="sd">        `request` \n</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos"> 386</span></a><span class="sd">        The Request object containing the details of the HTTP</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos"> 387</span></a><span class="sd">        request to send.</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos"> 388</span></a>
</span><span id="L-389"><a href="#L-389"><span class="linenos"> 389</span></a><span class="sd">        The returned value is a Request object containing the details of the</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos"> 390</span></a><span class="sd">        HTTP response received.</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos"> 391</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos"> 392</span></a>
</span><span id="L-393"><a href="#L-393"><span class="linenos"> 393</span></a>        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_curl_lock</span><span class="p">:</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos"> 394</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__send</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos"> 395</span></a>
</span><span id="L-396"><a href="#L-396"><span class="linenos"> 396</span></a>    <span class="k">def</span> <span class="nf">authenticate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos"> 397</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos"> 398</span></a><span class="sd">        Return token which can be used for authentication instead of credentials.</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos"> 399</span></a><span class="sd">        It will be created, if it not exists, yet. By default the token will be</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos"> 400</span></a><span class="sd">        revoked when the connection is closed, unless the `logout` parameter of</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos"> 401</span></a><span class="sd">        the `close` method is `False`.</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos"> 402</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos"> 403</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos"> 404</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sso_token</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos"> 405</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_sso_token</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_access_token</span><span class="p">()</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos"> 406</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sso_token</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos"> 407</span></a>        <span class="k">except</span> <span class="n">pycurl</span><span class="o">.</span><span class="n">error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos"> 408</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__parse_error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos"> 409</span></a>
</span><span id="L-410"><a href="#L-410"><span class="linenos"> 410</span></a>    <span class="k">def</span> <span class="nf">__send</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos"> 411</span></a>        <span class="c1"># Create SSO token if needed:</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos"> 412</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">authenticate</span><span class="p">()</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos"> 413</span></a>
</span><span id="L-414"><a href="#L-414"><span class="linenos"> 414</span></a>        <span class="c1"># Init curl easy:</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos"> 415</span></a>        <span class="n">curl</span> <span class="o">=</span> <span class="n">pycurl</span><span class="o">.</span><span class="n">Curl</span><span class="p">()</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos"> 416</span></a>        <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">COOKIEFILE</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos"> 417</span></a>
</span><span id="L-418"><a href="#L-418"><span class="linenos"> 418</span></a>        <span class="c1"># Configure TLS parameters:</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos"> 419</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_url</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;https&#39;</span><span class="p">):</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos"> 420</span></a>            <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">SSL_VERIFYPEER</span><span class="p">,</span> <span class="mi">0</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_insecure</span> <span class="k">else</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos"> 421</span></a>            <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">SSL_VERIFYHOST</span><span class="p">,</span> <span class="mi">0</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_insecure</span> <span class="k">else</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos"> 422</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ca_file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos"> 423</span></a>                <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">CAINFO</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ca_file</span><span class="p">)</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos"> 424</span></a>
</span><span id="L-425"><a href="#L-425"><span class="linenos"> 425</span></a>        <span class="c1"># Configure timeouts:</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos"> 426</span></a>        <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">TIMEOUT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_timeout</span><span class="p">)</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos"> 427</span></a>
</span><span id="L-428"><a href="#L-428"><span class="linenos"> 428</span></a>        <span class="c1"># Configure compression of responses (setting the value to a zero</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos"> 429</span></a>        <span class="c1"># length string means accepting all the compression types that</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos"> 430</span></a>        <span class="c1"># libcurl supports):</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos"> 431</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compress</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_debug</span><span class="p">:</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos"> 432</span></a>            <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">ENCODING</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos"> 433</span></a>
</span><span id="L-434"><a href="#L-434"><span class="linenos"> 434</span></a>        <span class="c1"># Configure debug mode:</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos"> 435</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_debug</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_log</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos"> 436</span></a>            <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">VERBOSE</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos"> 437</span></a>            <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">DEBUGFUNCTION</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_curl_debug</span><span class="p">)</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos"> 438</span></a>
</span><span id="L-439"><a href="#L-439"><span class="linenos"> 439</span></a>        <span class="c1"># Set the method:</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos"> 440</span></a>        <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">CUSTOMREQUEST</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="p">)</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos"> 441</span></a>
</span><span id="L-442"><a href="#L-442"><span class="linenos"> 442</span></a>        <span class="c1"># Build the URL:</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos"> 443</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_url</span><span class="p">(</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos"> 444</span></a>            <span class="n">path</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">path</span><span class="p">,</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos"> 445</span></a>            <span class="n">query</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">query</span><span class="p">,</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos"> 446</span></a>        <span class="p">)</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos"> 447</span></a>        <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">URL</span><span class="p">,</span> <span class="n">url</span><span class="p">)</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos"> 448</span></a>
</span><span id="L-449"><a href="#L-449"><span class="linenos"> 449</span></a>        <span class="c1"># Older versions of the engine (before 4.1) required the</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos"> 450</span></a>        <span class="c1"># &#39;all_content&#39; parameter as an HTTP header instead of a query</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos"> 451</span></a>        <span class="c1"># parameter. In order to better support these older versions of</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos"> 452</span></a>        <span class="c1"># the engine we need to check if this parameter is included in</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos"> 453</span></a>        <span class="c1"># the request, and add the corresponding header.</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos"> 454</span></a>        <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">query</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos"> 455</span></a>            <span class="n">all_content</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;all_content&#39;</span><span class="p">)</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos"> 456</span></a>            <span class="k">if</span> <span class="n">all_content</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos"> 457</span></a>                <span class="n">request</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;All-Content&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_content</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos"> 458</span></a>
</span><span id="L-459"><a href="#L-459"><span class="linenos"> 459</span></a>        <span class="c1"># Add global headers:</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos"> 460</span></a>        <span class="n">headers_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_headers</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos"> 461</span></a>
</span><span id="L-462"><a href="#L-462"><span class="linenos"> 462</span></a>        <span class="c1"># Add headers, avoiding those that have no value:</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos"> 463</span></a>        <span class="n">header_lines</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos"> 464</span></a>        <span class="k">for</span> <span class="n">header_name</span><span class="p">,</span> <span class="n">header_value</span> <span class="ow">in</span> <span class="n">request</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos"> 465</span></a>            <span class="k">if</span> <span class="n">header_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos"> 466</span></a>                <span class="n">headers_dict</span><span class="p">[</span><span class="n">header_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">header_value</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos"> 467</span></a>
</span><span id="L-468"><a href="#L-468"><span class="linenos"> 468</span></a>        <span class="k">for</span> <span class="n">header_name</span><span class="p">,</span> <span class="n">header_value</span> <span class="ow">in</span> <span class="n">headers_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos"> 469</span></a>            <span class="n">header_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">header_name</span><span class="p">,</span> <span class="n">header_value</span><span class="p">))</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos"> 470</span></a>
</span><span id="L-471"><a href="#L-471"><span class="linenos"> 471</span></a>        <span class="n">header_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;User-Agent: PythonSDK/</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">get_version</span><span class="p">())</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos"> 472</span></a>        <span class="n">header_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Version: 4&#39;</span><span class="p">)</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos"> 473</span></a>        <span class="n">header_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Content-Type: application/xml&#39;</span><span class="p">)</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos"> 474</span></a>        <span class="n">header_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Accept: application/xml&#39;</span><span class="p">)</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos"> 475</span></a>        <span class="n">header_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Authorization: Bearer </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sso_token</span><span class="p">)</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos"> 476</span></a>
</span><span id="L-477"><a href="#L-477"><span class="linenos"> 477</span></a>        <span class="c1"># Make sure headers values are strings, because</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos"> 478</span></a>        <span class="c1"># pycurl version 7.19.0 supports only string in headers</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos"> 479</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">header</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">header_lines</span><span class="p">):</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos"> 480</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos"> 481</span></a>                <span class="n">header_lines</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">header</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">)</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos"> 482</span></a>            <span class="k">except</span> <span class="p">(</span><span class="ne">UnicodeEncodeError</span><span class="p">,</span> <span class="ne">UnicodeDecodeError</span><span class="p">):</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos"> 483</span></a>                <span class="n">header_name</span><span class="p">,</span> <span class="n">header_value</span> <span class="o">=</span> <span class="n">header</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos"> 484</span></a>                <span class="k">raise</span> <span class="n">Error</span><span class="p">(</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos"> 485</span></a>                    <span class="s2">&quot;The value &#39;</span><span class="si">{header_value}</span><span class="s2">&#39; of header &#39;</span><span class="si">{header_name}</span><span class="s2">&#39; &quot;</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos"> 486</span></a>                    <span class="s2">&quot;contains characters that can&#39;t be encoded using ASCII, &quot;</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos"> 487</span></a>                    <span class="s2">&quot;as required by the HTTP protocol.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos"> 488</span></a>                        <span class="n">header_value</span><span class="o">=</span><span class="n">header_value</span><span class="p">,</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos"> 489</span></a>                        <span class="n">header_name</span><span class="o">=</span><span class="n">header_name</span><span class="p">,</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos"> 490</span></a>                    <span class="p">)</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos"> 491</span></a>                <span class="p">)</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos"> 492</span></a>
</span><span id="L-493"><a href="#L-493"><span class="linenos"> 493</span></a>        <span class="c1"># Copy headers and the request body to the curl object:</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos"> 494</span></a>        <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">HTTPHEADER</span><span class="p">,</span> <span class="n">header_lines</span><span class="p">)</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos"> 495</span></a>        <span class="n">body</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">body</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos"> 496</span></a>        <span class="k">if</span> <span class="n">body</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos"> 497</span></a>            <span class="n">body</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos"> 498</span></a>
</span><span id="L-499"><a href="#L-499"><span class="linenos"> 499</span></a>        <span class="c1"># HTTP pipelining is valid only for idempotent operations,</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos"> 500</span></a>        <span class="c1"># pycurl automatically disables pipelining if COPYPOSTFIELDS</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos"> 501</span></a>        <span class="c1"># is set, even if pipelining is explicitly set.</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos"> 502</span></a>        <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;POST&#39;</span><span class="p">,</span> <span class="s1">&#39;PUT&#39;</span><span class="p">]:</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos"> 503</span></a>            <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">COPYPOSTFIELDS</span><span class="p">,</span> <span class="n">body</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos"> 504</span></a>
</span><span id="L-505"><a href="#L-505"><span class="linenos"> 505</span></a>        <span class="c1"># Prepare the buffers to receive the response:</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos"> 506</span></a>        <span class="n">body_buf</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">()</span>
</span><span id="L-507"><a href="#L-507"><span class="linenos"> 507</span></a>        <span class="n">headers_buf</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">()</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos"> 508</span></a>        <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">WRITEFUNCTION</span><span class="p">,</span> <span class="n">body_buf</span><span class="o">.</span><span class="n">write</span><span class="p">)</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos"> 509</span></a>        <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">HEADERFUNCTION</span><span class="p">,</span> <span class="n">headers_buf</span><span class="o">.</span><span class="n">write</span><span class="p">)</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos"> 510</span></a>
</span><span id="L-511"><a href="#L-511"><span class="linenos"> 511</span></a>        <span class="c1"># Add the curl easy to the multi handle:</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos"> 512</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_multi</span><span class="o">.</span><span class="n">add_handle</span><span class="p">(</span><span class="n">curl</span><span class="p">)</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos"> 513</span></a>
</span><span id="L-514"><a href="#L-514"><span class="linenos"> 514</span></a>        <span class="k">return</span> <span class="n">curl</span><span class="p">,</span> <span class="n">body_buf</span><span class="p">,</span> <span class="n">headers_buf</span><span class="p">,</span> <span class="n">request</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos"> 515</span></a>
</span><span id="L-516"><a href="#L-516"><span class="linenos"> 516</span></a>    <span class="k">def</span> <span class="nf">wait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">failed_auth</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos"> 517</span></a>        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_curl_lock</span><span class="p">:</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos"> 518</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos"> 519</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__wait</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">failed_auth</span><span class="p">)</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos"> 520</span></a>            <span class="k">except</span> <span class="n">pycurl</span><span class="o">.</span><span class="n">error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos"> 521</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">__parse_error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos"> 522</span></a>
</span><span id="L-523"><a href="#L-523"><span class="linenos"> 523</span></a>    <span class="k">def</span> <span class="nf">__wait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">failed_auth</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos"> 524</span></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos"> 525</span></a>            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos"> 526</span></a>                <span class="n">ret</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_multi</span><span class="o">.</span><span class="n">perform</span><span class="p">()</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos"> 527</span></a>                <span class="k">if</span> <span class="n">ret</span> <span class="o">!=</span> <span class="n">pycurl</span><span class="o">.</span><span class="n">E_CALL_MULTI_PERFORM</span><span class="p">:</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos"> 528</span></a>                    <span class="k">break</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos"> 529</span></a>            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos"> 530</span></a>                <span class="n">num_q</span><span class="p">,</span> <span class="n">ok_list</span><span class="p">,</span> <span class="n">err_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_multi</span><span class="o">.</span><span class="n">info_read</span><span class="p">()</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos"> 531</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_curls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_curls</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">ok_list</span><span class="p">))</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos"> 532</span></a>                <span class="k">if</span> <span class="n">err_list</span><span class="p">:</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos"> 533</span></a>                    <span class="k">raise</span> <span class="n">Error</span><span class="p">(</span><span class="s2">&quot;Failed to read response: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">err_list</span><span class="p">))</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos"> 534</span></a>                <span class="k">elif</span> <span class="n">context</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_curls</span><span class="p">:</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos"> 535</span></a>                    <span class="c1"># Remove the curl:</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos"> 536</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_curls</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">context</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-537"><a href="#L-537"><span class="linenos"> 537</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_multi</span><span class="o">.</span><span class="n">remove_handle</span><span class="p">(</span><span class="n">context</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos"> 538</span></a>
</span><span id="L-539"><a href="#L-539"><span class="linenos"> 539</span></a>                    <span class="c1"># Read the response:</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos"> 540</span></a>                    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_reponse</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
</span><span id="L-541"><a href="#L-541"><span class="linenos"> 541</span></a>
</span><span id="L-542"><a href="#L-542"><span class="linenos"> 542</span></a>                    <span class="c1"># If the request failed because of authentication, and it</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos"> 543</span></a>                    <span class="c1"># wasn&#39;t a request to the SSO service, then the most likely</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos"> 544</span></a>                    <span class="c1"># cause is an expired SSO token. In this case we need to</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos"> 545</span></a>                    <span class="c1"># request a new token, and try the original request again, but</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos"> 546</span></a>                    <span class="c1"># only once. It if fails again, we just return the failed</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos"> 547</span></a>                    <span class="c1"># response.</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos"> 548</span></a>                    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">code</span> <span class="o">==</span> <span class="mi">401</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">failed_auth</span><span class="p">:</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos"> 549</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">_sso_token</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_access_token</span><span class="p">()</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos"> 550</span></a>                        <span class="n">context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__send</span><span class="p">(</span><span class="n">context</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos"> 551</span></a>                        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__wait</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="L-552"><a href="#L-552"><span class="linenos"> 552</span></a>                    <span class="k">return</span> <span class="n">response</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos"> 553</span></a>                <span class="k">elif</span> <span class="n">num_q</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos"> 554</span></a>                    <span class="k">break</span>
</span><span id="L-555"><a href="#L-555"><span class="linenos"> 555</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_multi</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos"> 556</span></a>
</span><span id="L-557"><a href="#L-557"><span class="linenos"> 557</span></a>    <span class="nd">@property</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos"> 558</span></a>    <span class="k">def</span> <span class="nf">url</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos"> 559</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-560"><a href="#L-560"><span class="linenos"> 560</span></a><span class="sd">        Returns a string containing the base URL used by this connection.</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos"> 561</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos"> 562</span></a>
</span><span id="L-563"><a href="#L-563"><span class="linenos"> 563</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_url</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos"> 564</span></a>
</span><span id="L-565"><a href="#L-565"><span class="linenos"> 565</span></a>    <span class="k">def</span> <span class="nf">_revoke_access_token</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos"> 566</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos"> 567</span></a><span class="sd">        Revokes access token</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos"> 568</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos"> 569</span></a>
</span><span id="L-570"><a href="#L-570"><span class="linenos"> 570</span></a>        <span class="c1"># Build the SSO revoke URL:</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos"> 571</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sso_revoke_url</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos"> 572</span></a>            <span class="n">url</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_url</span><span class="p">)</span>
</span><span id="L-573"><a href="#L-573"><span class="linenos"> 573</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_sso_revoke_url</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos"> 574</span></a>                <span class="s1">&#39;</span><span class="si">{url}</span><span class="s1">/ovirt-engine/services/sso-logout&#39;</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos"> 575</span></a>            <span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="L-576"><a href="#L-576"><span class="linenos"> 576</span></a>                <span class="n">url</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{scheme}</span><span class="s1">://</span><span class="si">{netloc}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos"> 577</span></a>                    <span class="n">scheme</span><span class="o">=</span><span class="n">url</span><span class="o">.</span><span class="n">scheme</span><span class="p">,</span>
</span><span id="L-578"><a href="#L-578"><span class="linenos"> 578</span></a>                    <span class="n">netloc</span><span class="o">=</span><span class="n">url</span><span class="o">.</span><span class="n">netloc</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos"> 579</span></a>                <span class="p">)</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos"> 580</span></a>            <span class="p">)</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos"> 581</span></a>
</span><span id="L-582"><a href="#L-582"><span class="linenos"> 582</span></a>        <span class="c1"># Construct POST data:</span>
</span><span id="L-583"><a href="#L-583"><span class="linenos"> 583</span></a>        <span class="n">post_data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos"> 584</span></a>            <span class="s1">&#39;scope&#39;</span><span class="p">:</span> <span class="s1">&#39;ovirt-app-api&#39;</span><span class="p">,</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos"> 585</span></a>            <span class="s1">&#39;token&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sso_token</span><span class="p">,</span>
</span><span id="L-586"><a href="#L-586"><span class="linenos"> 586</span></a>        <span class="p">}</span>
</span><span id="L-587"><a href="#L-587"><span class="linenos"> 587</span></a>
</span><span id="L-588"><a href="#L-588"><span class="linenos"> 588</span></a>        <span class="c1"># Send SSO request:</span>
</span><span id="L-589"><a href="#L-589"><span class="linenos"> 589</span></a>        <span class="n">sso_response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_sso_response</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sso_revoke_url</span><span class="p">,</span> <span class="n">post_data</span><span class="p">)</span>
</span><span id="L-590"><a href="#L-590"><span class="linenos"> 590</span></a>
</span><span id="L-591"><a href="#L-591"><span class="linenos"> 591</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sso_response</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-592"><a href="#L-592"><span class="linenos"> 592</span></a>            <span class="n">sso_response</span> <span class="o">=</span> <span class="n">sso_response</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos"> 593</span></a>
</span><span id="L-594"><a href="#L-594"><span class="linenos"> 594</span></a>        <span class="k">if</span> <span class="s1">&#39;error&#39;</span> <span class="ow">in</span> <span class="n">sso_response</span><span class="p">:</span>
</span><span id="L-595"><a href="#L-595"><span class="linenos"> 595</span></a>            <span class="n">sso_error</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_sso_error</span><span class="p">(</span><span class="n">sso_response</span><span class="p">)</span>
</span><span id="L-596"><a href="#L-596"><span class="linenos"> 596</span></a>            <span class="k">raise</span> <span class="n">AuthError</span><span class="p">(</span>
</span><span id="L-597"><a href="#L-597"><span class="linenos"> 597</span></a>                <span class="s1">&#39;Error during SSO revoke </span><span class="si">%s</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
</span><span id="L-598"><a href="#L-598"><span class="linenos"> 598</span></a>                    <span class="n">sso_error</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="L-599"><a href="#L-599"><span class="linenos"> 599</span></a>                    <span class="n">sso_error</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-600"><a href="#L-600"><span class="linenos"> 600</span></a>                <span class="p">)</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos"> 601</span></a>            <span class="p">)</span>
</span><span id="L-602"><a href="#L-602"><span class="linenos"> 602</span></a>
</span><span id="L-603"><a href="#L-603"><span class="linenos"> 603</span></a>    <span class="k">def</span> <span class="nf">_get_access_token</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-604"><a href="#L-604"><span class="linenos"> 604</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-605"><a href="#L-605"><span class="linenos"> 605</span></a><span class="sd">        Creates access token which reflect authentication method.</span>
</span><span id="L-606"><a href="#L-606"><span class="linenos"> 606</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-607"><a href="#L-607"><span class="linenos"> 607</span></a>
</span><span id="L-608"><a href="#L-608"><span class="linenos"> 608</span></a>        <span class="c1"># Build SSO URL:</span>
</span><span id="L-609"><a href="#L-609"><span class="linenos"> 609</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_kerberos</span><span class="p">:</span>
</span><span id="L-610"><a href="#L-610"><span class="linenos"> 610</span></a>            <span class="n">entry_point</span> <span class="o">=</span> <span class="s1">&#39;token-http-auth&#39;</span>
</span><span id="L-611"><a href="#L-611"><span class="linenos"> 611</span></a>            <span class="n">grant_type</span> <span class="o">=</span> <span class="s1">&#39;urn:ovirt:params:oauth:grant-type:http&#39;</span>
</span><span id="L-612"><a href="#L-612"><span class="linenos"> 612</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-613"><a href="#L-613"><span class="linenos"> 613</span></a>            <span class="n">entry_point</span> <span class="o">=</span> <span class="s1">&#39;token&#39;</span>
</span><span id="L-614"><a href="#L-614"><span class="linenos"> 614</span></a>            <span class="n">grant_type</span> <span class="o">=</span> <span class="s1">&#39;password&#39;</span>
</span><span id="L-615"><a href="#L-615"><span class="linenos"> 615</span></a>
</span><span id="L-616"><a href="#L-616"><span class="linenos"> 616</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sso_url</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-617"><a href="#L-617"><span class="linenos"> 617</span></a>            <span class="n">url</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_url</span><span class="p">)</span>
</span><span id="L-618"><a href="#L-618"><span class="linenos"> 618</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_sso_url</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-619"><a href="#L-619"><span class="linenos"> 619</span></a>                <span class="s1">&#39;</span><span class="si">{url}</span><span class="s1">/ovirt-engine/sso/oauth/</span><span class="si">{entry_point}</span><span class="s1">&#39;</span>
</span><span id="L-620"><a href="#L-620"><span class="linenos"> 620</span></a>            <span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="L-621"><a href="#L-621"><span class="linenos"> 621</span></a>                <span class="n">url</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{scheme}</span><span class="s1">://</span><span class="si">{netloc}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="L-622"><a href="#L-622"><span class="linenos"> 622</span></a>                    <span class="n">scheme</span><span class="o">=</span><span class="n">url</span><span class="o">.</span><span class="n">scheme</span><span class="p">,</span>
</span><span id="L-623"><a href="#L-623"><span class="linenos"> 623</span></a>                    <span class="n">netloc</span><span class="o">=</span><span class="n">url</span><span class="o">.</span><span class="n">netloc</span>
</span><span id="L-624"><a href="#L-624"><span class="linenos"> 624</span></a>                <span class="p">),</span>
</span><span id="L-625"><a href="#L-625"><span class="linenos"> 625</span></a>                <span class="n">entry_point</span><span class="o">=</span><span class="n">entry_point</span><span class="p">,</span>
</span><span id="L-626"><a href="#L-626"><span class="linenos"> 626</span></a>            <span class="p">)</span>
</span><span id="L-627"><a href="#L-627"><span class="linenos"> 627</span></a>
</span><span id="L-628"><a href="#L-628"><span class="linenos"> 628</span></a>        <span class="c1"># Construct POST data:</span>
</span><span id="L-629"><a href="#L-629"><span class="linenos"> 629</span></a>        <span class="n">post_data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-630"><a href="#L-630"><span class="linenos"> 630</span></a>            <span class="s1">&#39;grant_type&#39;</span><span class="p">:</span> <span class="n">grant_type</span><span class="p">,</span>
</span><span id="L-631"><a href="#L-631"><span class="linenos"> 631</span></a>            <span class="s1">&#39;scope&#39;</span><span class="p">:</span> <span class="s1">&#39;ovirt-app-api&#39;</span><span class="p">,</span>
</span><span id="L-632"><a href="#L-632"><span class="linenos"> 632</span></a>        <span class="p">}</span>
</span><span id="L-633"><a href="#L-633"><span class="linenos"> 633</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_kerberos</span><span class="p">:</span>
</span><span id="L-634"><a href="#L-634"><span class="linenos"> 634</span></a>            <span class="n">post_data</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
</span><span id="L-635"><a href="#L-635"><span class="linenos"> 635</span></a>                <span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_username</span><span class="p">,</span>
</span><span id="L-636"><a href="#L-636"><span class="linenos"> 636</span></a>                <span class="s1">&#39;password&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_password</span><span class="p">,</span>
</span><span id="L-637"><a href="#L-637"><span class="linenos"> 637</span></a>            <span class="p">})</span>
</span><span id="L-638"><a href="#L-638"><span class="linenos"> 638</span></a>
</span><span id="L-639"><a href="#L-639"><span class="linenos"> 639</span></a>        <span class="c1"># Send SSO request:</span>
</span><span id="L-640"><a href="#L-640"><span class="linenos"> 640</span></a>        <span class="n">sso_response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_sso_response</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sso_url</span><span class="p">,</span> <span class="n">post_data</span><span class="p">)</span>
</span><span id="L-641"><a href="#L-641"><span class="linenos"> 641</span></a>
</span><span id="L-642"><a href="#L-642"><span class="linenos"> 642</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sso_response</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-643"><a href="#L-643"><span class="linenos"> 643</span></a>            <span class="n">sso_response</span> <span class="o">=</span> <span class="n">sso_response</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-644"><a href="#L-644"><span class="linenos"> 644</span></a>
</span><span id="L-645"><a href="#L-645"><span class="linenos"> 645</span></a>        <span class="k">if</span> <span class="s1">&#39;error&#39;</span> <span class="ow">in</span> <span class="n">sso_response</span><span class="p">:</span>
</span><span id="L-646"><a href="#L-646"><span class="linenos"> 646</span></a>            <span class="n">sso_error</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_sso_error</span><span class="p">(</span><span class="n">sso_response</span><span class="p">)</span>
</span><span id="L-647"><a href="#L-647"><span class="linenos"> 647</span></a>            <span class="k">raise</span> <span class="n">AuthError</span><span class="p">(</span>
</span><span id="L-648"><a href="#L-648"><span class="linenos"> 648</span></a>                <span class="s1">&#39;Error during SSO authentication </span><span class="si">%s</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
</span><span id="L-649"><a href="#L-649"><span class="linenos"> 649</span></a>                    <span class="n">sso_error</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="L-650"><a href="#L-650"><span class="linenos"> 650</span></a>                    <span class="n">sso_error</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-651"><a href="#L-651"><span class="linenos"> 651</span></a>                <span class="p">)</span>
</span><span id="L-652"><a href="#L-652"><span class="linenos"> 652</span></a>            <span class="p">)</span>
</span><span id="L-653"><a href="#L-653"><span class="linenos"> 653</span></a>
</span><span id="L-654"><a href="#L-654"><span class="linenos"> 654</span></a>        <span class="k">return</span> <span class="n">sso_response</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_sso_token_name</span><span class="p">]</span>
</span><span id="L-655"><a href="#L-655"><span class="linenos"> 655</span></a>
</span><span id="L-656"><a href="#L-656"><span class="linenos"> 656</span></a>    <span class="k">def</span> <span class="nf">_get_sso_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sso_response</span><span class="p">):</span>
</span><span id="L-657"><a href="#L-657"><span class="linenos"> 657</span></a>        <span class="c1"># OpenId define `error_description` field, OAuth doesn&#39;t:</span>
</span><span id="L-658"><a href="#L-658"><span class="linenos"> 658</span></a>        <span class="k">if</span> <span class="s1">&#39;error_description&#39;</span> <span class="ow">in</span> <span class="n">sso_response</span><span class="p">:</span>
</span><span id="L-659"><a href="#L-659"><span class="linenos"> 659</span></a>            <span class="n">sso_error</span> <span class="o">=</span> <span class="p">(</span><span class="n">sso_response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;error&#39;</span><span class="p">),</span> <span class="n">sso_response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;error_description&#39;</span><span class="p">))</span>
</span><span id="L-660"><a href="#L-660"><span class="linenos"> 660</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-661"><a href="#L-661"><span class="linenos"> 661</span></a>            <span class="n">sso_error</span> <span class="o">=</span> <span class="p">(</span><span class="n">sso_response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;error_code&#39;</span><span class="p">),</span> <span class="n">sso_response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;error&#39;</span><span class="p">))</span>
</span><span id="L-662"><a href="#L-662"><span class="linenos"> 662</span></a>
</span><span id="L-663"><a href="#L-663"><span class="linenos"> 663</span></a>        <span class="k">return</span> <span class="n">sso_error</span>
</span><span id="L-664"><a href="#L-664"><span class="linenos"> 664</span></a>
</span><span id="L-665"><a href="#L-665"><span class="linenos"> 665</span></a>    <span class="k">def</span> <span class="nf">_get_sso_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
</span><span id="L-666"><a href="#L-666"><span class="linenos"> 666</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-667"><a href="#L-667"><span class="linenos"> 667</span></a><span class="sd">        Perform SSO request and return response body data.</span>
</span><span id="L-668"><a href="#L-668"><span class="linenos"> 668</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-669"><a href="#L-669"><span class="linenos"> 669</span></a>
</span><span id="L-670"><a href="#L-670"><span class="linenos"> 670</span></a>        <span class="c1"># Set HTTP method and URL:</span>
</span><span id="L-671"><a href="#L-671"><span class="linenos"> 671</span></a>        <span class="n">curl</span> <span class="o">=</span> <span class="n">pycurl</span><span class="o">.</span><span class="n">Curl</span><span class="p">()</span>
</span><span id="L-672"><a href="#L-672"><span class="linenos"> 672</span></a>        <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">CUSTOMREQUEST</span><span class="p">,</span> <span class="s1">&#39;POST&#39;</span><span class="p">)</span>
</span><span id="L-673"><a href="#L-673"><span class="linenos"> 673</span></a>        <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">URL</span><span class="p">,</span> <span class="n">url</span><span class="p">)</span>
</span><span id="L-674"><a href="#L-674"><span class="linenos"> 674</span></a>
</span><span id="L-675"><a href="#L-675"><span class="linenos"> 675</span></a>        <span class="c1"># Set proper Authorization header if using kerberos:</span>
</span><span id="L-676"><a href="#L-676"><span class="linenos"> 676</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_kerberos</span><span class="p">:</span>
</span><span id="L-677"><a href="#L-677"><span class="linenos"> 677</span></a>            <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">HTTPAUTH</span><span class="p">,</span> <span class="n">pycurl</span><span class="o">.</span><span class="n">HTTPAUTH_GSSNEGOTIATE</span><span class="p">)</span>
</span><span id="L-678"><a href="#L-678"><span class="linenos"> 678</span></a>            <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">USERPWD</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">)</span>
</span><span id="L-679"><a href="#L-679"><span class="linenos"> 679</span></a>
</span><span id="L-680"><a href="#L-680"><span class="linenos"> 680</span></a>        <span class="c1"># Configure debug mode:</span>
</span><span id="L-681"><a href="#L-681"><span class="linenos"> 681</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_debug</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_log</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-682"><a href="#L-682"><span class="linenos"> 682</span></a>            <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">VERBOSE</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-683"><a href="#L-683"><span class="linenos"> 683</span></a>            <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">DEBUGFUNCTION</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_curl_debug</span><span class="p">)</span>
</span><span id="L-684"><a href="#L-684"><span class="linenos"> 684</span></a>
</span><span id="L-685"><a href="#L-685"><span class="linenos"> 685</span></a>        <span class="c1"># Configure TLS parameters:</span>
</span><span id="L-686"><a href="#L-686"><span class="linenos"> 686</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_url</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;https&#39;</span><span class="p">):</span>
</span><span id="L-687"><a href="#L-687"><span class="linenos"> 687</span></a>            <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">SSL_VERIFYPEER</span><span class="p">,</span> <span class="mi">0</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_insecure</span> <span class="k">else</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-688"><a href="#L-688"><span class="linenos"> 688</span></a>            <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">SSL_VERIFYHOST</span><span class="p">,</span> <span class="mi">0</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_insecure</span> <span class="k">else</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="L-689"><a href="#L-689"><span class="linenos"> 689</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ca_file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-690"><a href="#L-690"><span class="linenos"> 690</span></a>                <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">CAINFO</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ca_file</span><span class="p">)</span>
</span><span id="L-691"><a href="#L-691"><span class="linenos"> 691</span></a>
</span><span id="L-692"><a href="#L-692"><span class="linenos"> 692</span></a>        <span class="c1"># Prepare headers:</span>
</span><span id="L-693"><a href="#L-693"><span class="linenos"> 693</span></a>        <span class="n">header_lines</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-694"><a href="#L-694"><span class="linenos"> 694</span></a>            <span class="s1">&#39;User-Agent: PythonSDK/</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">get_version</span><span class="p">(),</span>
</span><span id="L-695"><a href="#L-695"><span class="linenos"> 695</span></a>            <span class="s1">&#39;Accept: application/json&#39;</span>
</span><span id="L-696"><a href="#L-696"><span class="linenos"> 696</span></a>        <span class="p">]</span>
</span><span id="L-697"><a href="#L-697"><span class="linenos"> 697</span></a>        <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">HTTPHEADER</span><span class="p">,</span> <span class="n">header_lines</span><span class="p">)</span>
</span><span id="L-698"><a href="#L-698"><span class="linenos"> 698</span></a>        <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">COPYPOSTFIELDS</span><span class="p">,</span> <span class="n">urlencode</span><span class="p">(</span><span class="n">params</span><span class="p">))</span>
</span><span id="L-699"><a href="#L-699"><span class="linenos"> 699</span></a>
</span><span id="L-700"><a href="#L-700"><span class="linenos"> 700</span></a>        <span class="c1"># Prepare the buffer to receive the response:</span>
</span><span id="L-701"><a href="#L-701"><span class="linenos"> 701</span></a>        <span class="n">body_buf</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">()</span>
</span><span id="L-702"><a href="#L-702"><span class="linenos"> 702</span></a>        <span class="n">headers_buf</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">()</span>
</span><span id="L-703"><a href="#L-703"><span class="linenos"> 703</span></a>
</span><span id="L-704"><a href="#L-704"><span class="linenos"> 704</span></a>        <span class="c1"># We ignore all headers which are received before the last response</span>
</span><span id="L-705"><a href="#L-705"><span class="linenos"> 705</span></a>        <span class="c1"># from the server, because we can be forwarded by apache, and we</span>
</span><span id="L-706"><a href="#L-706"><span class="linenos"> 706</span></a>        <span class="c1"># are interested only in last response:</span>
</span><span id="L-707"><a href="#L-707"><span class="linenos"> 707</span></a>        <span class="k">def</span> <span class="nf">write_header</span><span class="p">(</span><span class="n">buf</span><span class="p">):</span>
</span><span id="L-708"><a href="#L-708"><span class="linenos"> 708</span></a>            <span class="k">if</span> <span class="n">buf</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;HTTP/&#39;</span><span class="p">):</span>
</span><span id="L-709"><a href="#L-709"><span class="linenos"> 709</span></a>                <span class="n">headers_buf</span><span class="o">.</span><span class="n">truncate</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-710"><a href="#L-710"><span class="linenos"> 710</span></a>                <span class="n">headers_buf</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-711"><a href="#L-711"><span class="linenos"> 711</span></a>            <span class="n">headers_buf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span>
</span><span id="L-712"><a href="#L-712"><span class="linenos"> 712</span></a>
</span><span id="L-713"><a href="#L-713"><span class="linenos"> 713</span></a>        <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">WRITEFUNCTION</span><span class="p">,</span> <span class="n">body_buf</span><span class="o">.</span><span class="n">write</span><span class="p">)</span>
</span><span id="L-714"><a href="#L-714"><span class="linenos"> 714</span></a>        <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">HEADERFUNCTION</span><span class="p">,</span> <span class="n">write_header</span><span class="p">)</span>
</span><span id="L-715"><a href="#L-715"><span class="linenos"> 715</span></a>
</span><span id="L-716"><a href="#L-716"><span class="linenos"> 716</span></a>        <span class="c1"># Send the request and wait for the response:</span>
</span><span id="L-717"><a href="#L-717"><span class="linenos"> 717</span></a>        <span class="n">curl</span><span class="o">.</span><span class="n">perform</span><span class="p">()</span>
</span><span id="L-718"><a href="#L-718"><span class="linenos"> 718</span></a>        <span class="n">curl</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="L-719"><a href="#L-719"><span class="linenos"> 719</span></a>
</span><span id="L-720"><a href="#L-720"><span class="linenos"> 720</span></a>        <span class="c1"># Get headers:</span>
</span><span id="L-721"><a href="#L-721"><span class="linenos"> 721</span></a>        <span class="n">headers_text</span> <span class="o">=</span> <span class="n">headers_buf</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">)</span>
</span><span id="L-722"><a href="#L-722"><span class="linenos"> 722</span></a>        <span class="n">header_lines</span> <span class="o">=</span> <span class="n">headers_text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-723"><a href="#L-723"><span class="linenos"> 723</span></a>
</span><span id="L-724"><a href="#L-724"><span class="linenos"> 724</span></a>        <span class="c1"># Check the returned content type:</span>
</span><span id="L-725"><a href="#L-725"><span class="linenos"> 725</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_check_content_type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__JSON_CONTENT_TYPE_RE</span><span class="p">,</span> <span class="s1">&#39;JSON&#39;</span><span class="p">,</span> <span class="n">header_lines</span><span class="p">)</span>
</span><span id="L-726"><a href="#L-726"><span class="linenos"> 726</span></a>
</span><span id="L-727"><a href="#L-727"><span class="linenos"> 727</span></a>        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">body_buf</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>
</span><span id="L-728"><a href="#L-728"><span class="linenos"> 728</span></a>
</span><span id="L-729"><a href="#L-729"><span class="linenos"> 729</span></a>    <span class="k">def</span> <span class="nf">system_service</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-730"><a href="#L-730"><span class="linenos"> 730</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-731"><a href="#L-731"><span class="linenos"> 731</span></a><span class="sd">        Returns the reference to the root of the services tree.</span>
</span><span id="L-732"><a href="#L-732"><span class="linenos"> 732</span></a>
</span><span id="L-733"><a href="#L-733"><span class="linenos"> 733</span></a><span class="sd">        The returned value is an instance of the `SystemService` class.</span>
</span><span id="L-734"><a href="#L-734"><span class="linenos"> 734</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-735"><a href="#L-735"><span class="linenos"> 735</span></a>
</span><span id="L-736"><a href="#L-736"><span class="linenos"> 736</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__system_service</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-737"><a href="#L-737"><span class="linenos"> 737</span></a>            <span class="kn">from</span> <span class="nn">ovirtsdk4.services</span> <span class="kn">import</span> <span class="n">SystemService</span>
</span><span id="L-738"><a href="#L-738"><span class="linenos"> 738</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__system_service</span> <span class="o">=</span> <span class="n">SystemService</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="L-739"><a href="#L-739"><span class="linenos"> 739</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__system_service</span>
</span><span id="L-740"><a href="#L-740"><span class="linenos"> 740</span></a>
</span><span id="L-741"><a href="#L-741"><span class="linenos"> 741</span></a>    <span class="k">def</span> <span class="nf">service</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
</span><span id="L-742"><a href="#L-742"><span class="linenos"> 742</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-743"><a href="#L-743"><span class="linenos"> 743</span></a><span class="sd">        Returns a reference to the service corresponding to the given</span>
</span><span id="L-744"><a href="#L-744"><span class="linenos"> 744</span></a><span class="sd">        path. For example, if the `path` parameter is</span>
</span><span id="L-745"><a href="#L-745"><span class="linenos"> 745</span></a><span class="sd">        `vms/123/diskattachments` then it will return a reference to</span>
</span><span id="L-746"><a href="#L-746"><span class="linenos"> 746</span></a><span class="sd">        the service that manages the disk attachments for the virtual</span>
</span><span id="L-747"><a href="#L-747"><span class="linenos"> 747</span></a><span class="sd">        machine with identifier `123`.</span>
</span><span id="L-748"><a href="#L-748"><span class="linenos"> 748</span></a>
</span><span id="L-749"><a href="#L-749"><span class="linenos"> 749</span></a><span class="sd">        If there is no service corresponding to the given path an exception</span>
</span><span id="L-750"><a href="#L-750"><span class="linenos"> 750</span></a><span class="sd">        will be raised.</span>
</span><span id="L-751"><a href="#L-751"><span class="linenos"> 751</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-752"><a href="#L-752"><span class="linenos"> 752</span></a>
</span><span id="L-753"><a href="#L-753"><span class="linenos"> 753</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">system_service</span><span class="p">()</span><span class="o">.</span><span class="n">service</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</span><span id="L-754"><a href="#L-754"><span class="linenos"> 754</span></a>
</span><span id="L-755"><a href="#L-755"><span class="linenos"> 755</span></a>    <span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raise_exception</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="L-756"><a href="#L-756"><span class="linenos"> 756</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-757"><a href="#L-757"><span class="linenos"> 757</span></a><span class="sd">        Tests the connectivity with the server. If connectivity works</span>
</span><span id="L-758"><a href="#L-758"><span class="linenos"> 758</span></a><span class="sd">        correctly it returns `True`. If there is any connectivy problem</span>
</span><span id="L-759"><a href="#L-759"><span class="linenos"> 759</span></a><span class="sd">        it will either return `False` or raise an exception if the</span>
</span><span id="L-760"><a href="#L-760"><span class="linenos"> 760</span></a><span class="sd">        `raise_exception` parameter is `True`.</span>
</span><span id="L-761"><a href="#L-761"><span class="linenos"> 761</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-762"><a href="#L-762"><span class="linenos"> 762</span></a>
</span><span id="L-763"><a href="#L-763"><span class="linenos"> 763</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-764"><a href="#L-764"><span class="linenos"> 764</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">system_service</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</span><span id="L-765"><a href="#L-765"><span class="linenos"> 765</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-766"><a href="#L-766"><span class="linenos"> 766</span></a>        <span class="k">except</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="L-767"><a href="#L-767"><span class="linenos"> 767</span></a>            <span class="k">if</span> <span class="n">raise_exception</span><span class="p">:</span>
</span><span id="L-768"><a href="#L-768"><span class="linenos"> 768</span></a>                <span class="k">raise</span>
</span><span id="L-769"><a href="#L-769"><span class="linenos"> 769</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-770"><a href="#L-770"><span class="linenos"> 770</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="L-771"><a href="#L-771"><span class="linenos"> 771</span></a>            <span class="k">if</span> <span class="n">raise_exception</span><span class="p">:</span>
</span><span id="L-772"><a href="#L-772"><span class="linenos"> 772</span></a>                <span class="k">raise</span> <span class="n">Error</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="L-773"><a href="#L-773"><span class="linenos"> 773</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-774"><a href="#L-774"><span class="linenos"> 774</span></a>
</span><span id="L-775"><a href="#L-775"><span class="linenos"> 775</span></a>    <span class="k">def</span> <span class="nf">is_link</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
</span><span id="L-776"><a href="#L-776"><span class="linenos"> 776</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-777"><a href="#L-777"><span class="linenos"> 777</span></a><span class="sd">        Indicates if the given object is a link. An object is a link if</span>
</span><span id="L-778"><a href="#L-778"><span class="linenos"> 778</span></a><span class="sd">        it has an `href` attribute.</span>
</span><span id="L-779"><a href="#L-779"><span class="linenos"> 779</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-780"><a href="#L-780"><span class="linenos"> 780</span></a>
</span><span id="L-781"><a href="#L-781"><span class="linenos"> 781</span></a>        <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">href</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="L-782"><a href="#L-782"><span class="linenos"> 782</span></a>
</span><span id="L-783"><a href="#L-783"><span class="linenos"> 783</span></a>    <span class="k">def</span> <span class="nf">follow_link</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
</span><span id="L-784"><a href="#L-784"><span class="linenos"> 784</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-785"><a href="#L-785"><span class="linenos"> 785</span></a><span class="sd">        Follows the `href` attribute of this object, retrieves the object</span>
</span><span id="L-786"><a href="#L-786"><span class="linenos"> 786</span></a><span class="sd">        and returns it.</span>
</span><span id="L-787"><a href="#L-787"><span class="linenos"> 787</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-788"><a href="#L-788"><span class="linenos"> 788</span></a>
</span><span id="L-789"><a href="#L-789"><span class="linenos"> 789</span></a>        <span class="c1"># Check that the &quot;href&quot; attribute has a values, as it is needed</span>
</span><span id="L-790"><a href="#L-790"><span class="linenos"> 790</span></a>        <span class="c1"># in order to retrieve the representation of the object:</span>
</span><span id="L-791"><a href="#L-791"><span class="linenos"> 791</span></a>        <span class="n">href</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">href</span>
</span><span id="L-792"><a href="#L-792"><span class="linenos"> 792</span></a>        <span class="k">if</span> <span class="n">href</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-793"><a href="#L-793"><span class="linenos"> 793</span></a>            <span class="k">raise</span> <span class="n">Error</span><span class="p">(</span>
</span><span id="L-794"><a href="#L-794"><span class="linenos"> 794</span></a>                <span class="s2">&quot;Can&#39;t follow link because the &#39;href&#39; attribute does&#39;t &quot;</span>
</span><span id="L-795"><a href="#L-795"><span class="linenos"> 795</span></a>                <span class="s2">&quot;have a value&quot;</span>
</span><span id="L-796"><a href="#L-796"><span class="linenos"> 796</span></a>            <span class="p">)</span>
</span><span id="L-797"><a href="#L-797"><span class="linenos"> 797</span></a>
</span><span id="L-798"><a href="#L-798"><span class="linenos"> 798</span></a>        <span class="c1"># Check that the value of the &quot;href&quot; attribute is compatible with the</span>
</span><span id="L-799"><a href="#L-799"><span class="linenos"> 799</span></a>        <span class="c1"># base URL of the connection:</span>
</span><span id="L-800"><a href="#L-800"><span class="linenos"> 800</span></a>        <span class="n">prefix</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_url</span><span class="p">)</span><span class="o">.</span><span class="n">path</span>
</span><span id="L-801"><a href="#L-801"><span class="linenos"> 801</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">prefix</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">):</span>
</span><span id="L-802"><a href="#L-802"><span class="linenos"> 802</span></a>            <span class="n">prefix</span> <span class="o">+=</span> <span class="s1">&#39;/&#39;</span>
</span><span id="L-803"><a href="#L-803"><span class="linenos"> 803</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">href</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">prefix</span><span class="p">):</span>
</span><span id="L-804"><a href="#L-804"><span class="linenos"> 804</span></a>            <span class="k">raise</span> <span class="n">Error</span><span class="p">(</span>
</span><span id="L-805"><a href="#L-805"><span class="linenos"> 805</span></a>                <span class="s2">&quot;The URL &#39;</span><span class="si">%s</span><span class="s2">&#39; isn&#39;t compatible with the base URL of the &quot;</span>
</span><span id="L-806"><a href="#L-806"><span class="linenos"> 806</span></a>                <span class="s2">&quot;connection&quot;</span> <span class="o">%</span> <span class="n">href</span>
</span><span id="L-807"><a href="#L-807"><span class="linenos"> 807</span></a>            <span class="p">)</span>
</span><span id="L-808"><a href="#L-808"><span class="linenos"> 808</span></a>
</span><span id="L-809"><a href="#L-809"><span class="linenos"> 809</span></a>        <span class="c1"># Remove the prefix from the URL, follow the path to the relevant</span>
</span><span id="L-810"><a href="#L-810"><span class="linenos"> 810</span></a>        <span class="c1"># service and invoke the &quot;get&quot;, or &quot;list method to retrieve its representation:</span>
</span><span id="L-811"><a href="#L-811"><span class="linenos"> 811</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="n">href</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">prefix</span><span class="p">):]</span>
</span><span id="L-812"><a href="#L-812"><span class="linenos"> 812</span></a>        <span class="n">service</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</span><span id="L-813"><a href="#L-813"><span class="linenos"> 813</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">List</span><span class="p">):</span>
</span><span id="L-814"><a href="#L-814"><span class="linenos"> 814</span></a>            <span class="k">return</span> <span class="n">service</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
</span><span id="L-815"><a href="#L-815"><span class="linenos"> 815</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-816"><a href="#L-816"><span class="linenos"> 816</span></a>            <span class="k">return</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</span><span id="L-817"><a href="#L-817"><span class="linenos"> 817</span></a>
</span><span id="L-818"><a href="#L-818"><span class="linenos"> 818</span></a>    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">logout</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="L-819"><a href="#L-819"><span class="linenos"> 819</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-820"><a href="#L-820"><span class="linenos"> 820</span></a><span class="sd">        Releases the resources used by this connection.</span>
</span><span id="L-821"><a href="#L-821"><span class="linenos"> 821</span></a>
</span><span id="L-822"><a href="#L-822"><span class="linenos"> 822</span></a><span class="sd">        `logout` A boolean, which specify if token should be revoked,</span>
</span><span id="L-823"><a href="#L-823"><span class="linenos"> 823</span></a><span class="sd">        and so user should be logged out.</span>
</span><span id="L-824"><a href="#L-824"><span class="linenos"> 824</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-825"><a href="#L-825"><span class="linenos"> 825</span></a>
</span><span id="L-826"><a href="#L-826"><span class="linenos"> 826</span></a>        <span class="c1"># Revoke access token:</span>
</span><span id="L-827"><a href="#L-827"><span class="linenos"> 827</span></a>        <span class="k">if</span> <span class="n">logout</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sso_token</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-828"><a href="#L-828"><span class="linenos"> 828</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_revoke_access_token</span><span class="p">()</span>
</span><span id="L-829"><a href="#L-829"><span class="linenos"> 829</span></a>
</span><span id="L-830"><a href="#L-830"><span class="linenos"> 830</span></a>        <span class="c1"># Release resources used by the cURL handle:</span>
</span><span id="L-831"><a href="#L-831"><span class="linenos"> 831</span></a>        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_curl_lock</span><span class="p">:</span>
</span><span id="L-832"><a href="#L-832"><span class="linenos"> 832</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_multi</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="L-833"><a href="#L-833"><span class="linenos"> 833</span></a>
</span><span id="L-834"><a href="#L-834"><span class="linenos"> 834</span></a>    <span class="k">def</span> <span class="nf">_build_url</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">query</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-835"><a href="#L-835"><span class="linenos"> 835</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-836"><a href="#L-836"><span class="linenos"> 836</span></a><span class="sd">        Builds a request URL from a path, and the set of query parameters.</span>
</span><span id="L-837"><a href="#L-837"><span class="linenos"> 837</span></a>
</span><span id="L-838"><a href="#L-838"><span class="linenos"> 838</span></a><span class="sd">        This method is intended for internal use by other components of the</span>
</span><span id="L-839"><a href="#L-839"><span class="linenos"> 839</span></a><span class="sd">        SDK. Refrain from using it directly, as backwards compatibility isn&#39;t</span>
</span><span id="L-840"><a href="#L-840"><span class="linenos"> 840</span></a><span class="sd">        guaranteed.</span>
</span><span id="L-841"><a href="#L-841"><span class="linenos"> 841</span></a>
</span><span id="L-842"><a href="#L-842"><span class="linenos"> 842</span></a><span class="sd">        This method supports the following parameters:</span>
</span><span id="L-843"><a href="#L-843"><span class="linenos"> 843</span></a>
</span><span id="L-844"><a href="#L-844"><span class="linenos"> 844</span></a><span class="sd">        `path` The path that will be added to the base URL. The default is an</span>
</span><span id="L-845"><a href="#L-845"><span class="linenos"> 845</span></a><span class="sd">        empty string.</span>
</span><span id="L-846"><a href="#L-846"><span class="linenos"> 846</span></a>
</span><span id="L-847"><a href="#L-847"><span class="linenos"> 847</span></a><span class="sd">        `query` A dictionary containing the query parameters to add to the</span>
</span><span id="L-848"><a href="#L-848"><span class="linenos"> 848</span></a><span class="sd">        URL. The keys of the dictionary should be strings containing the names</span>
</span><span id="L-849"><a href="#L-849"><span class="linenos"> 849</span></a><span class="sd">        of the parameters, and the values should be strings containing the</span>
</span><span id="L-850"><a href="#L-850"><span class="linenos"> 850</span></a><span class="sd">        values.</span>
</span><span id="L-851"><a href="#L-851"><span class="linenos"> 851</span></a>
</span><span id="L-852"><a href="#L-852"><span class="linenos"> 852</span></a><span class="sd">        The returned value is an string containing the URL.</span>
</span><span id="L-853"><a href="#L-853"><span class="linenos"> 853</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-854"><a href="#L-854"><span class="linenos"> 854</span></a>
</span><span id="L-855"><a href="#L-855"><span class="linenos"> 855</span></a>        <span class="c1"># Add the path and the parameters:</span>
</span><span id="L-856"><a href="#L-856"><span class="linenos"> 856</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_url</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
</span><span id="L-857"><a href="#L-857"><span class="linenos"> 857</span></a>        <span class="k">if</span> <span class="n">query</span><span class="p">:</span>
</span><span id="L-858"><a href="#L-858"><span class="linenos"> 858</span></a>            <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">?</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">urlencode</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">items</span><span class="p">())))</span>
</span><span id="L-859"><a href="#L-859"><span class="linenos"> 859</span></a>        <span class="k">return</span> <span class="n">url</span>
</span><span id="L-860"><a href="#L-860"><span class="linenos"> 860</span></a>
</span><span id="L-861"><a href="#L-861"><span class="linenos"> 861</span></a>    <span class="k">def</span> <span class="nf">check_xml_content_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">response</span><span class="p">):</span>
</span><span id="L-862"><a href="#L-862"><span class="linenos"> 862</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-863"><a href="#L-863"><span class="linenos"> 863</span></a><span class="sd">         Checks that the content type of the given response is XML. If it is</span>
</span><span id="L-864"><a href="#L-864"><span class="linenos"> 864</span></a><span class="sd">         XML then it does nothing. If it isn&#39;t XML then it raises an</span>
</span><span id="L-865"><a href="#L-865"><span class="linenos"> 865</span></a><span class="sd">         exception.</span>
</span><span id="L-866"><a href="#L-866"><span class="linenos"> 866</span></a>
</span><span id="L-867"><a href="#L-867"><span class="linenos"> 867</span></a><span class="sd">         `response` The HTTP response to check.</span>
</span><span id="L-868"><a href="#L-868"><span class="linenos"> 868</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-869"><a href="#L-869"><span class="linenos"> 869</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_content_type</span><span class="p">(</span>
</span><span id="L-870"><a href="#L-870"><span class="linenos"> 870</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__XML_CONTENT_TYPE_RE</span><span class="p">,</span>
</span><span id="L-871"><a href="#L-871"><span class="linenos"> 871</span></a>            <span class="s1">&#39;XML&#39;</span><span class="p">,</span>
</span><span id="L-872"><a href="#L-872"><span class="linenos"> 872</span></a>            <span class="n">response</span><span class="o">.</span><span class="n">headers</span>
</span><span id="L-873"><a href="#L-873"><span class="linenos"> 873</span></a>        <span class="p">)</span>
</span><span id="L-874"><a href="#L-874"><span class="linenos"> 874</span></a>
</span><span id="L-875"><a href="#L-875"><span class="linenos"> 875</span></a>    <span class="k">def</span> <span class="nf">check_json_content_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">response</span><span class="p">):</span>
</span><span id="L-876"><a href="#L-876"><span class="linenos"> 876</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-877"><a href="#L-877"><span class="linenos"> 877</span></a><span class="sd">         Checks that the content type of the given response is JSON. If it is</span>
</span><span id="L-878"><a href="#L-878"><span class="linenos"> 878</span></a><span class="sd">         JSON then it does nothing. If it isn&#39;t JSON then it raises an</span>
</span><span id="L-879"><a href="#L-879"><span class="linenos"> 879</span></a><span class="sd">         exception.</span>
</span><span id="L-880"><a href="#L-880"><span class="linenos"> 880</span></a>
</span><span id="L-881"><a href="#L-881"><span class="linenos"> 881</span></a><span class="sd">         `response` The HTTP response to check.</span>
</span><span id="L-882"><a href="#L-882"><span class="linenos"> 882</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-883"><a href="#L-883"><span class="linenos"> 883</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_content_type</span><span class="p">(</span>
</span><span id="L-884"><a href="#L-884"><span class="linenos"> 884</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__JSON_CONTENT_TYPE_RE</span><span class="p">,</span>
</span><span id="L-885"><a href="#L-885"><span class="linenos"> 885</span></a>            <span class="s1">&#39;JSON&#39;</span><span class="p">,</span>
</span><span id="L-886"><a href="#L-886"><span class="linenos"> 886</span></a>            <span class="n">response</span><span class="o">.</span><span class="n">headers</span>
</span><span id="L-887"><a href="#L-887"><span class="linenos"> 887</span></a>        <span class="p">)</span>
</span><span id="L-888"><a href="#L-888"><span class="linenos"> 888</span></a>
</span><span id="L-889"><a href="#L-889"><span class="linenos"> 889</span></a>    <span class="k">def</span> <span class="nf">_check_content_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expected_re</span><span class="p">,</span> <span class="n">expected_name</span><span class="p">,</span> <span class="n">headers</span><span class="p">):</span>
</span><span id="L-890"><a href="#L-890"><span class="linenos"> 890</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-891"><a href="#L-891"><span class="linenos"> 891</span></a><span class="sd">        Checks the given content type and raises an exception if it isn&#39;t the</span>
</span><span id="L-892"><a href="#L-892"><span class="linenos"> 892</span></a><span class="sd">        expected one.</span>
</span><span id="L-893"><a href="#L-893"><span class="linenos"> 893</span></a>
</span><span id="L-894"><a href="#L-894"><span class="linenos"> 894</span></a><span class="sd">        `expected_re` The regular expression used to check the expected</span>
</span><span id="L-895"><a href="#L-895"><span class="linenos"> 895</span></a><span class="sd">                        content type.</span>
</span><span id="L-896"><a href="#L-896"><span class="linenos"> 896</span></a><span class="sd">        `expected_name` The name of the expected content type.</span>
</span><span id="L-897"><a href="#L-897"><span class="linenos"> 897</span></a><span class="sd">        `headers` The HTTP headers to check.</span>
</span><span id="L-898"><a href="#L-898"><span class="linenos"> 898</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-899"><a href="#L-899"><span class="linenos"> 899</span></a>        <span class="n">content_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_header_value</span><span class="p">(</span><span class="n">headers</span><span class="p">,</span> <span class="s1">&#39;content-type&#39;</span><span class="p">)</span>
</span><span id="L-900"><a href="#L-900"><span class="linenos"> 900</span></a>        <span class="k">if</span> <span class="n">expected_re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">content_type</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-901"><a href="#L-901"><span class="linenos"> 901</span></a>            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;The response content type &#39;</span><span class="si">{}</span><span class="s2">&#39; isn&#39;t the expected </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="L-902"><a href="#L-902"><span class="linenos"> 902</span></a>                <span class="n">content_type</span><span class="p">,</span>
</span><span id="L-903"><a href="#L-903"><span class="linenos"> 903</span></a>                <span class="n">expected_name</span><span class="p">,</span>
</span><span id="L-904"><a href="#L-904"><span class="linenos"> 904</span></a>            <span class="p">)</span>
</span><span id="L-905"><a href="#L-905"><span class="linenos"> 905</span></a>            <span class="n">url</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_url</span><span class="p">)</span>
</span><span id="L-906"><a href="#L-906"><span class="linenos"> 906</span></a>            <span class="k">if</span> <span class="n">url</span><span class="o">.</span><span class="n">path</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__TYPICAL_PATH</span><span class="p">:</span>
</span><span id="L-907"><a href="#L-907"><span class="linenos"> 907</span></a>                <span class="n">msg</span> <span class="o">+=</span> <span class="p">(</span>
</span><span id="L-908"><a href="#L-908"><span class="linenos"> 908</span></a>                    <span class="s2">&quot;. Is the path &#39;</span><span class="si">{}</span><span class="s2">&#39; included in the &#39;url&#39; &quot;</span>
</span><span id="L-909"><a href="#L-909"><span class="linenos"> 909</span></a>                    <span class="s2">&quot;parameter correct?&quot;</span>
</span><span id="L-910"><a href="#L-910"><span class="linenos"> 910</span></a>                <span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">url</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
</span><span id="L-911"><a href="#L-911"><span class="linenos"> 911</span></a>                <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot; The typical one is &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__TYPICAL_PATH</span><span class="p">)</span>
</span><span id="L-912"><a href="#L-912"><span class="linenos"> 912</span></a>            <span class="k">raise</span> <span class="n">Error</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="L-913"><a href="#L-913"><span class="linenos"> 913</span></a>
</span><span id="L-914"><a href="#L-914"><span class="linenos"> 914</span></a>    <span class="k">def</span> <span class="nf">_read_reponse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
</span><span id="L-915"><a href="#L-915"><span class="linenos"> 915</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-916"><a href="#L-916"><span class="linenos"> 916</span></a><span class="sd">        Read the response.</span>
</span><span id="L-917"><a href="#L-917"><span class="linenos"> 917</span></a>
</span><span id="L-918"><a href="#L-918"><span class="linenos"> 918</span></a><span class="sd">        `context` tuple which contains cur easy, response body,</span>
</span><span id="L-919"><a href="#L-919"><span class="linenos"> 919</span></a><span class="sd">        response headers, original request</span>
</span><span id="L-920"><a href="#L-920"><span class="linenos"> 920</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-921"><a href="#L-921"><span class="linenos"> 921</span></a>        <span class="c1"># Extract the response code and body:</span>
</span><span id="L-922"><a href="#L-922"><span class="linenos"> 922</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="n">Response</span><span class="p">()</span>
</span><span id="L-923"><a href="#L-923"><span class="linenos"> 923</span></a>        <span class="n">response</span><span class="o">.</span><span class="n">code</span> <span class="o">=</span> <span class="n">context</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">getinfo</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">HTTP_CODE</span><span class="p">)</span>
</span><span id="L-924"><a href="#L-924"><span class="linenos"> 924</span></a>        <span class="n">response</span><span class="o">.</span><span class="n">body</span> <span class="o">=</span> <span class="n">context</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
</span><span id="L-925"><a href="#L-925"><span class="linenos"> 925</span></a>
</span><span id="L-926"><a href="#L-926"><span class="linenos"> 926</span></a>        <span class="c1"># The response code can be extracted directly, but cURL doesn&#39;t</span>
</span><span id="L-927"><a href="#L-927"><span class="linenos"> 927</span></a>        <span class="c1"># have a method to extract the response message, so we have to</span>
</span><span id="L-928"><a href="#L-928"><span class="linenos"> 928</span></a>        <span class="c1"># parse the first header line to find it:</span>
</span><span id="L-929"><a href="#L-929"><span class="linenos"> 929</span></a>        <span class="n">response</span><span class="o">.</span><span class="n">reason</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="L-930"><a href="#L-930"><span class="linenos"> 930</span></a>        <span class="n">headers_text</span> <span class="o">=</span> <span class="n">context</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">)</span>
</span><span id="L-931"><a href="#L-931"><span class="linenos"> 931</span></a>        <span class="n">header_lines</span> <span class="o">=</span> <span class="n">headers_text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-932"><a href="#L-932"><span class="linenos"> 932</span></a>        <span class="n">response</span><span class="o">.</span><span class="n">headers</span> <span class="o">=</span> <span class="n">header_lines</span>
</span><span id="L-933"><a href="#L-933"><span class="linenos"> 933</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">header_lines</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-934"><a href="#L-934"><span class="linenos"> 934</span></a>            <span class="n">response_line</span> <span class="o">=</span> <span class="n">header_lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-935"><a href="#L-935"><span class="linenos"> 935</span></a>            <span class="n">response_fields</span> <span class="o">=</span> <span class="n">response_line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</span><span id="L-936"><a href="#L-936"><span class="linenos"> 936</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">response_fields</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">:</span>
</span><span id="L-937"><a href="#L-937"><span class="linenos"> 937</span></a>                <span class="n">response</span><span class="o">.</span><span class="n">reason</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">response_fields</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span>
</span><span id="L-938"><a href="#L-938"><span class="linenos"> 938</span></a>
</span><span id="L-939"><a href="#L-939"><span class="linenos"> 939</span></a>        <span class="n">context</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="L-940"><a href="#L-940"><span class="linenos"> 940</span></a>        <span class="c1"># Return the response:</span>
</span><span id="L-941"><a href="#L-941"><span class="linenos"> 941</span></a>        <span class="k">return</span> <span class="n">response</span>
</span><span id="L-942"><a href="#L-942"><span class="linenos"> 942</span></a>
</span><span id="L-943"><a href="#L-943"><span class="linenos"> 943</span></a>    <span class="k">def</span> <span class="nf">__parse_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">error</span><span class="p">):</span>
</span><span id="L-944"><a href="#L-944"><span class="linenos"> 944</span></a>        <span class="n">e_code</span> <span class="o">=</span> <span class="n">error</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-945"><a href="#L-945"><span class="linenos"> 945</span></a>        <span class="n">clazz</span> <span class="o">=</span> <span class="n">Error</span>
</span><span id="L-946"><a href="#L-946"><span class="linenos"> 946</span></a>        <span class="n">error_msg</span> <span class="o">=</span> <span class="s2">&quot;Error while sending HTTP request: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
</span><span id="L-947"><a href="#L-947"><span class="linenos"> 947</span></a>
</span><span id="L-948"><a href="#L-948"><span class="linenos"> 948</span></a>        <span class="k">if</span> <span class="n">e_code</span> <span class="ow">in</span> <span class="p">[</span>
</span><span id="L-949"><a href="#L-949"><span class="linenos"> 949</span></a>            <span class="n">pycurl</span><span class="o">.</span><span class="n">E_COULDNT_CONNECT</span><span class="p">,</span> <span class="n">pycurl</span><span class="o">.</span><span class="n">E_COULDNT_RESOLVE_HOST</span>
</span><span id="L-950"><a href="#L-950"><span class="linenos"> 950</span></a>        <span class="p">]:</span>
</span><span id="L-951"><a href="#L-951"><span class="linenos"> 951</span></a>            <span class="n">clazz</span> <span class="o">=</span> <span class="ne">ConnectionError</span>
</span><span id="L-952"><a href="#L-952"><span class="linenos"> 952</span></a>        <span class="k">elif</span> <span class="n">e_code</span> <span class="o">==</span> <span class="n">pycurl</span><span class="o">.</span><span class="n">E_OPERATION_TIMEOUTED</span><span class="p">:</span>
</span><span id="L-953"><a href="#L-953"><span class="linenos"> 953</span></a>            <span class="n">clazz</span> <span class="o">=</span> <span class="ne">TimeoutError</span>
</span><span id="L-954"><a href="#L-954"><span class="linenos"> 954</span></a>
</span><span id="L-955"><a href="#L-955"><span class="linenos"> 955</span></a>        <span class="k">raise</span> <span class="n">clazz</span><span class="p">(</span><span class="n">error_msg</span><span class="p">)</span><span class="o">.</span><span class="n">with_traceback</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">2</span><span class="p">])</span>
</span><span id="L-956"><a href="#L-956"><span class="linenos"> 956</span></a>
</span><span id="L-957"><a href="#L-957"><span class="linenos"> 957</span></a>    <span class="k">def</span> <span class="nf">_get_header_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">headers</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
</span><span id="L-958"><a href="#L-958"><span class="linenos"> 958</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-959"><a href="#L-959"><span class="linenos"> 959</span></a><span class="sd">        Return header value by its name.</span>
</span><span id="L-960"><a href="#L-960"><span class="linenos"> 960</span></a>
</span><span id="L-961"><a href="#L-961"><span class="linenos"> 961</span></a><span class="sd">        `headers` list of headers</span>
</span><span id="L-962"><a href="#L-962"><span class="linenos"> 962</span></a><span class="sd">        `name` name of the header</span>
</span><span id="L-963"><a href="#L-963"><span class="linenos"> 963</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-964"><a href="#L-964"><span class="linenos"> 964</span></a>        <span class="k">return</span> <span class="nb">next</span><span class="p">(</span>
</span><span id="L-965"><a href="#L-965"><span class="linenos"> 965</span></a>            <span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">headers</span> <span class="k">if</span> <span class="n">h</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">name</span><span class="p">)),</span>
</span><span id="L-966"><a href="#L-966"><span class="linenos"> 966</span></a>            <span class="kc">None</span>
</span><span id="L-967"><a href="#L-967"><span class="linenos"> 967</span></a>        <span class="p">)</span>
</span><span id="L-968"><a href="#L-968"><span class="linenos"> 968</span></a>
</span><span id="L-969"><a href="#L-969"><span class="linenos"> 969</span></a>    <span class="k">def</span> <span class="nf">_curl_debug</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">debug_type</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span><span id="L-970"><a href="#L-970"><span class="linenos"> 970</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-971"><a href="#L-971"><span class="linenos"> 971</span></a><span class="sd">        This is the implementation of the cURL debug callback.</span>
</span><span id="L-972"><a href="#L-972"><span class="linenos"> 972</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-973"><a href="#L-973"><span class="linenos"> 973</span></a>
</span><span id="L-974"><a href="#L-974"><span class="linenos"> 974</span></a>        <span class="c1"># Exclude all types of debug data that we don&#39;t know how to</span>
</span><span id="L-975"><a href="#L-975"><span class="linenos"> 975</span></a>        <span class="c1"># handle, as trying to decode and manipulate that data as</span>
</span><span id="L-976"><a href="#L-976"><span class="linenos"> 976</span></a>        <span class="c1"># strings will likely fail.</span>
</span><span id="L-977"><a href="#L-977"><span class="linenos"> 977</span></a>        <span class="k">if</span> <span class="n">debug_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__KNOWN_DEBUG_TYPES</span><span class="p">:</span>
</span><span id="L-978"><a href="#L-978"><span class="linenos"> 978</span></a>            <span class="k">return</span>
</span><span id="L-979"><a href="#L-979"><span class="linenos"> 979</span></a>
</span><span id="L-980"><a href="#L-980"><span class="linenos"> 980</span></a>        <span class="c1"># Some versions of PycURL provide the debug data as strings, and</span>
</span><span id="L-981"><a href="#L-981"><span class="linenos"> 981</span></a>        <span class="c1"># some as arrays of bytes, so we need to check the type of the</span>
</span><span id="L-982"><a href="#L-982"><span class="linenos"> 982</span></a>        <span class="c1"># provided data and convert it to strings before trying to</span>
</span><span id="L-983"><a href="#L-983"><span class="linenos"> 983</span></a>        <span class="c1"># manipulate it with the &quot;replace&quot;, &quot;strip&quot; and &quot;split&quot; methods:</span>
</span><span id="L-984"><a href="#L-984"><span class="linenos"> 984</span></a>        <span class="n">text</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)</span> <span class="k">else</span> <span class="n">data</span>
</span><span id="L-985"><a href="#L-985"><span class="linenos"> 985</span></a>
</span><span id="L-986"><a href="#L-986"><span class="linenos"> 986</span></a>        <span class="c1"># Split the debug data into lines and send a debug message for</span>
</span><span id="L-987"><a href="#L-987"><span class="linenos"> 987</span></a>        <span class="c1"># each line:</span>
</span><span id="L-988"><a href="#L-988"><span class="linenos"> 988</span></a>        <span class="n">lines</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\r\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-989"><a href="#L-989"><span class="linenos"> 989</span></a>        <span class="n">prefix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__DEBUG_PREFIXES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">debug_type</span><span class="p">)</span>
</span><span id="L-990"><a href="#L-990"><span class="linenos"> 990</span></a>        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
</span><span id="L-991"><a href="#L-991"><span class="linenos"> 991</span></a>            <span class="k">if</span> <span class="n">prefix</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-992"><a href="#L-992"><span class="linenos"> 992</span></a>                <span class="n">line</span> <span class="o">=</span> <span class="n">prefix</span> <span class="o">+</span> <span class="n">line</span>
</span><span id="L-993"><a href="#L-993"><span class="linenos"> 993</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="L-994"><a href="#L-994"><span class="linenos"> 994</span></a>
</span><span id="L-995"><a href="#L-995"><span class="linenos"> 995</span></a>    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-996"><a href="#L-996"><span class="linenos"> 996</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="L-997"><a href="#L-997"><span class="linenos"> 997</span></a>
</span><span id="L-998"><a href="#L-998"><span class="linenos"> 998</span></a>    <span class="k">def</span> <span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_value</span><span class="p">,</span> <span class="n">traceback</span><span class="p">):</span>
</span><span id="L-999"><a href="#L-999"><span class="linenos"> 999</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="L-1000"><a href="#L-1000"><span class="linenos">1000</span></a>
</span><span id="L-1001"><a href="#L-1001"><span class="linenos">1001</span></a>
</span><span id="L-1002"><a href="#L-1002"><span class="linenos">1002</span></a><span class="k">class</span> <span class="nc">ConnectionBuilder</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span><span id="L-1003"><a href="#L-1003"><span class="linenos">1003</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1004"><a href="#L-1004"><span class="linenos">1004</span></a><span class="sd">    This class is a mechanism to simplify the repeated creation of</span>
</span><span id="L-1005"><a href="#L-1005"><span class="linenos">1005</span></a><span class="sd">    multiple connections. It stores the connection parameters given</span>
</span><span id="L-1006"><a href="#L-1006"><span class="linenos">1006</span></a><span class="sd">    in its constructor, and has a single `build` method that is</span>
</span><span id="L-1007"><a href="#L-1007"><span class="linenos">1007</span></a><span class="sd">    equivalent to calling the constructor of the `Connection`</span>
</span><span id="L-1008"><a href="#L-1008"><span class="linenos">1008</span></a><span class="sd">    class. Typical use will be like this:</span>
</span><span id="L-1009"><a href="#L-1009"><span class="linenos">1009</span></a>
</span><span id="L-1010"><a href="#L-1010"><span class="linenos">1010</span></a><span class="sd">    ```python</span>
</span><span id="L-1011"><a href="#L-1011"><span class="linenos">1011</span></a><span class="sd">    # Create the builder once:</span>
</span><span id="L-1012"><a href="#L-1012"><span class="linenos">1012</span></a><span class="sd">    builder = ConnectionBuilder(</span>
</span><span id="L-1013"><a href="#L-1013"><span class="linenos">1013</span></a><span class="sd">        url=&#39;https://enginer40.example.com/ovirt-engine/api&#39;,</span>
</span><span id="L-1014"><a href="#L-1014"><span class="linenos">1014</span></a><span class="sd">        username=&#39;admin@internal&#39;,</span>
</span><span id="L-1015"><a href="#L-1015"><span class="linenos">1015</span></a><span class="sd">        password=&#39;redhat123&#39;,</span>
</span><span id="L-1016"><a href="#L-1016"><span class="linenos">1016</span></a><span class="sd">        ca_file=&#39;ca.pem&#39;,</span>
</span><span id="L-1017"><a href="#L-1017"><span class="linenos">1017</span></a><span class="sd">    )</span>
</span><span id="L-1018"><a href="#L-1018"><span class="linenos">1018</span></a>
</span><span id="L-1019"><a href="#L-1019"><span class="linenos">1019</span></a><span class="sd">    # Create and use first connection:</span>
</span><span id="L-1020"><a href="#L-1020"><span class="linenos">1020</span></a><span class="sd">    with builder.build() as connection:</span>
</span><span id="L-1021"><a href="#L-1021"><span class="linenos">1021</span></a><span class="sd">       ...</span>
</span><span id="L-1022"><a href="#L-1022"><span class="linenos">1022</span></a>
</span><span id="L-1023"><a href="#L-1023"><span class="linenos">1023</span></a><span class="sd">    # Create and use a second connection:</span>
</span><span id="L-1024"><a href="#L-1024"><span class="linenos">1024</span></a><span class="sd">    with builder.build() as connection:</span>
</span><span id="L-1025"><a href="#L-1025"><span class="linenos">1025</span></a><span class="sd">       ...</span>
</span><span id="L-1026"><a href="#L-1026"><span class="linenos">1026</span></a><span class="sd">    ```</span>
</span><span id="L-1027"><a href="#L-1027"><span class="linenos">1027</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1028"><a href="#L-1028"><span class="linenos">1028</span></a>
</span><span id="L-1029"><a href="#L-1029"><span class="linenos">1029</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-1030"><a href="#L-1030"><span class="linenos">1030</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1031"><a href="#L-1031"><span class="linenos">1031</span></a><span class="sd">        Creates a new connection builder. The parameters are the same</span>
</span><span id="L-1032"><a href="#L-1032"><span class="linenos">1032</span></a><span class="sd">        accepted by the constructor of the `Connnection` class.</span>
</span><span id="L-1033"><a href="#L-1033"><span class="linenos">1033</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1034"><a href="#L-1034"><span class="linenos">1034</span></a>
</span><span id="L-1035"><a href="#L-1035"><span class="linenos">1035</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>
</span><span id="L-1036"><a href="#L-1036"><span class="linenos">1036</span></a>
</span><span id="L-1037"><a href="#L-1037"><span class="linenos">1037</span></a>    <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1038"><a href="#L-1038"><span class="linenos">1038</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1039"><a href="#L-1039"><span class="linenos">1039</span></a><span class="sd">        Creates a new connection using the parameters passed to the</span>
</span><span id="L-1040"><a href="#L-1040"><span class="linenos">1040</span></a><span class="sd">        constructor, and returns it.</span>
</span><span id="L-1041"><a href="#L-1041"><span class="linenos">1041</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1042"><a href="#L-1042"><span class="linenos">1042</span></a>
</span><span id="L-1043"><a href="#L-1043"><span class="linenos">1043</span></a>        <span class="k">return</span> <span class="n">Connection</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_kwargs</span><span class="p">)</span>
</span><span id="L-1044"><a href="#L-1044"><span class="linenos">1044</span></a>
</span><span id="L-1045"><a href="#L-1045"><span class="linenos">1045</span></a>
</span><span id="L-1046"><a href="#L-1046"><span class="linenos">1046</span></a><span class="c1"># We need to import readers and writers here, so the generic</span>
</span><span id="L-1047"><a href="#L-1047"><span class="linenos">1047</span></a><span class="c1"># writer and reader are initialized. This has also benefit that</span>
</span><span id="L-1048"><a href="#L-1048"><span class="linenos">1048</span></a><span class="c1"># the readers/writers/types/services can be used right after the</span>
</span><span id="L-1049"><a href="#L-1049"><span class="linenos">1049</span></a><span class="c1"># top level sdk module import, for example:</span>
</span><span id="L-1050"><a href="#L-1050"><span class="linenos">1050</span></a><span class="c1">#</span>
</span><span id="L-1051"><a href="#L-1051"><span class="linenos">1051</span></a><span class="c1">#   import ovirtsdk4 as sdk</span>
</span><span id="L-1052"><a href="#L-1052"><span class="linenos">1052</span></a><span class="c1">#   vm = sdk.types.Vm()</span>
</span><span id="L-1053"><a href="#L-1053"><span class="linenos">1053</span></a><span class="c1">#</span>
</span><span id="L-1054"><a href="#L-1054"><span class="linenos">1054</span></a><span class="kn">import</span> <span class="nn">ovirtsdk4.readers</span> <span class="k">as</span> <span class="nn">readers</span>  <span class="c1"># noqa: E402, F401</span>
</span><span id="L-1055"><a href="#L-1055"><span class="linenos">1055</span></a><span class="kn">import</span> <span class="nn">ovirtsdk4.writers</span> <span class="k">as</span> <span class="nn">writers</span>  <span class="c1"># noqa: E402, F401</span>
</span><span id="L-1056"><a href="#L-1056"><span class="linenos">1056</span></a><span class="kn">import</span> <span class="nn">ovirtsdk4.types</span> <span class="k">as</span> <span class="nn">types</span>  <span class="c1"># noqa: E402, F401</span>
</span><span id="L-1057"><a href="#L-1057"><span class="linenos">1057</span></a><span class="kn">import</span> <span class="nn">ovirtsdk4.services</span> <span class="k">as</span> <span class="nn">services</span>  <span class="c1"># noqa: E402, F401</span>
</span></pre></div>


            </section>
                <section id="get_version">
                            <input id="get_version-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_version</span><span class="signature pdoc-code condensed">(<span class="return-annotation">):</span></span>

                <label class="view-source-button" for="get_version-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_version"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_version-37"><a href="#get_version-37"><span class="linenos">37</span></a><span class="k">def</span> <span class="nf">get_version</span><span class="p">():</span>
</span><span id="get_version-38"><a href="#get_version-38"><span class="linenos">38</span></a>    <span class="kn">from</span> <span class="nn">ovirtsdk4</span> <span class="kn">import</span> <span class="n">version</span>
</span><span id="get_version-39"><a href="#get_version-39"><span class="linenos">39</span></a>    <span class="k">return</span> <span class="n">version</span><span class="o">.</span><span class="n">VERSION</span>
</span></pre></div>


    

                </section>
                <section id="Error">
                            <input id="Error-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Error</span><wbr>(<span class="base">builtins.Exception</span>):

                <label class="view-source-button" for="Error-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Error"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Error-42"><a href="#Error-42"><span class="linenos">42</span></a><span class="k">class</span> <span class="nc">Error</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
</span><span id="Error-43"><a href="#Error-43"><span class="linenos">43</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Error-44"><a href="#Error-44"><span class="linenos">44</span></a><span class="sd">    General exception which is thrown by SDK,</span>
</span><span id="Error-45"><a href="#Error-45"><span class="linenos">45</span></a><span class="sd">    indicates that some exception happened in SDK.</span>
</span><span id="Error-46"><a href="#Error-46"><span class="linenos">46</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Error-47"><a href="#Error-47"><span class="linenos">47</span></a>
</span><span id="Error-48"><a href="#Error-48"><span class="linenos">48</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">code</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fault</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Error-49"><a href="#Error-49"><span class="linenos">49</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Error-50"><a href="#Error-50"><span class="linenos">50</span></a><span class="sd">        Creates an instance of Error class.</span>
</span><span id="Error-51"><a href="#Error-51"><span class="linenos">51</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Error-52"><a href="#Error-52"><span class="linenos">52</span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">Error</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</span><span id="Error-53"><a href="#Error-53"><span class="linenos">53</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Error-54"><a href="#Error-54"><span class="linenos">54</span></a><span class="sd">        Creates an instance of Error class.</span>
</span><span id="Error-55"><a href="#Error-55"><span class="linenos">55</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Error-56"><a href="#Error-56"><span class="linenos">56</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">code</span> <span class="o">=</span> <span class="n">code</span>
</span><span id="Error-57"><a href="#Error-57"><span class="linenos">57</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Error-58"><a href="#Error-58"><span class="linenos">58</span></a><span class="sd">        An error code associated to the error. For HTTP related</span>
</span><span id="Error-59"><a href="#Error-59"><span class="linenos">59</span></a><span class="sd">        errors, this will be the HTTP response code returned by the server.</span>
</span><span id="Error-60"><a href="#Error-60"><span class="linenos">60</span></a><span class="sd">        For example, if retrieving of a virtual machine fails because it</span>
</span><span id="Error-61"><a href="#Error-61"><span class="linenos">61</span></a><span class="sd">        doesn&#39;t exist this attribute will contain the integer value 404. Note</span>
</span><span id="Error-62"><a href="#Error-62"><span class="linenos">62</span></a><span class="sd">        that this may be `nil` if the error is not HTTP related.&quot;&quot;&quot;</span>
</span><span id="Error-63"><a href="#Error-63"><span class="linenos">63</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fault</span> <span class="o">=</span> <span class="n">fault</span>
</span><span id="Error-64"><a href="#Error-64"><span class="linenos">64</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Error-65"><a href="#Error-65"><span class="linenos">65</span></a><span class="sd">        The `Fault` object associated to the error.</span>
</span><span id="Error-66"><a href="#Error-66"><span class="linenos">66</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span></pre></div>


            <div class="docstring"><p>General exception which is thrown by SDK,
indicates that some exception happened in SDK.</p>
</div>


                            <div id="Error.__init__" class="classattr">
                                        <input id="Error.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Error</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">message</span>, </span><span class="param"><span class="n">code</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">fault</span><span class="o">=</span><span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="Error.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Error.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Error.__init__-48"><a href="#Error.__init__-48"><span class="linenos">48</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">code</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fault</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Error.__init__-49"><a href="#Error.__init__-49"><span class="linenos">49</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Error.__init__-50"><a href="#Error.__init__-50"><span class="linenos">50</span></a><span class="sd">        Creates an instance of Error class.</span>
</span><span id="Error.__init__-51"><a href="#Error.__init__-51"><span class="linenos">51</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Error.__init__-52"><a href="#Error.__init__-52"><span class="linenos">52</span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">Error</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</span><span id="Error.__init__-53"><a href="#Error.__init__-53"><span class="linenos">53</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Error.__init__-54"><a href="#Error.__init__-54"><span class="linenos">54</span></a><span class="sd">        Creates an instance of Error class.</span>
</span><span id="Error.__init__-55"><a href="#Error.__init__-55"><span class="linenos">55</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Error.__init__-56"><a href="#Error.__init__-56"><span class="linenos">56</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">code</span> <span class="o">=</span> <span class="n">code</span>
</span><span id="Error.__init__-57"><a href="#Error.__init__-57"><span class="linenos">57</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Error.__init__-58"><a href="#Error.__init__-58"><span class="linenos">58</span></a><span class="sd">        An error code associated to the error. For HTTP related</span>
</span><span id="Error.__init__-59"><a href="#Error.__init__-59"><span class="linenos">59</span></a><span class="sd">        errors, this will be the HTTP response code returned by the server.</span>
</span><span id="Error.__init__-60"><a href="#Error.__init__-60"><span class="linenos">60</span></a><span class="sd">        For example, if retrieving of a virtual machine fails because it</span>
</span><span id="Error.__init__-61"><a href="#Error.__init__-61"><span class="linenos">61</span></a><span class="sd">        doesn&#39;t exist this attribute will contain the integer value 404. Note</span>
</span><span id="Error.__init__-62"><a href="#Error.__init__-62"><span class="linenos">62</span></a><span class="sd">        that this may be `nil` if the error is not HTTP related.&quot;&quot;&quot;</span>
</span><span id="Error.__init__-63"><a href="#Error.__init__-63"><span class="linenos">63</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fault</span> <span class="o">=</span> <span class="n">fault</span>
</span><span id="Error.__init__-64"><a href="#Error.__init__-64"><span class="linenos">64</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Error.__init__-65"><a href="#Error.__init__-65"><span class="linenos">65</span></a><span class="sd">        The `Fault` object associated to the error.</span>
</span><span id="Error.__init__-66"><a href="#Error.__init__-66"><span class="linenos">66</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span></pre></div>


            <div class="docstring"><p>Creates an instance of Error class.</p>
</div>


                            </div>
                            <div id="Error.code" class="classattr">
                                <div class="attr variable">
            <span class="name">code</span>

        
    </div>
    <a class="headerlink" href="#Error.code"></a>
    
            <div class="docstring"><p>An error code associated to the error. For HTTP related
errors, this will be the HTTP response code returned by the server.
For example, if retrieving of a virtual machine fails because it
doesn't exist this attribute will contain the integer value 404. Note
that this may be <code>nil</code> if the error is not HTTP related.</p>
</div>


                            </div>
                            <div id="Error.fault" class="classattr">
                                <div class="attr variable">
            <span class="name">fault</span>

        
    </div>
    <a class="headerlink" href="#Error.fault"></a>
    
            <div class="docstring"><p>The <code>Fault</code> object associated to the error.</p>
</div>


                            </div>
                </section>
                <section id="AuthError">
                            <input id="AuthError-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">AuthError</span><wbr>(<span class="base"><a href="#Error">Error</a></span>):

                <label class="view-source-button" for="AuthError-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AuthError"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AuthError-69"><a href="#AuthError-69"><span class="linenos">69</span></a><span class="k">class</span> <span class="nc">AuthError</span><span class="p">(</span><span class="n">Error</span><span class="p">):</span>
</span><span id="AuthError-70"><a href="#AuthError-70"><span class="linenos">70</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AuthError-71"><a href="#AuthError-71"><span class="linenos">71</span></a><span class="sd">    This class of error indicates that an authentiation or authorization</span>
</span><span id="AuthError-72"><a href="#AuthError-72"><span class="linenos">72</span></a><span class="sd">    problem happenend, like incorrect user name, incorrect password, or</span>
</span><span id="AuthError-73"><a href="#AuthError-73"><span class="linenos">73</span></a><span class="sd">    missing permissions.</span>
</span><span id="AuthError-74"><a href="#AuthError-74"><span class="linenos">74</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="AuthError-75"><a href="#AuthError-75"><span class="linenos">75</span></a>    <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>This class of error indicates that an authentiation or authorization
problem happenend, like incorrect user name, incorrect password, or
missing permissions.</p>
</div>


                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#Error">Error</a></dt>
                                <dd id="AuthError.__init__" class="function"><a href="#Error.__init__">Error</a></dd>
                <dd id="AuthError.code" class="variable"><a href="#Error.code">code</a></dd>
                <dd id="AuthError.fault" class="variable"><a href="#Error.fault">fault</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="ConnectionError">
                            <input id="ConnectionError-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">ConnectionError</span><wbr>(<span class="base"><a href="#Error">Error</a></span>):

                <label class="view-source-button" for="ConnectionError-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ConnectionError"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ConnectionError-78"><a href="#ConnectionError-78"><span class="linenos">78</span></a><span class="k">class</span> <span class="nc">ConnectionError</span><span class="p">(</span><span class="n">Error</span><span class="p">):</span>
</span><span id="ConnectionError-79"><a href="#ConnectionError-79"><span class="linenos">79</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ConnectionError-80"><a href="#ConnectionError-80"><span class="linenos">80</span></a><span class="sd">    This class of error indicates that the name of the server or the name of</span>
</span><span id="ConnectionError-81"><a href="#ConnectionError-81"><span class="linenos">81</span></a><span class="sd">    the proxy can&#39;t be resolved to an IP address, or that the connection</span>
</span><span id="ConnectionError-82"><a href="#ConnectionError-82"><span class="linenos">82</span></a><span class="sd">    can&#39;t be stablished because the server is down or unreachable.</span>
</span><span id="ConnectionError-83"><a href="#ConnectionError-83"><span class="linenos">83</span></a>
</span><span id="ConnectionError-84"><a href="#ConnectionError-84"><span class="linenos">84</span></a><span class="sd">    Note that for this class of error the `code` and `fault` attributes will</span>
</span><span id="ConnectionError-85"><a href="#ConnectionError-85"><span class="linenos">85</span></a><span class="sd">    always be empty, as no response from the server will be available to</span>
</span><span id="ConnectionError-86"><a href="#ConnectionError-86"><span class="linenos">86</span></a><span class="sd">    populate them.</span>
</span><span id="ConnectionError-87"><a href="#ConnectionError-87"><span class="linenos">87</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="ConnectionError-88"><a href="#ConnectionError-88"><span class="linenos">88</span></a>    <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>This class of error indicates that the name of the server or the name of
the proxy can't be resolved to an IP address, or that the connection
can't be stablished because the server is down or unreachable.</p>

<p>Note that for this class of error the <code><a href="#ConnectionError.code">code</a></code> and <code><a href="#ConnectionError.fault">fault</a></code> attributes will
always be empty, as no response from the server will be available to
populate them.</p>
</div>


                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#Error">Error</a></dt>
                                <dd id="ConnectionError.__init__" class="function"><a href="#Error.__init__">Error</a></dd>
                <dd id="ConnectionError.code" class="variable"><a href="#Error.code">code</a></dd>
                <dd id="ConnectionError.fault" class="variable"><a href="#Error.fault">fault</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="NotFoundError">
                            <input id="NotFoundError-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">NotFoundError</span><wbr>(<span class="base"><a href="#Error">Error</a></span>):

                <label class="view-source-button" for="NotFoundError-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NotFoundError"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NotFoundError-91"><a href="#NotFoundError-91"><span class="linenos">91</span></a><span class="k">class</span> <span class="nc">NotFoundError</span><span class="p">(</span><span class="n">Error</span><span class="p">):</span>
</span><span id="NotFoundError-92"><a href="#NotFoundError-92"><span class="linenos">92</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="NotFoundError-93"><a href="#NotFoundError-93"><span class="linenos">93</span></a><span class="sd">    This class of error indicates that an object can&#39;t be found.</span>
</span><span id="NotFoundError-94"><a href="#NotFoundError-94"><span class="linenos">94</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="NotFoundError-95"><a href="#NotFoundError-95"><span class="linenos">95</span></a>    <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>This class of error indicates that an object can't be found.</p>
</div>


                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#Error">Error</a></dt>
                                <dd id="NotFoundError.__init__" class="function"><a href="#Error.__init__">Error</a></dd>
                <dd id="NotFoundError.code" class="variable"><a href="#Error.code">code</a></dd>
                <dd id="NotFoundError.fault" class="variable"><a href="#Error.fault">fault</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="TimeoutError">
                            <input id="TimeoutError-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">TimeoutError</span><wbr>(<span class="base"><a href="#Error">Error</a></span>):

                <label class="view-source-button" for="TimeoutError-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TimeoutError"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TimeoutError-98"><a href="#TimeoutError-98"><span class="linenos"> 98</span></a><span class="k">class</span> <span class="nc">TimeoutError</span><span class="p">(</span><span class="n">Error</span><span class="p">):</span>
</span><span id="TimeoutError-99"><a href="#TimeoutError-99"><span class="linenos"> 99</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TimeoutError-100"><a href="#TimeoutError-100"><span class="linenos">100</span></a><span class="sd">    This class of error indicates that an operation timed out.</span>
</span><span id="TimeoutError-101"><a href="#TimeoutError-101"><span class="linenos">101</span></a>
</span><span id="TimeoutError-102"><a href="#TimeoutError-102"><span class="linenos">102</span></a><span class="sd">    Note that for this class of error the `code` and `fault` attributes will</span>
</span><span id="TimeoutError-103"><a href="#TimeoutError-103"><span class="linenos">103</span></a><span class="sd">    always be empty, as no response from the server will be available to</span>
</span><span id="TimeoutError-104"><a href="#TimeoutError-104"><span class="linenos">104</span></a><span class="sd">    populate them.</span>
</span><span id="TimeoutError-105"><a href="#TimeoutError-105"><span class="linenos">105</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="TimeoutError-106"><a href="#TimeoutError-106"><span class="linenos">106</span></a>    <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>This class of error indicates that an operation timed out.</p>

<p>Note that for this class of error the <code><a href="#TimeoutError.code">code</a></code> and <code><a href="#TimeoutError.fault">fault</a></code> attributes will
always be empty, as no response from the server will be available to
populate them.</p>
</div>


                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#Error">Error</a></dt>
                                <dd id="TimeoutError.__init__" class="function"><a href="#Error.__init__">Error</a></dd>
                <dd id="TimeoutError.code" class="variable"><a href="#Error.code">code</a></dd>
                <dd id="TimeoutError.fault" class="variable"><a href="#Error.fault">fault</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="List">
                            <input id="List-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">List</span><wbr>(<span class="base">builtins.list</span>):

                <label class="view-source-button" for="List-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#List"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="List-109"><a href="#List-109"><span class="linenos">109</span></a><span class="k">class</span> <span class="nc">List</span><span class="p">(</span><span class="nb">list</span><span class="p">):</span>
</span><span id="List-110"><a href="#List-110"><span class="linenos">110</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="List-111"><a href="#List-111"><span class="linenos">111</span></a><span class="sd">    This is the base class for all the list types of the SDK. It contains the</span>
</span><span id="List-112"><a href="#List-112"><span class="linenos">112</span></a><span class="sd">    utility methods used by all of them.</span>
</span><span id="List-113"><a href="#List-113"><span class="linenos">113</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="List-114"><a href="#List-114"><span class="linenos">114</span></a>
</span><span id="List-115"><a href="#List-115"><span class="linenos">115</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">href</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="List-116"><a href="#List-116"><span class="linenos">116</span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">List</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span id="List-117"><a href="#List-117"><span class="linenos">117</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_href</span> <span class="o">=</span> <span class="n">href</span>
</span><span id="List-118"><a href="#List-118"><span class="linenos">118</span></a>
</span><span id="List-119"><a href="#List-119"><span class="linenos">119</span></a>    <span class="nd">@property</span>
</span><span id="List-120"><a href="#List-120"><span class="linenos">120</span></a>    <span class="k">def</span> <span class="nf">href</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="List-121"><a href="#List-121"><span class="linenos">121</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="List-122"><a href="#List-122"><span class="linenos">122</span></a><span class="sd">        Returns the value of the `href` attribute.</span>
</span><span id="List-123"><a href="#List-123"><span class="linenos">123</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="List-124"><a href="#List-124"><span class="linenos">124</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_href</span>
</span><span id="List-125"><a href="#List-125"><span class="linenos">125</span></a>
</span><span id="List-126"><a href="#List-126"><span class="linenos">126</span></a>    <span class="nd">@href</span><span class="o">.</span><span class="n">setter</span>
</span><span id="List-127"><a href="#List-127"><span class="linenos">127</span></a>    <span class="k">def</span> <span class="nf">href</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="List-128"><a href="#List-128"><span class="linenos">128</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="List-129"><a href="#List-129"><span class="linenos">129</span></a><span class="sd">        Sets the value of the `href` attribute.</span>
</span><span id="List-130"><a href="#List-130"><span class="linenos">130</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="List-131"><a href="#List-131"><span class="linenos">131</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_href</span> <span class="o">=</span> <span class="n">value</span>
</span></pre></div>


            <div class="docstring"><p>This is the base class for all the list types of the SDK. It contains the
utility methods used by all of them.</p>
</div>


                            <div id="List.__init__" class="classattr">
                                        <input id="List.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">List</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">href</span><span class="o">=</span><span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="List.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#List.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="List.__init__-115"><a href="#List.__init__-115"><span class="linenos">115</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">href</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="List.__init__-116"><a href="#List.__init__-116"><span class="linenos">116</span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">List</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span id="List.__init__-117"><a href="#List.__init__-117"><span class="linenos">117</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_href</span> <span class="o">=</span> <span class="n">href</span>
</span></pre></div>


    

                            </div>
                            <div id="List.href" class="classattr">
                                        <input id="List.href-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">href</span>

                <label class="view-source-button" for="List.href-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#List.href"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="List.href-119"><a href="#List.href-119"><span class="linenos">119</span></a>    <span class="nd">@property</span>
</span><span id="List.href-120"><a href="#List.href-120"><span class="linenos">120</span></a>    <span class="k">def</span> <span class="nf">href</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="List.href-121"><a href="#List.href-121"><span class="linenos">121</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="List.href-122"><a href="#List.href-122"><span class="linenos">122</span></a><span class="sd">        Returns the value of the `href` attribute.</span>
</span><span id="List.href-123"><a href="#List.href-123"><span class="linenos">123</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="List.href-124"><a href="#List.href-124"><span class="linenos">124</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_href</span>
</span></pre></div>


            <div class="docstring"><p>Returns the value of the <code><a href="#List.href">href</a></code> attribute.</p>
</div>


                            </div>
                </section>
                <section id="Struct">
                            <input id="Struct-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Struct</span>:

                <label class="view-source-button" for="Struct-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Struct"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Struct-134"><a href="#Struct-134"><span class="linenos">134</span></a><span class="k">class</span> <span class="nc">Struct</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span><span id="Struct-135"><a href="#Struct-135"><span class="linenos">135</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Struct-136"><a href="#Struct-136"><span class="linenos">136</span></a><span class="sd">    This is the base class for all the struct types of the SDK. It contains</span>
</span><span id="Struct-137"><a href="#Struct-137"><span class="linenos">137</span></a><span class="sd">    the utility methods used by all of them.</span>
</span><span id="Struct-138"><a href="#Struct-138"><span class="linenos">138</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Struct-139"><a href="#Struct-139"><span class="linenos">139</span></a>
</span><span id="Struct-140"><a href="#Struct-140"><span class="linenos">140</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">href</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Struct-141"><a href="#Struct-141"><span class="linenos">141</span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">Struct</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span id="Struct-142"><a href="#Struct-142"><span class="linenos">142</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_href</span> <span class="o">=</span> <span class="n">href</span>
</span><span id="Struct-143"><a href="#Struct-143"><span class="linenos">143</span></a>
</span><span id="Struct-144"><a href="#Struct-144"><span class="linenos">144</span></a>    <span class="nd">@property</span>
</span><span id="Struct-145"><a href="#Struct-145"><span class="linenos">145</span></a>    <span class="k">def</span> <span class="nf">href</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Struct-146"><a href="#Struct-146"><span class="linenos">146</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Struct-147"><a href="#Struct-147"><span class="linenos">147</span></a><span class="sd">        Returns the value of the `href` attribute.</span>
</span><span id="Struct-148"><a href="#Struct-148"><span class="linenos">148</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Struct-149"><a href="#Struct-149"><span class="linenos">149</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_href</span>
</span><span id="Struct-150"><a href="#Struct-150"><span class="linenos">150</span></a>
</span><span id="Struct-151"><a href="#Struct-151"><span class="linenos">151</span></a>    <span class="nd">@href</span><span class="o">.</span><span class="n">setter</span>
</span><span id="Struct-152"><a href="#Struct-152"><span class="linenos">152</span></a>    <span class="k">def</span> <span class="nf">href</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="Struct-153"><a href="#Struct-153"><span class="linenos">153</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Struct-154"><a href="#Struct-154"><span class="linenos">154</span></a><span class="sd">        Sets the value of the `href` attribute.</span>
</span><span id="Struct-155"><a href="#Struct-155"><span class="linenos">155</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Struct-156"><a href="#Struct-156"><span class="linenos">156</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_href</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="Struct-157"><a href="#Struct-157"><span class="linenos">157</span></a>
</span><span id="Struct-158"><a href="#Struct-158"><span class="linenos">158</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Struct-159"><a href="#Struct-159"><span class="linenos">159</span></a>    <span class="k">def</span> <span class="nf">_check_type</span><span class="p">(</span><span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">expected</span><span class="p">):</span>
</span><span id="Struct-160"><a href="#Struct-160"><span class="linenos">160</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Struct-161"><a href="#Struct-161"><span class="linenos">161</span></a><span class="sd">        Checks that the given types match, and generates an exception if</span>
</span><span id="Struct-162"><a href="#Struct-162"><span class="linenos">162</span></a><span class="sd">        they don&#39;t.</span>
</span><span id="Struct-163"><a href="#Struct-163"><span class="linenos">163</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Struct-164"><a href="#Struct-164"><span class="linenos">164</span></a>        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Struct-165"><a href="#Struct-165"><span class="linenos">165</span></a>            <span class="n">actual</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="Struct-166"><a href="#Struct-166"><span class="linenos">166</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">actual</span> <span class="o">==</span> <span class="n">expected</span><span class="p">:</span>
</span><span id="Struct-167"><a href="#Struct-167"><span class="linenos">167</span></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">((</span>
</span><span id="Struct-168"><a href="#Struct-168"><span class="linenos">168</span></a>                    <span class="s2">&quot;The type &#39;</span><span class="si">{actual}</span><span class="s2">&#39; isn&#39;t valid for &quot;</span>
</span><span id="Struct-169"><a href="#Struct-169"><span class="linenos">169</span></a>                    <span class="s2">&quot;attribute &#39;</span><span class="si">{attribute}</span><span class="s2">&#39;, it must be &quot;</span>
</span><span id="Struct-170"><a href="#Struct-170"><span class="linenos">170</span></a>                    <span class="s2">&quot;&#39;</span><span class="si">{expected}</span><span class="s2">&#39;&quot;</span>
</span><span id="Struct-171"><a href="#Struct-171"><span class="linenos">171</span></a>                <span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="Struct-172"><a href="#Struct-172"><span class="linenos">172</span></a>                    <span class="n">attribute</span><span class="o">=</span><span class="n">attribute</span><span class="p">,</span>
</span><span id="Struct-173"><a href="#Struct-173"><span class="linenos">173</span></a>                    <span class="n">actual</span><span class="o">=</span><span class="n">actual</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
</span><span id="Struct-174"><a href="#Struct-174"><span class="linenos">174</span></a>                    <span class="n">expected</span><span class="o">=</span><span class="n">expected</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
</span><span id="Struct-175"><a href="#Struct-175"><span class="linenos">175</span></a>                <span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>This is the base class for all the struct types of the SDK. It contains
the utility methods used by all of them.</p>
</div>


                            <div id="Struct.__init__" class="classattr">
                                        <input id="Struct.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Struct</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">href</span><span class="o">=</span><span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="Struct.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Struct.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Struct.__init__-140"><a href="#Struct.__init__-140"><span class="linenos">140</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">href</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Struct.__init__-141"><a href="#Struct.__init__-141"><span class="linenos">141</span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">Struct</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span id="Struct.__init__-142"><a href="#Struct.__init__-142"><span class="linenos">142</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_href</span> <span class="o">=</span> <span class="n">href</span>
</span></pre></div>


    

                            </div>
                            <div id="Struct.href" class="classattr">
                                        <input id="Struct.href-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">href</span>

                <label class="view-source-button" for="Struct.href-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Struct.href"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Struct.href-144"><a href="#Struct.href-144"><span class="linenos">144</span></a>    <span class="nd">@property</span>
</span><span id="Struct.href-145"><a href="#Struct.href-145"><span class="linenos">145</span></a>    <span class="k">def</span> <span class="nf">href</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Struct.href-146"><a href="#Struct.href-146"><span class="linenos">146</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Struct.href-147"><a href="#Struct.href-147"><span class="linenos">147</span></a><span class="sd">        Returns the value of the `href` attribute.</span>
</span><span id="Struct.href-148"><a href="#Struct.href-148"><span class="linenos">148</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Struct.href-149"><a href="#Struct.href-149"><span class="linenos">149</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_href</span>
</span></pre></div>


            <div class="docstring"><p>Returns the value of the <code><a href="#Struct.href">href</a></code> attribute.</p>
</div>


                            </div>
                </section>
                <section id="Connection">
                            <input id="Connection-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Connection</span>:

                <label class="view-source-button" for="Connection-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Connection"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Connection-178"><a href="#Connection-178"><span class="linenos"> 178</span></a><span class="k">class</span> <span class="nc">Connection</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span><span id="Connection-179"><a href="#Connection-179"><span class="linenos"> 179</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Connection-180"><a href="#Connection-180"><span class="linenos"> 180</span></a><span class="sd">    This class is responsible for managing an HTTP connection to the engine</span>
</span><span id="Connection-181"><a href="#Connection-181"><span class="linenos"> 181</span></a><span class="sd">    server. It is intended as the entry point for the SDK, and it provides</span>
</span><span id="Connection-182"><a href="#Connection-182"><span class="linenos"> 182</span></a><span class="sd">    access to the `system` service and, from there, to the rest of the</span>
</span><span id="Connection-183"><a href="#Connection-183"><span class="linenos"> 183</span></a><span class="sd">    services provided by the API.</span>
</span><span id="Connection-184"><a href="#Connection-184"><span class="linenos"> 184</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Connection-185"><a href="#Connection-185"><span class="linenos"> 185</span></a>
</span><span id="Connection-186"><a href="#Connection-186"><span class="linenos"> 186</span></a>    <span class="c1"># Regular expression used to check XML content type.</span>
</span><span id="Connection-187"><a href="#Connection-187"><span class="linenos"> 187</span></a>    <span class="n">__XML_CONTENT_TYPE_RE</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^\s*(application|text)/xml\s*(;.*)?$&quot;</span><span class="p">)</span>
</span><span id="Connection-188"><a href="#Connection-188"><span class="linenos"> 188</span></a>
</span><span id="Connection-189"><a href="#Connection-189"><span class="linenos"> 189</span></a>    <span class="c1"># Regular expression used to check JSON content type.</span>
</span><span id="Connection-190"><a href="#Connection-190"><span class="linenos"> 190</span></a>    <span class="n">__JSON_CONTENT_TYPE_RE</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^\s*(application|text)/json\s*(;.*)?$&quot;</span><span class="p">)</span>
</span><span id="Connection-191"><a href="#Connection-191"><span class="linenos"> 191</span></a>
</span><span id="Connection-192"><a href="#Connection-192"><span class="linenos"> 192</span></a>    <span class="c1"># The typical URL path, used just to generate informative error messages.</span>
</span><span id="Connection-193"><a href="#Connection-193"><span class="linenos"> 193</span></a>    <span class="n">__TYPICAL_PATH</span> <span class="o">=</span> <span class="s1">&#39;/ovirt-engine/api&#39;</span>
</span><span id="Connection-194"><a href="#Connection-194"><span class="linenos"> 194</span></a>
</span><span id="Connection-195"><a href="#Connection-195"><span class="linenos"> 195</span></a>    <span class="c1"># Debug types that we know how to handle. Everything else will be</span>
</span><span id="Connection-196"><a href="#Connection-196"><span class="linenos"> 196</span></a>    <span class="c1"># silently ignored.</span>
</span><span id="Connection-197"><a href="#Connection-197"><span class="linenos"> 197</span></a>    <span class="n">__KNOWN_DEBUG_TYPES</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="Connection-198"><a href="#Connection-198"><span class="linenos"> 198</span></a>        <span class="n">pycurl</span><span class="o">.</span><span class="n">INFOTYPE_TEXT</span><span class="p">,</span>
</span><span id="Connection-199"><a href="#Connection-199"><span class="linenos"> 199</span></a>        <span class="n">pycurl</span><span class="o">.</span><span class="n">INFOTYPE_HEADER_IN</span><span class="p">,</span>
</span><span id="Connection-200"><a href="#Connection-200"><span class="linenos"> 200</span></a>        <span class="n">pycurl</span><span class="o">.</span><span class="n">INFOTYPE_HEADER_OUT</span><span class="p">,</span>
</span><span id="Connection-201"><a href="#Connection-201"><span class="linenos"> 201</span></a>        <span class="n">pycurl</span><span class="o">.</span><span class="n">INFOTYPE_DATA_IN</span><span class="p">,</span>
</span><span id="Connection-202"><a href="#Connection-202"><span class="linenos"> 202</span></a>        <span class="n">pycurl</span><span class="o">.</span><span class="n">INFOTYPE_DATA_OUT</span><span class="p">,</span>
</span><span id="Connection-203"><a href="#Connection-203"><span class="linenos"> 203</span></a>    <span class="p">]</span>
</span><span id="Connection-204"><a href="#Connection-204"><span class="linenos"> 204</span></a>
</span><span id="Connection-205"><a href="#Connection-205"><span class="linenos"> 205</span></a>    <span class="c1"># Prefixes to use for debug data types:</span>
</span><span id="Connection-206"><a href="#Connection-206"><span class="linenos"> 206</span></a>    <span class="n">__DEBUG_PREFIXES</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="Connection-207"><a href="#Connection-207"><span class="linenos"> 207</span></a>        <span class="n">pycurl</span><span class="o">.</span><span class="n">INFOTYPE_TEXT</span><span class="p">:</span> <span class="s1">&#39;* &#39;</span><span class="p">,</span>
</span><span id="Connection-208"><a href="#Connection-208"><span class="linenos"> 208</span></a>        <span class="n">pycurl</span><span class="o">.</span><span class="n">INFOTYPE_HEADER_IN</span><span class="p">:</span> <span class="s1">&#39;&gt; &#39;</span><span class="p">,</span>
</span><span id="Connection-209"><a href="#Connection-209"><span class="linenos"> 209</span></a>        <span class="n">pycurl</span><span class="o">.</span><span class="n">INFOTYPE_HEADER_OUT</span><span class="p">:</span> <span class="s1">&#39;&lt; &#39;</span><span class="p">,</span>
</span><span id="Connection-210"><a href="#Connection-210"><span class="linenos"> 210</span></a>        <span class="n">pycurl</span><span class="o">.</span><span class="n">INFOTYPE_DATA_IN</span><span class="p">:</span> <span class="s1">&#39;&gt; &#39;</span><span class="p">,</span>
</span><span id="Connection-211"><a href="#Connection-211"><span class="linenos"> 211</span></a>        <span class="n">pycurl</span><span class="o">.</span><span class="n">INFOTYPE_DATA_OUT</span><span class="p">:</span> <span class="s1">&#39;&lt; &#39;</span><span class="p">,</span>
</span><span id="Connection-212"><a href="#Connection-212"><span class="linenos"> 212</span></a>    <span class="p">}</span>
</span><span id="Connection-213"><a href="#Connection-213"><span class="linenos"> 213</span></a>
</span><span id="Connection-214"><a href="#Connection-214"><span class="linenos"> 214</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="Connection-215"><a href="#Connection-215"><span class="linenos"> 215</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Connection-216"><a href="#Connection-216"><span class="linenos"> 216</span></a>        <span class="n">url</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Connection-217"><a href="#Connection-217"><span class="linenos"> 217</span></a>        <span class="n">username</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Connection-218"><a href="#Connection-218"><span class="linenos"> 218</span></a>        <span class="n">password</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Connection-219"><a href="#Connection-219"><span class="linenos"> 219</span></a>        <span class="n">token</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Connection-220"><a href="#Connection-220"><span class="linenos"> 220</span></a>        <span class="n">insecure</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="Connection-221"><a href="#Connection-221"><span class="linenos"> 221</span></a>        <span class="n">ca_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Connection-222"><a href="#Connection-222"><span class="linenos"> 222</span></a>        <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="Connection-223"><a href="#Connection-223"><span class="linenos"> 223</span></a>        <span class="n">log</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Connection-224"><a href="#Connection-224"><span class="linenos"> 224</span></a>        <span class="n">kerberos</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="Connection-225"><a href="#Connection-225"><span class="linenos"> 225</span></a>        <span class="n">timeout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="Connection-226"><a href="#Connection-226"><span class="linenos"> 226</span></a>        <span class="n">compress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="Connection-227"><a href="#Connection-227"><span class="linenos"> 227</span></a>        <span class="n">sso_url</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Connection-228"><a href="#Connection-228"><span class="linenos"> 228</span></a>        <span class="n">sso_revoke_url</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Connection-229"><a href="#Connection-229"><span class="linenos"> 229</span></a>        <span class="n">sso_token_name</span><span class="o">=</span><span class="s1">&#39;access_token&#39;</span><span class="p">,</span>
</span><span id="Connection-230"><a href="#Connection-230"><span class="linenos"> 230</span></a>        <span class="n">headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Connection-231"><a href="#Connection-231"><span class="linenos"> 231</span></a>        <span class="n">pipeline</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="Connection-232"><a href="#Connection-232"><span class="linenos"> 232</span></a>        <span class="n">connections</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="Connection-233"><a href="#Connection-233"><span class="linenos"> 233</span></a>    <span class="p">):</span>
</span><span id="Connection-234"><a href="#Connection-234"><span class="linenos"> 234</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Connection-235"><a href="#Connection-235"><span class="linenos"> 235</span></a><span class="sd">        Creates a new connection to the API server.</span>
</span><span id="Connection-236"><a href="#Connection-236"><span class="linenos"> 236</span></a>
</span><span id="Connection-237"><a href="#Connection-237"><span class="linenos"> 237</span></a><span class="sd">        This method supports the following parameters:</span>
</span><span id="Connection-238"><a href="#Connection-238"><span class="linenos"> 238</span></a>
</span><span id="Connection-239"><a href="#Connection-239"><span class="linenos"> 239</span></a><span class="sd">        `url` \n</span>
</span><span id="Connection-240"><a href="#Connection-240"><span class="linenos"> 240</span></a><span class="sd">        A string containing the base URL of the server, usually</span>
</span><span id="Connection-241"><a href="#Connection-241"><span class="linenos"> 241</span></a><span class="sd">        something like `https://server.example.com/ovirt-engine/api`.</span>
</span><span id="Connection-242"><a href="#Connection-242"><span class="linenos"> 242</span></a>
</span><span id="Connection-243"><a href="#Connection-243"><span class="linenos"> 243</span></a><span class="sd">        `username` \n</span>
</span><span id="Connection-244"><a href="#Connection-244"><span class="linenos"> 244</span></a><span class="sd">        The name of the user, something like `admin@internal`.</span>
</span><span id="Connection-245"><a href="#Connection-245"><span class="linenos"> 245</span></a>
</span><span id="Connection-246"><a href="#Connection-246"><span class="linenos"> 246</span></a><span class="sd">        `password` \n</span>
</span><span id="Connection-247"><a href="#Connection-247"><span class="linenos"> 247</span></a><span class="sd">        The name password of the user.</span>
</span><span id="Connection-248"><a href="#Connection-248"><span class="linenos"> 248</span></a>
</span><span id="Connection-249"><a href="#Connection-249"><span class="linenos"> 249</span></a><span class="sd">        `token` \n</span>
</span><span id="Connection-250"><a href="#Connection-250"><span class="linenos"> 250</span></a><span class="sd">        The token to be used to access API. Optionally, user can</span>
</span><span id="Connection-251"><a href="#Connection-251"><span class="linenos"> 251</span></a><span class="sd">        use token, instead of username and password to access API. If user</span>
</span><span id="Connection-252"><a href="#Connection-252"><span class="linenos"> 252</span></a><span class="sd">        don&#39;t specify `token` parameter, SDK will automatically create one.</span>
</span><span id="Connection-253"><a href="#Connection-253"><span class="linenos"> 253</span></a>
</span><span id="Connection-254"><a href="#Connection-254"><span class="linenos"> 254</span></a><span class="sd">        `insecure` \n</span>
</span><span id="Connection-255"><a href="#Connection-255"><span class="linenos"> 255</span></a><span class="sd">        A boolean flag that indicates if the server TLS</span>
</span><span id="Connection-256"><a href="#Connection-256"><span class="linenos"> 256</span></a><span class="sd">        certificate and host name should be checked.</span>
</span><span id="Connection-257"><a href="#Connection-257"><span class="linenos"> 257</span></a>
</span><span id="Connection-258"><a href="#Connection-258"><span class="linenos"> 258</span></a><span class="sd">        `ca_file` \n</span>
</span><span id="Connection-259"><a href="#Connection-259"><span class="linenos"> 259</span></a><span class="sd">        A PEM file containing the trusted CA certificates. The</span>
</span><span id="Connection-260"><a href="#Connection-260"><span class="linenos"> 260</span></a><span class="sd">        certificate presented by the server will be verified using these CA</span>
</span><span id="Connection-261"><a href="#Connection-261"><span class="linenos"> 261</span></a><span class="sd">        certificates. If `ca_file` parameter is not set, system wide</span>
</span><span id="Connection-262"><a href="#Connection-262"><span class="linenos"> 262</span></a><span class="sd">        CA certificate store is used.</span>
</span><span id="Connection-263"><a href="#Connection-263"><span class="linenos"> 263</span></a>
</span><span id="Connection-264"><a href="#Connection-264"><span class="linenos"> 264</span></a><span class="sd">        `debug` \n</span>
</span><span id="Connection-265"><a href="#Connection-265"><span class="linenos"> 265</span></a><span class="sd">        A boolean flag indicating if debug output should be</span>
</span><span id="Connection-266"><a href="#Connection-266"><span class="linenos"> 266</span></a><span class="sd">        generated. If the value is `True` and the `log` parameter isn&#39;t</span>
</span><span id="Connection-267"><a href="#Connection-267"><span class="linenos"> 267</span></a><span class="sd">        `None` then the data sent to and received from the server will</span>
</span><span id="Connection-268"><a href="#Connection-268"><span class="linenos"> 268</span></a><span class="sd">        be written to the log. Be aware that user names and passwords will</span>
</span><span id="Connection-269"><a href="#Connection-269"><span class="linenos"> 269</span></a><span class="sd">        also be written, so handle it with care.</span>
</span><span id="Connection-270"><a href="#Connection-270"><span class="linenos"> 270</span></a>
</span><span id="Connection-271"><a href="#Connection-271"><span class="linenos"> 271</span></a><span class="sd">        `log` \n</span>
</span><span id="Connection-272"><a href="#Connection-272"><span class="linenos"> 272</span></a><span class="sd">        The logger where the log messages will be written.</span>
</span><span id="Connection-273"><a href="#Connection-273"><span class="linenos"> 273</span></a>
</span><span id="Connection-274"><a href="#Connection-274"><span class="linenos"> 274</span></a><span class="sd">        `kerberos` \n</span>
</span><span id="Connection-275"><a href="#Connection-275"><span class="linenos"> 275</span></a><span class="sd">        A boolean flag indicating if Kerberos</span>
</span><span id="Connection-276"><a href="#Connection-276"><span class="linenos"> 276</span></a><span class="sd">        authentication should be used instead of the default basic</span>
</span><span id="Connection-277"><a href="#Connection-277"><span class="linenos"> 277</span></a><span class="sd">        authentication.</span>
</span><span id="Connection-278"><a href="#Connection-278"><span class="linenos"> 278</span></a>
</span><span id="Connection-279"><a href="#Connection-279"><span class="linenos"> 279</span></a><span class="sd">        `timeout` \n</span>
</span><span id="Connection-280"><a href="#Connection-280"><span class="linenos"> 280</span></a><span class="sd">        The maximum total time to wait for the response, in</span>
</span><span id="Connection-281"><a href="#Connection-281"><span class="linenos"> 281</span></a><span class="sd">        seconds. A value of zero (the default) means wait for ever. If</span>
</span><span id="Connection-282"><a href="#Connection-282"><span class="linenos"> 282</span></a><span class="sd">        the timeout expires before the response is received an exception</span>
</span><span id="Connection-283"><a href="#Connection-283"><span class="linenos"> 283</span></a><span class="sd">        will be raised.</span>
</span><span id="Connection-284"><a href="#Connection-284"><span class="linenos"> 284</span></a>
</span><span id="Connection-285"><a href="#Connection-285"><span class="linenos"> 285</span></a><span class="sd">        `compress` \n</span>
</span><span id="Connection-286"><a href="#Connection-286"><span class="linenos"> 286</span></a><span class="sd">        A boolean flag indicating if the SDK should ask</span>
</span><span id="Connection-287"><a href="#Connection-287"><span class="linenos"> 287</span></a><span class="sd">        the server to send compressed responses. The default is `True`.</span>
</span><span id="Connection-288"><a href="#Connection-288"><span class="linenos"> 288</span></a><span class="sd">        Note that this is a hint for the server, and that it may return</span>
</span><span id="Connection-289"><a href="#Connection-289"><span class="linenos"> 289</span></a><span class="sd">        uncompressed data even when this parameter is set to `True`.</span>
</span><span id="Connection-290"><a href="#Connection-290"><span class="linenos"> 290</span></a><span class="sd">        Note that compression will be disabled if user pass `debug`</span>
</span><span id="Connection-291"><a href="#Connection-291"><span class="linenos"> 291</span></a><span class="sd">        parameter set to `true`, so the debug messages are in plain text.</span>
</span><span id="Connection-292"><a href="#Connection-292"><span class="linenos"> 292</span></a>
</span><span id="Connection-293"><a href="#Connection-293"><span class="linenos"> 293</span></a><span class="sd">        `sso_url` \n</span>
</span><span id="Connection-294"><a href="#Connection-294"><span class="linenos"> 294</span></a><span class="sd">        A string containing the base SSO URL of the serve.</span>
</span><span id="Connection-295"><a href="#Connection-295"><span class="linenos"> 295</span></a><span class="sd">        Default SSO url is computed from the `url` if no `sso_url` is provided.</span>
</span><span id="Connection-296"><a href="#Connection-296"><span class="linenos"> 296</span></a>
</span><span id="Connection-297"><a href="#Connection-297"><span class="linenos"> 297</span></a><span class="sd">        `sso_revoke_url` \n</span>
</span><span id="Connection-298"><a href="#Connection-298"><span class="linenos"> 298</span></a><span class="sd">        A string containing the base URL of the SSO</span>
</span><span id="Connection-299"><a href="#Connection-299"><span class="linenos"> 299</span></a><span class="sd">        revoke service. This needs to be specified only when using</span>
</span><span id="Connection-300"><a href="#Connection-300"><span class="linenos"> 300</span></a><span class="sd">        an external authentication service. By default this URL</span>
</span><span id="Connection-301"><a href="#Connection-301"><span class="linenos"> 301</span></a><span class="sd">        is automatically calculated from the value of the `url` parameter,</span>
</span><span id="Connection-302"><a href="#Connection-302"><span class="linenos"> 302</span></a><span class="sd">        so that SSO token revoke will be performed using the SSO service</span>
</span><span id="Connection-303"><a href="#Connection-303"><span class="linenos"> 303</span></a><span class="sd">        that is part of the engine.</span>
</span><span id="Connection-304"><a href="#Connection-304"><span class="linenos"> 304</span></a>
</span><span id="Connection-305"><a href="#Connection-305"><span class="linenos"> 305</span></a><span class="sd">        `sso_token_name` \n</span>
</span><span id="Connection-306"><a href="#Connection-306"><span class="linenos"> 306</span></a><span class="sd">        The token name in the JSON SSO response returned</span>
</span><span id="Connection-307"><a href="#Connection-307"><span class="linenos"> 307</span></a><span class="sd">        from the SSO server. Default value is `access_token`.</span>
</span><span id="Connection-308"><a href="#Connection-308"><span class="linenos"> 308</span></a>
</span><span id="Connection-309"><a href="#Connection-309"><span class="linenos"> 309</span></a><span class="sd">        `headers` \n</span>
</span><span id="Connection-310"><a href="#Connection-310"><span class="linenos"> 310</span></a><span class="sd">        A dictionary with headers which should be send with every</span>
</span><span id="Connection-311"><a href="#Connection-311"><span class="linenos"> 311</span></a><span class="sd">        request.</span>
</span><span id="Connection-312"><a href="#Connection-312"><span class="linenos"> 312</span></a>
</span><span id="Connection-313"><a href="#Connection-313"><span class="linenos"> 313</span></a><span class="sd">        `connections` \n</span>
</span><span id="Connection-314"><a href="#Connection-314"><span class="linenos"> 314</span></a><span class="sd">        The maximum number of connections to open to the host.</span>
</span><span id="Connection-315"><a href="#Connection-315"><span class="linenos"> 315</span></a><span class="sd">        If the value is `0` (the default) then the number of connections will</span>
</span><span id="Connection-316"><a href="#Connection-316"><span class="linenos"> 316</span></a><span class="sd">        be unlimited.</span>
</span><span id="Connection-317"><a href="#Connection-317"><span class="linenos"> 317</span></a>
</span><span id="Connection-318"><a href="#Connection-318"><span class="linenos"> 318</span></a><span class="sd">        `pipeline` \n</span>
</span><span id="Connection-319"><a href="#Connection-319"><span class="linenos"> 319</span></a><span class="sd">        The maximum number of request to put in an HTTP pipeline</span>
</span><span id="Connection-320"><a href="#Connection-320"><span class="linenos"> 320</span></a><span class="sd">        without waiting for the response. If the value is `0` (the default)</span>
</span><span id="Connection-321"><a href="#Connection-321"><span class="linenos"> 321</span></a><span class="sd">        then pipelining is disabled.</span>
</span><span id="Connection-322"><a href="#Connection-322"><span class="linenos"> 322</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Connection-323"><a href="#Connection-323"><span class="linenos"> 323</span></a>
</span><span id="Connection-324"><a href="#Connection-324"><span class="linenos"> 324</span></a>        <span class="c1"># Check mandatory parameters:</span>
</span><span id="Connection-325"><a href="#Connection-325"><span class="linenos"> 325</span></a>        <span class="k">if</span> <span class="n">url</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Connection-326"><a href="#Connection-326"><span class="linenos"> 326</span></a>            <span class="k">raise</span> <span class="n">Error</span><span class="p">(</span><span class="s1">&#39;The </span><span class="se">\&#39;</span><span class="s1">url</span><span class="se">\&#39;</span><span class="s1"> parameter is mandatory&#39;</span><span class="p">)</span>
</span><span id="Connection-327"><a href="#Connection-327"><span class="linenos"> 327</span></a>
</span><span id="Connection-328"><a href="#Connection-328"><span class="linenos"> 328</span></a>        <span class="c1"># Check that the CA file exists if insecure is not set:</span>
</span><span id="Connection-329"><a href="#Connection-329"><span class="linenos"> 329</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">insecure</span><span class="p">:</span>
</span><span id="Connection-330"><a href="#Connection-330"><span class="linenos"> 330</span></a>            <span class="k">if</span> <span class="n">ca_file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">ca_file</span><span class="p">):</span>
</span><span id="Connection-331"><a href="#Connection-331"><span class="linenos"> 331</span></a>                <span class="k">raise</span> <span class="n">Error</span><span class="p">(</span><span class="s1">&#39;The CA file </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1"> doesn</span><span class="se">\&#39;</span><span class="s1">t exist&#39;</span> <span class="o">%</span> <span class="n">ca_file</span><span class="p">)</span>
</span><span id="Connection-332"><a href="#Connection-332"><span class="linenos"> 332</span></a>
</span><span id="Connection-333"><a href="#Connection-333"><span class="linenos"> 333</span></a>        <span class="c1"># Save the URL:</span>
</span><span id="Connection-334"><a href="#Connection-334"><span class="linenos"> 334</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_url</span> <span class="o">=</span> <span class="n">url</span>
</span><span id="Connection-335"><a href="#Connection-335"><span class="linenos"> 335</span></a>
</span><span id="Connection-336"><a href="#Connection-336"><span class="linenos"> 336</span></a>        <span class="c1"># Save the logger:</span>
</span><span id="Connection-337"><a href="#Connection-337"><span class="linenos"> 337</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span> <span class="o">=</span> <span class="n">log</span>
</span><span id="Connection-338"><a href="#Connection-338"><span class="linenos"> 338</span></a>
</span><span id="Connection-339"><a href="#Connection-339"><span class="linenos"> 339</span></a>        <span class="c1"># Save the credentials:</span>
</span><span id="Connection-340"><a href="#Connection-340"><span class="linenos"> 340</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_username</span> <span class="o">=</span> <span class="n">username</span>
</span><span id="Connection-341"><a href="#Connection-341"><span class="linenos"> 341</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_password</span> <span class="o">=</span> <span class="n">password</span>
</span><span id="Connection-342"><a href="#Connection-342"><span class="linenos"> 342</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sso_token</span> <span class="o">=</span> <span class="n">token</span>
</span><span id="Connection-343"><a href="#Connection-343"><span class="linenos"> 343</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_kerberos</span> <span class="o">=</span> <span class="n">kerberos</span>
</span><span id="Connection-344"><a href="#Connection-344"><span class="linenos"> 344</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_ca_file</span> <span class="o">=</span> <span class="n">ca_file</span>
</span><span id="Connection-345"><a href="#Connection-345"><span class="linenos"> 345</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_insecure</span> <span class="o">=</span> <span class="n">insecure</span>
</span><span id="Connection-346"><a href="#Connection-346"><span class="linenos"> 346</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_timeout</span> <span class="o">=</span> <span class="n">timeout</span>
</span><span id="Connection-347"><a href="#Connection-347"><span class="linenos"> 347</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_debug</span> <span class="o">=</span> <span class="n">debug</span>
</span><span id="Connection-348"><a href="#Connection-348"><span class="linenos"> 348</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_compress</span> <span class="o">=</span> <span class="n">compress</span>
</span><span id="Connection-349"><a href="#Connection-349"><span class="linenos"> 349</span></a>
</span><span id="Connection-350"><a href="#Connection-350"><span class="linenos"> 350</span></a>        <span class="c1"># The curl object can be used by several threads, but not</span>
</span><span id="Connection-351"><a href="#Connection-351"><span class="linenos"> 351</span></a>        <span class="c1"># simultaneously, so we need a lock to prevent that:</span>
</span><span id="Connection-352"><a href="#Connection-352"><span class="linenos"> 352</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_curl_lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
</span><span id="Connection-353"><a href="#Connection-353"><span class="linenos"> 353</span></a>
</span><span id="Connection-354"><a href="#Connection-354"><span class="linenos"> 354</span></a>        <span class="c1"># Set SSO attributes:</span>
</span><span id="Connection-355"><a href="#Connection-355"><span class="linenos"> 355</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sso_url</span> <span class="o">=</span> <span class="n">sso_url</span>
</span><span id="Connection-356"><a href="#Connection-356"><span class="linenos"> 356</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sso_revoke_url</span> <span class="o">=</span> <span class="n">sso_revoke_url</span>
</span><span id="Connection-357"><a href="#Connection-357"><span class="linenos"> 357</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sso_token_name</span> <span class="o">=</span> <span class="n">sso_token_name</span>
</span><span id="Connection-358"><a href="#Connection-358"><span class="linenos"> 358</span></a>
</span><span id="Connection-359"><a href="#Connection-359"><span class="linenos"> 359</span></a>        <span class="c1"># Headers:</span>
</span><span id="Connection-360"><a href="#Connection-360"><span class="linenos"> 360</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_headers</span> <span class="o">=</span> <span class="n">headers</span> <span class="ow">or</span> <span class="p">{}</span>
</span><span id="Connection-361"><a href="#Connection-361"><span class="linenos"> 361</span></a>
</span><span id="Connection-362"><a href="#Connection-362"><span class="linenos"> 362</span></a>        <span class="c1"># Create the curl handle that manages the pool of connections:</span>
</span><span id="Connection-363"><a href="#Connection-363"><span class="linenos"> 363</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_multi</span> <span class="o">=</span> <span class="n">pycurl</span><span class="o">.</span><span class="n">CurlMulti</span><span class="p">()</span>
</span><span id="Connection-364"><a href="#Connection-364"><span class="linenos"> 364</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_multi</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">M_PIPELINING</span><span class="p">,</span> <span class="nb">bool</span><span class="p">(</span><span class="n">pipeline</span><span class="p">))</span>
</span><span id="Connection-365"><a href="#Connection-365"><span class="linenos"> 365</span></a>        <span class="c1"># Since libcurl 7.30.0:</span>
</span><span id="Connection-366"><a href="#Connection-366"><span class="linenos"> 366</span></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">pycurl</span><span class="p">,</span> <span class="s1">&#39;M_MAX_PIPELINE_LENGTH&#39;</span><span class="p">):</span>
</span><span id="Connection-367"><a href="#Connection-367"><span class="linenos"> 367</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_multi</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">M_MAX_PIPELINE_LENGTH</span><span class="p">,</span> <span class="n">pipeline</span><span class="p">)</span>
</span><span id="Connection-368"><a href="#Connection-368"><span class="linenos"> 368</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_multi</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">M_MAX_HOST_CONNECTIONS</span><span class="p">,</span> <span class="n">connections</span><span class="p">)</span>
</span><span id="Connection-369"><a href="#Connection-369"><span class="linenos"> 369</span></a>
</span><span id="Connection-370"><a href="#Connection-370"><span class="linenos"> 370</span></a>        <span class="c1"># Connections:</span>
</span><span id="Connection-371"><a href="#Connection-371"><span class="linenos"> 371</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_curls</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="Connection-372"><a href="#Connection-372"><span class="linenos"> 372</span></a>
</span><span id="Connection-373"><a href="#Connection-373"><span class="linenos"> 373</span></a>        <span class="c1"># Initialize the reference to the system service:</span>
</span><span id="Connection-374"><a href="#Connection-374"><span class="linenos"> 374</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__system_service</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Connection-375"><a href="#Connection-375"><span class="linenos"> 375</span></a>
</span><span id="Connection-376"><a href="#Connection-376"><span class="linenos"> 376</span></a>    <span class="k">def</span> <span class="nf">send</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
</span><span id="Connection-377"><a href="#Connection-377"><span class="linenos"> 377</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Connection-378"><a href="#Connection-378"><span class="linenos"> 378</span></a><span class="sd">        Sends an HTTP request and waits for the response.</span>
</span><span id="Connection-379"><a href="#Connection-379"><span class="linenos"> 379</span></a>
</span><span id="Connection-380"><a href="#Connection-380"><span class="linenos"> 380</span></a><span class="sd">        This method is intended for internal use by other components of the</span>
</span><span id="Connection-381"><a href="#Connection-381"><span class="linenos"> 381</span></a><span class="sd">        SDK. Refrain from using it directly, as backwards compatibility isn&#39;t</span>
</span><span id="Connection-382"><a href="#Connection-382"><span class="linenos"> 382</span></a><span class="sd">        guaranteed.</span>
</span><span id="Connection-383"><a href="#Connection-383"><span class="linenos"> 383</span></a>
</span><span id="Connection-384"><a href="#Connection-384"><span class="linenos"> 384</span></a><span class="sd">        This method supports the following parameters.</span>
</span><span id="Connection-385"><a href="#Connection-385"><span class="linenos"> 385</span></a>
</span><span id="Connection-386"><a href="#Connection-386"><span class="linenos"> 386</span></a><span class="sd">        `request` \n</span>
</span><span id="Connection-387"><a href="#Connection-387"><span class="linenos"> 387</span></a><span class="sd">        The Request object containing the details of the HTTP</span>
</span><span id="Connection-388"><a href="#Connection-388"><span class="linenos"> 388</span></a><span class="sd">        request to send.</span>
</span><span id="Connection-389"><a href="#Connection-389"><span class="linenos"> 389</span></a>
</span><span id="Connection-390"><a href="#Connection-390"><span class="linenos"> 390</span></a><span class="sd">        The returned value is a Request object containing the details of the</span>
</span><span id="Connection-391"><a href="#Connection-391"><span class="linenos"> 391</span></a><span class="sd">        HTTP response received.</span>
</span><span id="Connection-392"><a href="#Connection-392"><span class="linenos"> 392</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Connection-393"><a href="#Connection-393"><span class="linenos"> 393</span></a>
</span><span id="Connection-394"><a href="#Connection-394"><span class="linenos"> 394</span></a>        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_curl_lock</span><span class="p">:</span>
</span><span id="Connection-395"><a href="#Connection-395"><span class="linenos"> 395</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__send</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
</span><span id="Connection-396"><a href="#Connection-396"><span class="linenos"> 396</span></a>
</span><span id="Connection-397"><a href="#Connection-397"><span class="linenos"> 397</span></a>    <span class="k">def</span> <span class="nf">authenticate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Connection-398"><a href="#Connection-398"><span class="linenos"> 398</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Connection-399"><a href="#Connection-399"><span class="linenos"> 399</span></a><span class="sd">        Return token which can be used for authentication instead of credentials.</span>
</span><span id="Connection-400"><a href="#Connection-400"><span class="linenos"> 400</span></a><span class="sd">        It will be created, if it not exists, yet. By default the token will be</span>
</span><span id="Connection-401"><a href="#Connection-401"><span class="linenos"> 401</span></a><span class="sd">        revoked when the connection is closed, unless the `logout` parameter of</span>
</span><span id="Connection-402"><a href="#Connection-402"><span class="linenos"> 402</span></a><span class="sd">        the `close` method is `False`.</span>
</span><span id="Connection-403"><a href="#Connection-403"><span class="linenos"> 403</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Connection-404"><a href="#Connection-404"><span class="linenos"> 404</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Connection-405"><a href="#Connection-405"><span class="linenos"> 405</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sso_token</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Connection-406"><a href="#Connection-406"><span class="linenos"> 406</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_sso_token</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_access_token</span><span class="p">()</span>
</span><span id="Connection-407"><a href="#Connection-407"><span class="linenos"> 407</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sso_token</span>
</span><span id="Connection-408"><a href="#Connection-408"><span class="linenos"> 408</span></a>        <span class="k">except</span> <span class="n">pycurl</span><span class="o">.</span><span class="n">error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="Connection-409"><a href="#Connection-409"><span class="linenos"> 409</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__parse_error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span id="Connection-410"><a href="#Connection-410"><span class="linenos"> 410</span></a>
</span><span id="Connection-411"><a href="#Connection-411"><span class="linenos"> 411</span></a>    <span class="k">def</span> <span class="nf">__send</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
</span><span id="Connection-412"><a href="#Connection-412"><span class="linenos"> 412</span></a>        <span class="c1"># Create SSO token if needed:</span>
</span><span id="Connection-413"><a href="#Connection-413"><span class="linenos"> 413</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">authenticate</span><span class="p">()</span>
</span><span id="Connection-414"><a href="#Connection-414"><span class="linenos"> 414</span></a>
</span><span id="Connection-415"><a href="#Connection-415"><span class="linenos"> 415</span></a>        <span class="c1"># Init curl easy:</span>
</span><span id="Connection-416"><a href="#Connection-416"><span class="linenos"> 416</span></a>        <span class="n">curl</span> <span class="o">=</span> <span class="n">pycurl</span><span class="o">.</span><span class="n">Curl</span><span class="p">()</span>
</span><span id="Connection-417"><a href="#Connection-417"><span class="linenos"> 417</span></a>        <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">COOKIEFILE</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="Connection-418"><a href="#Connection-418"><span class="linenos"> 418</span></a>
</span><span id="Connection-419"><a href="#Connection-419"><span class="linenos"> 419</span></a>        <span class="c1"># Configure TLS parameters:</span>
</span><span id="Connection-420"><a href="#Connection-420"><span class="linenos"> 420</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_url</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;https&#39;</span><span class="p">):</span>
</span><span id="Connection-421"><a href="#Connection-421"><span class="linenos"> 421</span></a>            <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">SSL_VERIFYPEER</span><span class="p">,</span> <span class="mi">0</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_insecure</span> <span class="k">else</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Connection-422"><a href="#Connection-422"><span class="linenos"> 422</span></a>            <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">SSL_VERIFYHOST</span><span class="p">,</span> <span class="mi">0</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_insecure</span> <span class="k">else</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="Connection-423"><a href="#Connection-423"><span class="linenos"> 423</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ca_file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Connection-424"><a href="#Connection-424"><span class="linenos"> 424</span></a>                <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">CAINFO</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ca_file</span><span class="p">)</span>
</span><span id="Connection-425"><a href="#Connection-425"><span class="linenos"> 425</span></a>
</span><span id="Connection-426"><a href="#Connection-426"><span class="linenos"> 426</span></a>        <span class="c1"># Configure timeouts:</span>
</span><span id="Connection-427"><a href="#Connection-427"><span class="linenos"> 427</span></a>        <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">TIMEOUT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_timeout</span><span class="p">)</span>
</span><span id="Connection-428"><a href="#Connection-428"><span class="linenos"> 428</span></a>
</span><span id="Connection-429"><a href="#Connection-429"><span class="linenos"> 429</span></a>        <span class="c1"># Configure compression of responses (setting the value to a zero</span>
</span><span id="Connection-430"><a href="#Connection-430"><span class="linenos"> 430</span></a>        <span class="c1"># length string means accepting all the compression types that</span>
</span><span id="Connection-431"><a href="#Connection-431"><span class="linenos"> 431</span></a>        <span class="c1"># libcurl supports):</span>
</span><span id="Connection-432"><a href="#Connection-432"><span class="linenos"> 432</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compress</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_debug</span><span class="p">:</span>
</span><span id="Connection-433"><a href="#Connection-433"><span class="linenos"> 433</span></a>            <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">ENCODING</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="Connection-434"><a href="#Connection-434"><span class="linenos"> 434</span></a>
</span><span id="Connection-435"><a href="#Connection-435"><span class="linenos"> 435</span></a>        <span class="c1"># Configure debug mode:</span>
</span><span id="Connection-436"><a href="#Connection-436"><span class="linenos"> 436</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_debug</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_log</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Connection-437"><a href="#Connection-437"><span class="linenos"> 437</span></a>            <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">VERBOSE</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Connection-438"><a href="#Connection-438"><span class="linenos"> 438</span></a>            <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">DEBUGFUNCTION</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_curl_debug</span><span class="p">)</span>
</span><span id="Connection-439"><a href="#Connection-439"><span class="linenos"> 439</span></a>
</span><span id="Connection-440"><a href="#Connection-440"><span class="linenos"> 440</span></a>        <span class="c1"># Set the method:</span>
</span><span id="Connection-441"><a href="#Connection-441"><span class="linenos"> 441</span></a>        <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">CUSTOMREQUEST</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="p">)</span>
</span><span id="Connection-442"><a href="#Connection-442"><span class="linenos"> 442</span></a>
</span><span id="Connection-443"><a href="#Connection-443"><span class="linenos"> 443</span></a>        <span class="c1"># Build the URL:</span>
</span><span id="Connection-444"><a href="#Connection-444"><span class="linenos"> 444</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_url</span><span class="p">(</span>
</span><span id="Connection-445"><a href="#Connection-445"><span class="linenos"> 445</span></a>            <span class="n">path</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">path</span><span class="p">,</span>
</span><span id="Connection-446"><a href="#Connection-446"><span class="linenos"> 446</span></a>            <span class="n">query</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">query</span><span class="p">,</span>
</span><span id="Connection-447"><a href="#Connection-447"><span class="linenos"> 447</span></a>        <span class="p">)</span>
</span><span id="Connection-448"><a href="#Connection-448"><span class="linenos"> 448</span></a>        <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">URL</span><span class="p">,</span> <span class="n">url</span><span class="p">)</span>
</span><span id="Connection-449"><a href="#Connection-449"><span class="linenos"> 449</span></a>
</span><span id="Connection-450"><a href="#Connection-450"><span class="linenos"> 450</span></a>        <span class="c1"># Older versions of the engine (before 4.1) required the</span>
</span><span id="Connection-451"><a href="#Connection-451"><span class="linenos"> 451</span></a>        <span class="c1"># &#39;all_content&#39; parameter as an HTTP header instead of a query</span>
</span><span id="Connection-452"><a href="#Connection-452"><span class="linenos"> 452</span></a>        <span class="c1"># parameter. In order to better support these older versions of</span>
</span><span id="Connection-453"><a href="#Connection-453"><span class="linenos"> 453</span></a>        <span class="c1"># the engine we need to check if this parameter is included in</span>
</span><span id="Connection-454"><a href="#Connection-454"><span class="linenos"> 454</span></a>        <span class="c1"># the request, and add the corresponding header.</span>
</span><span id="Connection-455"><a href="#Connection-455"><span class="linenos"> 455</span></a>        <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">query</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Connection-456"><a href="#Connection-456"><span class="linenos"> 456</span></a>            <span class="n">all_content</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;all_content&#39;</span><span class="p">)</span>
</span><span id="Connection-457"><a href="#Connection-457"><span class="linenos"> 457</span></a>            <span class="k">if</span> <span class="n">all_content</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Connection-458"><a href="#Connection-458"><span class="linenos"> 458</span></a>                <span class="n">request</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;All-Content&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_content</span>
</span><span id="Connection-459"><a href="#Connection-459"><span class="linenos"> 459</span></a>
</span><span id="Connection-460"><a href="#Connection-460"><span class="linenos"> 460</span></a>        <span class="c1"># Add global headers:</span>
</span><span id="Connection-461"><a href="#Connection-461"><span class="linenos"> 461</span></a>        <span class="n">headers_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_headers</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Connection-462"><a href="#Connection-462"><span class="linenos"> 462</span></a>
</span><span id="Connection-463"><a href="#Connection-463"><span class="linenos"> 463</span></a>        <span class="c1"># Add headers, avoiding those that have no value:</span>
</span><span id="Connection-464"><a href="#Connection-464"><span class="linenos"> 464</span></a>        <span class="n">header_lines</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Connection-465"><a href="#Connection-465"><span class="linenos"> 465</span></a>        <span class="k">for</span> <span class="n">header_name</span><span class="p">,</span> <span class="n">header_value</span> <span class="ow">in</span> <span class="n">request</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Connection-466"><a href="#Connection-466"><span class="linenos"> 466</span></a>            <span class="k">if</span> <span class="n">header_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Connection-467"><a href="#Connection-467"><span class="linenos"> 467</span></a>                <span class="n">headers_dict</span><span class="p">[</span><span class="n">header_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">header_value</span>
</span><span id="Connection-468"><a href="#Connection-468"><span class="linenos"> 468</span></a>
</span><span id="Connection-469"><a href="#Connection-469"><span class="linenos"> 469</span></a>        <span class="k">for</span> <span class="n">header_name</span><span class="p">,</span> <span class="n">header_value</span> <span class="ow">in</span> <span class="n">headers_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Connection-470"><a href="#Connection-470"><span class="linenos"> 470</span></a>            <span class="n">header_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">header_name</span><span class="p">,</span> <span class="n">header_value</span><span class="p">))</span>
</span><span id="Connection-471"><a href="#Connection-471"><span class="linenos"> 471</span></a>
</span><span id="Connection-472"><a href="#Connection-472"><span class="linenos"> 472</span></a>        <span class="n">header_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;User-Agent: PythonSDK/</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">get_version</span><span class="p">())</span>
</span><span id="Connection-473"><a href="#Connection-473"><span class="linenos"> 473</span></a>        <span class="n">header_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Version: 4&#39;</span><span class="p">)</span>
</span><span id="Connection-474"><a href="#Connection-474"><span class="linenos"> 474</span></a>        <span class="n">header_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Content-Type: application/xml&#39;</span><span class="p">)</span>
</span><span id="Connection-475"><a href="#Connection-475"><span class="linenos"> 475</span></a>        <span class="n">header_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Accept: application/xml&#39;</span><span class="p">)</span>
</span><span id="Connection-476"><a href="#Connection-476"><span class="linenos"> 476</span></a>        <span class="n">header_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Authorization: Bearer </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sso_token</span><span class="p">)</span>
</span><span id="Connection-477"><a href="#Connection-477"><span class="linenos"> 477</span></a>
</span><span id="Connection-478"><a href="#Connection-478"><span class="linenos"> 478</span></a>        <span class="c1"># Make sure headers values are strings, because</span>
</span><span id="Connection-479"><a href="#Connection-479"><span class="linenos"> 479</span></a>        <span class="c1"># pycurl version 7.19.0 supports only string in headers</span>
</span><span id="Connection-480"><a href="#Connection-480"><span class="linenos"> 480</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">header</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">header_lines</span><span class="p">):</span>
</span><span id="Connection-481"><a href="#Connection-481"><span class="linenos"> 481</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="Connection-482"><a href="#Connection-482"><span class="linenos"> 482</span></a>                <span class="n">header_lines</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">header</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">)</span>
</span><span id="Connection-483"><a href="#Connection-483"><span class="linenos"> 483</span></a>            <span class="k">except</span> <span class="p">(</span><span class="ne">UnicodeEncodeError</span><span class="p">,</span> <span class="ne">UnicodeDecodeError</span><span class="p">):</span>
</span><span id="Connection-484"><a href="#Connection-484"><span class="linenos"> 484</span></a>                <span class="n">header_name</span><span class="p">,</span> <span class="n">header_value</span> <span class="o">=</span> <span class="n">header</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
</span><span id="Connection-485"><a href="#Connection-485"><span class="linenos"> 485</span></a>                <span class="k">raise</span> <span class="n">Error</span><span class="p">(</span>
</span><span id="Connection-486"><a href="#Connection-486"><span class="linenos"> 486</span></a>                    <span class="s2">&quot;The value &#39;</span><span class="si">{header_value}</span><span class="s2">&#39; of header &#39;</span><span class="si">{header_name}</span><span class="s2">&#39; &quot;</span>
</span><span id="Connection-487"><a href="#Connection-487"><span class="linenos"> 487</span></a>                    <span class="s2">&quot;contains characters that can&#39;t be encoded using ASCII, &quot;</span>
</span><span id="Connection-488"><a href="#Connection-488"><span class="linenos"> 488</span></a>                    <span class="s2">&quot;as required by the HTTP protocol.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="Connection-489"><a href="#Connection-489"><span class="linenos"> 489</span></a>                        <span class="n">header_value</span><span class="o">=</span><span class="n">header_value</span><span class="p">,</span>
</span><span id="Connection-490"><a href="#Connection-490"><span class="linenos"> 490</span></a>                        <span class="n">header_name</span><span class="o">=</span><span class="n">header_name</span><span class="p">,</span>
</span><span id="Connection-491"><a href="#Connection-491"><span class="linenos"> 491</span></a>                    <span class="p">)</span>
</span><span id="Connection-492"><a href="#Connection-492"><span class="linenos"> 492</span></a>                <span class="p">)</span>
</span><span id="Connection-493"><a href="#Connection-493"><span class="linenos"> 493</span></a>
</span><span id="Connection-494"><a href="#Connection-494"><span class="linenos"> 494</span></a>        <span class="c1"># Copy headers and the request body to the curl object:</span>
</span><span id="Connection-495"><a href="#Connection-495"><span class="linenos"> 495</span></a>        <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">HTTPHEADER</span><span class="p">,</span> <span class="n">header_lines</span><span class="p">)</span>
</span><span id="Connection-496"><a href="#Connection-496"><span class="linenos"> 496</span></a>        <span class="n">body</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">body</span>
</span><span id="Connection-497"><a href="#Connection-497"><span class="linenos"> 497</span></a>        <span class="k">if</span> <span class="n">body</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Connection-498"><a href="#Connection-498"><span class="linenos"> 498</span></a>            <span class="n">body</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="Connection-499"><a href="#Connection-499"><span class="linenos"> 499</span></a>
</span><span id="Connection-500"><a href="#Connection-500"><span class="linenos"> 500</span></a>        <span class="c1"># HTTP pipelining is valid only for idempotent operations,</span>
</span><span id="Connection-501"><a href="#Connection-501"><span class="linenos"> 501</span></a>        <span class="c1"># pycurl automatically disables pipelining if COPYPOSTFIELDS</span>
</span><span id="Connection-502"><a href="#Connection-502"><span class="linenos"> 502</span></a>        <span class="c1"># is set, even if pipelining is explicitly set.</span>
</span><span id="Connection-503"><a href="#Connection-503"><span class="linenos"> 503</span></a>        <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;POST&#39;</span><span class="p">,</span> <span class="s1">&#39;PUT&#39;</span><span class="p">]:</span>
</span><span id="Connection-504"><a href="#Connection-504"><span class="linenos"> 504</span></a>            <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">COPYPOSTFIELDS</span><span class="p">,</span> <span class="n">body</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>
</span><span id="Connection-505"><a href="#Connection-505"><span class="linenos"> 505</span></a>
</span><span id="Connection-506"><a href="#Connection-506"><span class="linenos"> 506</span></a>        <span class="c1"># Prepare the buffers to receive the response:</span>
</span><span id="Connection-507"><a href="#Connection-507"><span class="linenos"> 507</span></a>        <span class="n">body_buf</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">()</span>
</span><span id="Connection-508"><a href="#Connection-508"><span class="linenos"> 508</span></a>        <span class="n">headers_buf</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">()</span>
</span><span id="Connection-509"><a href="#Connection-509"><span class="linenos"> 509</span></a>        <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">WRITEFUNCTION</span><span class="p">,</span> <span class="n">body_buf</span><span class="o">.</span><span class="n">write</span><span class="p">)</span>
</span><span id="Connection-510"><a href="#Connection-510"><span class="linenos"> 510</span></a>        <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">HEADERFUNCTION</span><span class="p">,</span> <span class="n">headers_buf</span><span class="o">.</span><span class="n">write</span><span class="p">)</span>
</span><span id="Connection-511"><a href="#Connection-511"><span class="linenos"> 511</span></a>
</span><span id="Connection-512"><a href="#Connection-512"><span class="linenos"> 512</span></a>        <span class="c1"># Add the curl easy to the multi handle:</span>
</span><span id="Connection-513"><a href="#Connection-513"><span class="linenos"> 513</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_multi</span><span class="o">.</span><span class="n">add_handle</span><span class="p">(</span><span class="n">curl</span><span class="p">)</span>
</span><span id="Connection-514"><a href="#Connection-514"><span class="linenos"> 514</span></a>
</span><span id="Connection-515"><a href="#Connection-515"><span class="linenos"> 515</span></a>        <span class="k">return</span> <span class="n">curl</span><span class="p">,</span> <span class="n">body_buf</span><span class="p">,</span> <span class="n">headers_buf</span><span class="p">,</span> <span class="n">request</span>
</span><span id="Connection-516"><a href="#Connection-516"><span class="linenos"> 516</span></a>
</span><span id="Connection-517"><a href="#Connection-517"><span class="linenos"> 517</span></a>    <span class="k">def</span> <span class="nf">wait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">failed_auth</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="Connection-518"><a href="#Connection-518"><span class="linenos"> 518</span></a>        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_curl_lock</span><span class="p">:</span>
</span><span id="Connection-519"><a href="#Connection-519"><span class="linenos"> 519</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="Connection-520"><a href="#Connection-520"><span class="linenos"> 520</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__wait</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">failed_auth</span><span class="p">)</span>
</span><span id="Connection-521"><a href="#Connection-521"><span class="linenos"> 521</span></a>            <span class="k">except</span> <span class="n">pycurl</span><span class="o">.</span><span class="n">error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="Connection-522"><a href="#Connection-522"><span class="linenos"> 522</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">__parse_error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span id="Connection-523"><a href="#Connection-523"><span class="linenos"> 523</span></a>
</span><span id="Connection-524"><a href="#Connection-524"><span class="linenos"> 524</span></a>    <span class="k">def</span> <span class="nf">__wait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">failed_auth</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="Connection-525"><a href="#Connection-525"><span class="linenos"> 525</span></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Connection-526"><a href="#Connection-526"><span class="linenos"> 526</span></a>            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Connection-527"><a href="#Connection-527"><span class="linenos"> 527</span></a>                <span class="n">ret</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_multi</span><span class="o">.</span><span class="n">perform</span><span class="p">()</span>
</span><span id="Connection-528"><a href="#Connection-528"><span class="linenos"> 528</span></a>                <span class="k">if</span> <span class="n">ret</span> <span class="o">!=</span> <span class="n">pycurl</span><span class="o">.</span><span class="n">E_CALL_MULTI_PERFORM</span><span class="p">:</span>
</span><span id="Connection-529"><a href="#Connection-529"><span class="linenos"> 529</span></a>                    <span class="k">break</span>
</span><span id="Connection-530"><a href="#Connection-530"><span class="linenos"> 530</span></a>            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Connection-531"><a href="#Connection-531"><span class="linenos"> 531</span></a>                <span class="n">num_q</span><span class="p">,</span> <span class="n">ok_list</span><span class="p">,</span> <span class="n">err_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_multi</span><span class="o">.</span><span class="n">info_read</span><span class="p">()</span>
</span><span id="Connection-532"><a href="#Connection-532"><span class="linenos"> 532</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_curls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_curls</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">ok_list</span><span class="p">))</span>
</span><span id="Connection-533"><a href="#Connection-533"><span class="linenos"> 533</span></a>                <span class="k">if</span> <span class="n">err_list</span><span class="p">:</span>
</span><span id="Connection-534"><a href="#Connection-534"><span class="linenos"> 534</span></a>                    <span class="k">raise</span> <span class="n">Error</span><span class="p">(</span><span class="s2">&quot;Failed to read response: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">err_list</span><span class="p">))</span>
</span><span id="Connection-535"><a href="#Connection-535"><span class="linenos"> 535</span></a>                <span class="k">elif</span> <span class="n">context</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_curls</span><span class="p">:</span>
</span><span id="Connection-536"><a href="#Connection-536"><span class="linenos"> 536</span></a>                    <span class="c1"># Remove the curl:</span>
</span><span id="Connection-537"><a href="#Connection-537"><span class="linenos"> 537</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_curls</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">context</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Connection-538"><a href="#Connection-538"><span class="linenos"> 538</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_multi</span><span class="o">.</span><span class="n">remove_handle</span><span class="p">(</span><span class="n">context</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Connection-539"><a href="#Connection-539"><span class="linenos"> 539</span></a>
</span><span id="Connection-540"><a href="#Connection-540"><span class="linenos"> 540</span></a>                    <span class="c1"># Read the response:</span>
</span><span id="Connection-541"><a href="#Connection-541"><span class="linenos"> 541</span></a>                    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_reponse</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
</span><span id="Connection-542"><a href="#Connection-542"><span class="linenos"> 542</span></a>
</span><span id="Connection-543"><a href="#Connection-543"><span class="linenos"> 543</span></a>                    <span class="c1"># If the request failed because of authentication, and it</span>
</span><span id="Connection-544"><a href="#Connection-544"><span class="linenos"> 544</span></a>                    <span class="c1"># wasn&#39;t a request to the SSO service, then the most likely</span>
</span><span id="Connection-545"><a href="#Connection-545"><span class="linenos"> 545</span></a>                    <span class="c1"># cause is an expired SSO token. In this case we need to</span>
</span><span id="Connection-546"><a href="#Connection-546"><span class="linenos"> 546</span></a>                    <span class="c1"># request a new token, and try the original request again, but</span>
</span><span id="Connection-547"><a href="#Connection-547"><span class="linenos"> 547</span></a>                    <span class="c1"># only once. It if fails again, we just return the failed</span>
</span><span id="Connection-548"><a href="#Connection-548"><span class="linenos"> 548</span></a>                    <span class="c1"># response.</span>
</span><span id="Connection-549"><a href="#Connection-549"><span class="linenos"> 549</span></a>                    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">code</span> <span class="o">==</span> <span class="mi">401</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">failed_auth</span><span class="p">:</span>
</span><span id="Connection-550"><a href="#Connection-550"><span class="linenos"> 550</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">_sso_token</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_access_token</span><span class="p">()</span>
</span><span id="Connection-551"><a href="#Connection-551"><span class="linenos"> 551</span></a>                        <span class="n">context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__send</span><span class="p">(</span><span class="n">context</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
</span><span id="Connection-552"><a href="#Connection-552"><span class="linenos"> 552</span></a>                        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__wait</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="Connection-553"><a href="#Connection-553"><span class="linenos"> 553</span></a>                    <span class="k">return</span> <span class="n">response</span>
</span><span id="Connection-554"><a href="#Connection-554"><span class="linenos"> 554</span></a>                <span class="k">elif</span> <span class="n">num_q</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Connection-555"><a href="#Connection-555"><span class="linenos"> 555</span></a>                    <span class="k">break</span>
</span><span id="Connection-556"><a href="#Connection-556"><span class="linenos"> 556</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_multi</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
</span><span id="Connection-557"><a href="#Connection-557"><span class="linenos"> 557</span></a>
</span><span id="Connection-558"><a href="#Connection-558"><span class="linenos"> 558</span></a>    <span class="nd">@property</span>
</span><span id="Connection-559"><a href="#Connection-559"><span class="linenos"> 559</span></a>    <span class="k">def</span> <span class="nf">url</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Connection-560"><a href="#Connection-560"><span class="linenos"> 560</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Connection-561"><a href="#Connection-561"><span class="linenos"> 561</span></a><span class="sd">        Returns a string containing the base URL used by this connection.</span>
</span><span id="Connection-562"><a href="#Connection-562"><span class="linenos"> 562</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Connection-563"><a href="#Connection-563"><span class="linenos"> 563</span></a>
</span><span id="Connection-564"><a href="#Connection-564"><span class="linenos"> 564</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_url</span>
</span><span id="Connection-565"><a href="#Connection-565"><span class="linenos"> 565</span></a>
</span><span id="Connection-566"><a href="#Connection-566"><span class="linenos"> 566</span></a>    <span class="k">def</span> <span class="nf">_revoke_access_token</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Connection-567"><a href="#Connection-567"><span class="linenos"> 567</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Connection-568"><a href="#Connection-568"><span class="linenos"> 568</span></a><span class="sd">        Revokes access token</span>
</span><span id="Connection-569"><a href="#Connection-569"><span class="linenos"> 569</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Connection-570"><a href="#Connection-570"><span class="linenos"> 570</span></a>
</span><span id="Connection-571"><a href="#Connection-571"><span class="linenos"> 571</span></a>        <span class="c1"># Build the SSO revoke URL:</span>
</span><span id="Connection-572"><a href="#Connection-572"><span class="linenos"> 572</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sso_revoke_url</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Connection-573"><a href="#Connection-573"><span class="linenos"> 573</span></a>            <span class="n">url</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_url</span><span class="p">)</span>
</span><span id="Connection-574"><a href="#Connection-574"><span class="linenos"> 574</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_sso_revoke_url</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="Connection-575"><a href="#Connection-575"><span class="linenos"> 575</span></a>                <span class="s1">&#39;</span><span class="si">{url}</span><span class="s1">/ovirt-engine/services/sso-logout&#39;</span>
</span><span id="Connection-576"><a href="#Connection-576"><span class="linenos"> 576</span></a>            <span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="Connection-577"><a href="#Connection-577"><span class="linenos"> 577</span></a>                <span class="n">url</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{scheme}</span><span class="s1">://</span><span class="si">{netloc}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="Connection-578"><a href="#Connection-578"><span class="linenos"> 578</span></a>                    <span class="n">scheme</span><span class="o">=</span><span class="n">url</span><span class="o">.</span><span class="n">scheme</span><span class="p">,</span>
</span><span id="Connection-579"><a href="#Connection-579"><span class="linenos"> 579</span></a>                    <span class="n">netloc</span><span class="o">=</span><span class="n">url</span><span class="o">.</span><span class="n">netloc</span>
</span><span id="Connection-580"><a href="#Connection-580"><span class="linenos"> 580</span></a>                <span class="p">)</span>
</span><span id="Connection-581"><a href="#Connection-581"><span class="linenos"> 581</span></a>            <span class="p">)</span>
</span><span id="Connection-582"><a href="#Connection-582"><span class="linenos"> 582</span></a>
</span><span id="Connection-583"><a href="#Connection-583"><span class="linenos"> 583</span></a>        <span class="c1"># Construct POST data:</span>
</span><span id="Connection-584"><a href="#Connection-584"><span class="linenos"> 584</span></a>        <span class="n">post_data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="Connection-585"><a href="#Connection-585"><span class="linenos"> 585</span></a>            <span class="s1">&#39;scope&#39;</span><span class="p">:</span> <span class="s1">&#39;ovirt-app-api&#39;</span><span class="p">,</span>
</span><span id="Connection-586"><a href="#Connection-586"><span class="linenos"> 586</span></a>            <span class="s1">&#39;token&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sso_token</span><span class="p">,</span>
</span><span id="Connection-587"><a href="#Connection-587"><span class="linenos"> 587</span></a>        <span class="p">}</span>
</span><span id="Connection-588"><a href="#Connection-588"><span class="linenos"> 588</span></a>
</span><span id="Connection-589"><a href="#Connection-589"><span class="linenos"> 589</span></a>        <span class="c1"># Send SSO request:</span>
</span><span id="Connection-590"><a href="#Connection-590"><span class="linenos"> 590</span></a>        <span class="n">sso_response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_sso_response</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sso_revoke_url</span><span class="p">,</span> <span class="n">post_data</span><span class="p">)</span>
</span><span id="Connection-591"><a href="#Connection-591"><span class="linenos"> 591</span></a>
</span><span id="Connection-592"><a href="#Connection-592"><span class="linenos"> 592</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sso_response</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="Connection-593"><a href="#Connection-593"><span class="linenos"> 593</span></a>            <span class="n">sso_response</span> <span class="o">=</span> <span class="n">sso_response</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Connection-594"><a href="#Connection-594"><span class="linenos"> 594</span></a>
</span><span id="Connection-595"><a href="#Connection-595"><span class="linenos"> 595</span></a>        <span class="k">if</span> <span class="s1">&#39;error&#39;</span> <span class="ow">in</span> <span class="n">sso_response</span><span class="p">:</span>
</span><span id="Connection-596"><a href="#Connection-596"><span class="linenos"> 596</span></a>            <span class="n">sso_error</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_sso_error</span><span class="p">(</span><span class="n">sso_response</span><span class="p">)</span>
</span><span id="Connection-597"><a href="#Connection-597"><span class="linenos"> 597</span></a>            <span class="k">raise</span> <span class="n">AuthError</span><span class="p">(</span>
</span><span id="Connection-598"><a href="#Connection-598"><span class="linenos"> 598</span></a>                <span class="s1">&#39;Error during SSO revoke </span><span class="si">%s</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
</span><span id="Connection-599"><a href="#Connection-599"><span class="linenos"> 599</span></a>                    <span class="n">sso_error</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="Connection-600"><a href="#Connection-600"><span class="linenos"> 600</span></a>                    <span class="n">sso_error</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Connection-601"><a href="#Connection-601"><span class="linenos"> 601</span></a>                <span class="p">)</span>
</span><span id="Connection-602"><a href="#Connection-602"><span class="linenos"> 602</span></a>            <span class="p">)</span>
</span><span id="Connection-603"><a href="#Connection-603"><span class="linenos"> 603</span></a>
</span><span id="Connection-604"><a href="#Connection-604"><span class="linenos"> 604</span></a>    <span class="k">def</span> <span class="nf">_get_access_token</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Connection-605"><a href="#Connection-605"><span class="linenos"> 605</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Connection-606"><a href="#Connection-606"><span class="linenos"> 606</span></a><span class="sd">        Creates access token which reflect authentication method.</span>
</span><span id="Connection-607"><a href="#Connection-607"><span class="linenos"> 607</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Connection-608"><a href="#Connection-608"><span class="linenos"> 608</span></a>
</span><span id="Connection-609"><a href="#Connection-609"><span class="linenos"> 609</span></a>        <span class="c1"># Build SSO URL:</span>
</span><span id="Connection-610"><a href="#Connection-610"><span class="linenos"> 610</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_kerberos</span><span class="p">:</span>
</span><span id="Connection-611"><a href="#Connection-611"><span class="linenos"> 611</span></a>            <span class="n">entry_point</span> <span class="o">=</span> <span class="s1">&#39;token-http-auth&#39;</span>
</span><span id="Connection-612"><a href="#Connection-612"><span class="linenos"> 612</span></a>            <span class="n">grant_type</span> <span class="o">=</span> <span class="s1">&#39;urn:ovirt:params:oauth:grant-type:http&#39;</span>
</span><span id="Connection-613"><a href="#Connection-613"><span class="linenos"> 613</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Connection-614"><a href="#Connection-614"><span class="linenos"> 614</span></a>            <span class="n">entry_point</span> <span class="o">=</span> <span class="s1">&#39;token&#39;</span>
</span><span id="Connection-615"><a href="#Connection-615"><span class="linenos"> 615</span></a>            <span class="n">grant_type</span> <span class="o">=</span> <span class="s1">&#39;password&#39;</span>
</span><span id="Connection-616"><a href="#Connection-616"><span class="linenos"> 616</span></a>
</span><span id="Connection-617"><a href="#Connection-617"><span class="linenos"> 617</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sso_url</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Connection-618"><a href="#Connection-618"><span class="linenos"> 618</span></a>            <span class="n">url</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_url</span><span class="p">)</span>
</span><span id="Connection-619"><a href="#Connection-619"><span class="linenos"> 619</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_sso_url</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="Connection-620"><a href="#Connection-620"><span class="linenos"> 620</span></a>                <span class="s1">&#39;</span><span class="si">{url}</span><span class="s1">/ovirt-engine/sso/oauth/</span><span class="si">{entry_point}</span><span class="s1">&#39;</span>
</span><span id="Connection-621"><a href="#Connection-621"><span class="linenos"> 621</span></a>            <span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="Connection-622"><a href="#Connection-622"><span class="linenos"> 622</span></a>                <span class="n">url</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{scheme}</span><span class="s1">://</span><span class="si">{netloc}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="Connection-623"><a href="#Connection-623"><span class="linenos"> 623</span></a>                    <span class="n">scheme</span><span class="o">=</span><span class="n">url</span><span class="o">.</span><span class="n">scheme</span><span class="p">,</span>
</span><span id="Connection-624"><a href="#Connection-624"><span class="linenos"> 624</span></a>                    <span class="n">netloc</span><span class="o">=</span><span class="n">url</span><span class="o">.</span><span class="n">netloc</span>
</span><span id="Connection-625"><a href="#Connection-625"><span class="linenos"> 625</span></a>                <span class="p">),</span>
</span><span id="Connection-626"><a href="#Connection-626"><span class="linenos"> 626</span></a>                <span class="n">entry_point</span><span class="o">=</span><span class="n">entry_point</span><span class="p">,</span>
</span><span id="Connection-627"><a href="#Connection-627"><span class="linenos"> 627</span></a>            <span class="p">)</span>
</span><span id="Connection-628"><a href="#Connection-628"><span class="linenos"> 628</span></a>
</span><span id="Connection-629"><a href="#Connection-629"><span class="linenos"> 629</span></a>        <span class="c1"># Construct POST data:</span>
</span><span id="Connection-630"><a href="#Connection-630"><span class="linenos"> 630</span></a>        <span class="n">post_data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="Connection-631"><a href="#Connection-631"><span class="linenos"> 631</span></a>            <span class="s1">&#39;grant_type&#39;</span><span class="p">:</span> <span class="n">grant_type</span><span class="p">,</span>
</span><span id="Connection-632"><a href="#Connection-632"><span class="linenos"> 632</span></a>            <span class="s1">&#39;scope&#39;</span><span class="p">:</span> <span class="s1">&#39;ovirt-app-api&#39;</span><span class="p">,</span>
</span><span id="Connection-633"><a href="#Connection-633"><span class="linenos"> 633</span></a>        <span class="p">}</span>
</span><span id="Connection-634"><a href="#Connection-634"><span class="linenos"> 634</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_kerberos</span><span class="p">:</span>
</span><span id="Connection-635"><a href="#Connection-635"><span class="linenos"> 635</span></a>            <span class="n">post_data</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
</span><span id="Connection-636"><a href="#Connection-636"><span class="linenos"> 636</span></a>                <span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_username</span><span class="p">,</span>
</span><span id="Connection-637"><a href="#Connection-637"><span class="linenos"> 637</span></a>                <span class="s1">&#39;password&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_password</span><span class="p">,</span>
</span><span id="Connection-638"><a href="#Connection-638"><span class="linenos"> 638</span></a>            <span class="p">})</span>
</span><span id="Connection-639"><a href="#Connection-639"><span class="linenos"> 639</span></a>
</span><span id="Connection-640"><a href="#Connection-640"><span class="linenos"> 640</span></a>        <span class="c1"># Send SSO request:</span>
</span><span id="Connection-641"><a href="#Connection-641"><span class="linenos"> 641</span></a>        <span class="n">sso_response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_sso_response</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sso_url</span><span class="p">,</span> <span class="n">post_data</span><span class="p">)</span>
</span><span id="Connection-642"><a href="#Connection-642"><span class="linenos"> 642</span></a>
</span><span id="Connection-643"><a href="#Connection-643"><span class="linenos"> 643</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sso_response</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="Connection-644"><a href="#Connection-644"><span class="linenos"> 644</span></a>            <span class="n">sso_response</span> <span class="o">=</span> <span class="n">sso_response</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Connection-645"><a href="#Connection-645"><span class="linenos"> 645</span></a>
</span><span id="Connection-646"><a href="#Connection-646"><span class="linenos"> 646</span></a>        <span class="k">if</span> <span class="s1">&#39;error&#39;</span> <span class="ow">in</span> <span class="n">sso_response</span><span class="p">:</span>
</span><span id="Connection-647"><a href="#Connection-647"><span class="linenos"> 647</span></a>            <span class="n">sso_error</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_sso_error</span><span class="p">(</span><span class="n">sso_response</span><span class="p">)</span>
</span><span id="Connection-648"><a href="#Connection-648"><span class="linenos"> 648</span></a>            <span class="k">raise</span> <span class="n">AuthError</span><span class="p">(</span>
</span><span id="Connection-649"><a href="#Connection-649"><span class="linenos"> 649</span></a>                <span class="s1">&#39;Error during SSO authentication </span><span class="si">%s</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
</span><span id="Connection-650"><a href="#Connection-650"><span class="linenos"> 650</span></a>                    <span class="n">sso_error</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="Connection-651"><a href="#Connection-651"><span class="linenos"> 651</span></a>                    <span class="n">sso_error</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Connection-652"><a href="#Connection-652"><span class="linenos"> 652</span></a>                <span class="p">)</span>
</span><span id="Connection-653"><a href="#Connection-653"><span class="linenos"> 653</span></a>            <span class="p">)</span>
</span><span id="Connection-654"><a href="#Connection-654"><span class="linenos"> 654</span></a>
</span><span id="Connection-655"><a href="#Connection-655"><span class="linenos"> 655</span></a>        <span class="k">return</span> <span class="n">sso_response</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_sso_token_name</span><span class="p">]</span>
</span><span id="Connection-656"><a href="#Connection-656"><span class="linenos"> 656</span></a>
</span><span id="Connection-657"><a href="#Connection-657"><span class="linenos"> 657</span></a>    <span class="k">def</span> <span class="nf">_get_sso_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sso_response</span><span class="p">):</span>
</span><span id="Connection-658"><a href="#Connection-658"><span class="linenos"> 658</span></a>        <span class="c1"># OpenId define `error_description` field, OAuth doesn&#39;t:</span>
</span><span id="Connection-659"><a href="#Connection-659"><span class="linenos"> 659</span></a>        <span class="k">if</span> <span class="s1">&#39;error_description&#39;</span> <span class="ow">in</span> <span class="n">sso_response</span><span class="p">:</span>
</span><span id="Connection-660"><a href="#Connection-660"><span class="linenos"> 660</span></a>            <span class="n">sso_error</span> <span class="o">=</span> <span class="p">(</span><span class="n">sso_response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;error&#39;</span><span class="p">),</span> <span class="n">sso_response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;error_description&#39;</span><span class="p">))</span>
</span><span id="Connection-661"><a href="#Connection-661"><span class="linenos"> 661</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Connection-662"><a href="#Connection-662"><span class="linenos"> 662</span></a>            <span class="n">sso_error</span> <span class="o">=</span> <span class="p">(</span><span class="n">sso_response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;error_code&#39;</span><span class="p">),</span> <span class="n">sso_response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;error&#39;</span><span class="p">))</span>
</span><span id="Connection-663"><a href="#Connection-663"><span class="linenos"> 663</span></a>
</span><span id="Connection-664"><a href="#Connection-664"><span class="linenos"> 664</span></a>        <span class="k">return</span> <span class="n">sso_error</span>
</span><span id="Connection-665"><a href="#Connection-665"><span class="linenos"> 665</span></a>
</span><span id="Connection-666"><a href="#Connection-666"><span class="linenos"> 666</span></a>    <span class="k">def</span> <span class="nf">_get_sso_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
</span><span id="Connection-667"><a href="#Connection-667"><span class="linenos"> 667</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Connection-668"><a href="#Connection-668"><span class="linenos"> 668</span></a><span class="sd">        Perform SSO request and return response body data.</span>
</span><span id="Connection-669"><a href="#Connection-669"><span class="linenos"> 669</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Connection-670"><a href="#Connection-670"><span class="linenos"> 670</span></a>
</span><span id="Connection-671"><a href="#Connection-671"><span class="linenos"> 671</span></a>        <span class="c1"># Set HTTP method and URL:</span>
</span><span id="Connection-672"><a href="#Connection-672"><span class="linenos"> 672</span></a>        <span class="n">curl</span> <span class="o">=</span> <span class="n">pycurl</span><span class="o">.</span><span class="n">Curl</span><span class="p">()</span>
</span><span id="Connection-673"><a href="#Connection-673"><span class="linenos"> 673</span></a>        <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">CUSTOMREQUEST</span><span class="p">,</span> <span class="s1">&#39;POST&#39;</span><span class="p">)</span>
</span><span id="Connection-674"><a href="#Connection-674"><span class="linenos"> 674</span></a>        <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">URL</span><span class="p">,</span> <span class="n">url</span><span class="p">)</span>
</span><span id="Connection-675"><a href="#Connection-675"><span class="linenos"> 675</span></a>
</span><span id="Connection-676"><a href="#Connection-676"><span class="linenos"> 676</span></a>        <span class="c1"># Set proper Authorization header if using kerberos:</span>
</span><span id="Connection-677"><a href="#Connection-677"><span class="linenos"> 677</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_kerberos</span><span class="p">:</span>
</span><span id="Connection-678"><a href="#Connection-678"><span class="linenos"> 678</span></a>            <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">HTTPAUTH</span><span class="p">,</span> <span class="n">pycurl</span><span class="o">.</span><span class="n">HTTPAUTH_GSSNEGOTIATE</span><span class="p">)</span>
</span><span id="Connection-679"><a href="#Connection-679"><span class="linenos"> 679</span></a>            <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">USERPWD</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">)</span>
</span><span id="Connection-680"><a href="#Connection-680"><span class="linenos"> 680</span></a>
</span><span id="Connection-681"><a href="#Connection-681"><span class="linenos"> 681</span></a>        <span class="c1"># Configure debug mode:</span>
</span><span id="Connection-682"><a href="#Connection-682"><span class="linenos"> 682</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_debug</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_log</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Connection-683"><a href="#Connection-683"><span class="linenos"> 683</span></a>            <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">VERBOSE</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Connection-684"><a href="#Connection-684"><span class="linenos"> 684</span></a>            <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">DEBUGFUNCTION</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_curl_debug</span><span class="p">)</span>
</span><span id="Connection-685"><a href="#Connection-685"><span class="linenos"> 685</span></a>
</span><span id="Connection-686"><a href="#Connection-686"><span class="linenos"> 686</span></a>        <span class="c1"># Configure TLS parameters:</span>
</span><span id="Connection-687"><a href="#Connection-687"><span class="linenos"> 687</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_url</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;https&#39;</span><span class="p">):</span>
</span><span id="Connection-688"><a href="#Connection-688"><span class="linenos"> 688</span></a>            <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">SSL_VERIFYPEER</span><span class="p">,</span> <span class="mi">0</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_insecure</span> <span class="k">else</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Connection-689"><a href="#Connection-689"><span class="linenos"> 689</span></a>            <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">SSL_VERIFYHOST</span><span class="p">,</span> <span class="mi">0</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_insecure</span> <span class="k">else</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="Connection-690"><a href="#Connection-690"><span class="linenos"> 690</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ca_file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Connection-691"><a href="#Connection-691"><span class="linenos"> 691</span></a>                <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">CAINFO</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ca_file</span><span class="p">)</span>
</span><span id="Connection-692"><a href="#Connection-692"><span class="linenos"> 692</span></a>
</span><span id="Connection-693"><a href="#Connection-693"><span class="linenos"> 693</span></a>        <span class="c1"># Prepare headers:</span>
</span><span id="Connection-694"><a href="#Connection-694"><span class="linenos"> 694</span></a>        <span class="n">header_lines</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="Connection-695"><a href="#Connection-695"><span class="linenos"> 695</span></a>            <span class="s1">&#39;User-Agent: PythonSDK/</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">get_version</span><span class="p">(),</span>
</span><span id="Connection-696"><a href="#Connection-696"><span class="linenos"> 696</span></a>            <span class="s1">&#39;Accept: application/json&#39;</span>
</span><span id="Connection-697"><a href="#Connection-697"><span class="linenos"> 697</span></a>        <span class="p">]</span>
</span><span id="Connection-698"><a href="#Connection-698"><span class="linenos"> 698</span></a>        <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">HTTPHEADER</span><span class="p">,</span> <span class="n">header_lines</span><span class="p">)</span>
</span><span id="Connection-699"><a href="#Connection-699"><span class="linenos"> 699</span></a>        <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">COPYPOSTFIELDS</span><span class="p">,</span> <span class="n">urlencode</span><span class="p">(</span><span class="n">params</span><span class="p">))</span>
</span><span id="Connection-700"><a href="#Connection-700"><span class="linenos"> 700</span></a>
</span><span id="Connection-701"><a href="#Connection-701"><span class="linenos"> 701</span></a>        <span class="c1"># Prepare the buffer to receive the response:</span>
</span><span id="Connection-702"><a href="#Connection-702"><span class="linenos"> 702</span></a>        <span class="n">body_buf</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">()</span>
</span><span id="Connection-703"><a href="#Connection-703"><span class="linenos"> 703</span></a>        <span class="n">headers_buf</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">()</span>
</span><span id="Connection-704"><a href="#Connection-704"><span class="linenos"> 704</span></a>
</span><span id="Connection-705"><a href="#Connection-705"><span class="linenos"> 705</span></a>        <span class="c1"># We ignore all headers which are received before the last response</span>
</span><span id="Connection-706"><a href="#Connection-706"><span class="linenos"> 706</span></a>        <span class="c1"># from the server, because we can be forwarded by apache, and we</span>
</span><span id="Connection-707"><a href="#Connection-707"><span class="linenos"> 707</span></a>        <span class="c1"># are interested only in last response:</span>
</span><span id="Connection-708"><a href="#Connection-708"><span class="linenos"> 708</span></a>        <span class="k">def</span> <span class="nf">write_header</span><span class="p">(</span><span class="n">buf</span><span class="p">):</span>
</span><span id="Connection-709"><a href="#Connection-709"><span class="linenos"> 709</span></a>            <span class="k">if</span> <span class="n">buf</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;HTTP/&#39;</span><span class="p">):</span>
</span><span id="Connection-710"><a href="#Connection-710"><span class="linenos"> 710</span></a>                <span class="n">headers_buf</span><span class="o">.</span><span class="n">truncate</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Connection-711"><a href="#Connection-711"><span class="linenos"> 711</span></a>                <span class="n">headers_buf</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Connection-712"><a href="#Connection-712"><span class="linenos"> 712</span></a>            <span class="n">headers_buf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span>
</span><span id="Connection-713"><a href="#Connection-713"><span class="linenos"> 713</span></a>
</span><span id="Connection-714"><a href="#Connection-714"><span class="linenos"> 714</span></a>        <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">WRITEFUNCTION</span><span class="p">,</span> <span class="n">body_buf</span><span class="o">.</span><span class="n">write</span><span class="p">)</span>
</span><span id="Connection-715"><a href="#Connection-715"><span class="linenos"> 715</span></a>        <span class="n">curl</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">HEADERFUNCTION</span><span class="p">,</span> <span class="n">write_header</span><span class="p">)</span>
</span><span id="Connection-716"><a href="#Connection-716"><span class="linenos"> 716</span></a>
</span><span id="Connection-717"><a href="#Connection-717"><span class="linenos"> 717</span></a>        <span class="c1"># Send the request and wait for the response:</span>
</span><span id="Connection-718"><a href="#Connection-718"><span class="linenos"> 718</span></a>        <span class="n">curl</span><span class="o">.</span><span class="n">perform</span><span class="p">()</span>
</span><span id="Connection-719"><a href="#Connection-719"><span class="linenos"> 719</span></a>        <span class="n">curl</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="Connection-720"><a href="#Connection-720"><span class="linenos"> 720</span></a>
</span><span id="Connection-721"><a href="#Connection-721"><span class="linenos"> 721</span></a>        <span class="c1"># Get headers:</span>
</span><span id="Connection-722"><a href="#Connection-722"><span class="linenos"> 722</span></a>        <span class="n">headers_text</span> <span class="o">=</span> <span class="n">headers_buf</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">)</span>
</span><span id="Connection-723"><a href="#Connection-723"><span class="linenos"> 723</span></a>        <span class="n">header_lines</span> <span class="o">=</span> <span class="n">headers_text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Connection-724"><a href="#Connection-724"><span class="linenos"> 724</span></a>
</span><span id="Connection-725"><a href="#Connection-725"><span class="linenos"> 725</span></a>        <span class="c1"># Check the returned content type:</span>
</span><span id="Connection-726"><a href="#Connection-726"><span class="linenos"> 726</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_check_content_type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__JSON_CONTENT_TYPE_RE</span><span class="p">,</span> <span class="s1">&#39;JSON&#39;</span><span class="p">,</span> <span class="n">header_lines</span><span class="p">)</span>
</span><span id="Connection-727"><a href="#Connection-727"><span class="linenos"> 727</span></a>
</span><span id="Connection-728"><a href="#Connection-728"><span class="linenos"> 728</span></a>        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">body_buf</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>
</span><span id="Connection-729"><a href="#Connection-729"><span class="linenos"> 729</span></a>
</span><span id="Connection-730"><a href="#Connection-730"><span class="linenos"> 730</span></a>    <span class="k">def</span> <span class="nf">system_service</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Connection-731"><a href="#Connection-731"><span class="linenos"> 731</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Connection-732"><a href="#Connection-732"><span class="linenos"> 732</span></a><span class="sd">        Returns the reference to the root of the services tree.</span>
</span><span id="Connection-733"><a href="#Connection-733"><span class="linenos"> 733</span></a>
</span><span id="Connection-734"><a href="#Connection-734"><span class="linenos"> 734</span></a><span class="sd">        The returned value is an instance of the `SystemService` class.</span>
</span><span id="Connection-735"><a href="#Connection-735"><span class="linenos"> 735</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Connection-736"><a href="#Connection-736"><span class="linenos"> 736</span></a>
</span><span id="Connection-737"><a href="#Connection-737"><span class="linenos"> 737</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__system_service</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Connection-738"><a href="#Connection-738"><span class="linenos"> 738</span></a>            <span class="kn">from</span> <span class="nn">ovirtsdk4.services</span> <span class="kn">import</span> <span class="n">SystemService</span>
</span><span id="Connection-739"><a href="#Connection-739"><span class="linenos"> 739</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__system_service</span> <span class="o">=</span> <span class="n">SystemService</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="Connection-740"><a href="#Connection-740"><span class="linenos"> 740</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__system_service</span>
</span><span id="Connection-741"><a href="#Connection-741"><span class="linenos"> 741</span></a>
</span><span id="Connection-742"><a href="#Connection-742"><span class="linenos"> 742</span></a>    <span class="k">def</span> <span class="nf">service</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
</span><span id="Connection-743"><a href="#Connection-743"><span class="linenos"> 743</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Connection-744"><a href="#Connection-744"><span class="linenos"> 744</span></a><span class="sd">        Returns a reference to the service corresponding to the given</span>
</span><span id="Connection-745"><a href="#Connection-745"><span class="linenos"> 745</span></a><span class="sd">        path. For example, if the `path` parameter is</span>
</span><span id="Connection-746"><a href="#Connection-746"><span class="linenos"> 746</span></a><span class="sd">        `vms/123/diskattachments` then it will return a reference to</span>
</span><span id="Connection-747"><a href="#Connection-747"><span class="linenos"> 747</span></a><span class="sd">        the service that manages the disk attachments for the virtual</span>
</span><span id="Connection-748"><a href="#Connection-748"><span class="linenos"> 748</span></a><span class="sd">        machine with identifier `123`.</span>
</span><span id="Connection-749"><a href="#Connection-749"><span class="linenos"> 749</span></a>
</span><span id="Connection-750"><a href="#Connection-750"><span class="linenos"> 750</span></a><span class="sd">        If there is no service corresponding to the given path an exception</span>
</span><span id="Connection-751"><a href="#Connection-751"><span class="linenos"> 751</span></a><span class="sd">        will be raised.</span>
</span><span id="Connection-752"><a href="#Connection-752"><span class="linenos"> 752</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Connection-753"><a href="#Connection-753"><span class="linenos"> 753</span></a>
</span><span id="Connection-754"><a href="#Connection-754"><span class="linenos"> 754</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">system_service</span><span class="p">()</span><span class="o">.</span><span class="n">service</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</span><span id="Connection-755"><a href="#Connection-755"><span class="linenos"> 755</span></a>
</span><span id="Connection-756"><a href="#Connection-756"><span class="linenos"> 756</span></a>    <span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raise_exception</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="Connection-757"><a href="#Connection-757"><span class="linenos"> 757</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Connection-758"><a href="#Connection-758"><span class="linenos"> 758</span></a><span class="sd">        Tests the connectivity with the server. If connectivity works</span>
</span><span id="Connection-759"><a href="#Connection-759"><span class="linenos"> 759</span></a><span class="sd">        correctly it returns `True`. If there is any connectivy problem</span>
</span><span id="Connection-760"><a href="#Connection-760"><span class="linenos"> 760</span></a><span class="sd">        it will either return `False` or raise an exception if the</span>
</span><span id="Connection-761"><a href="#Connection-761"><span class="linenos"> 761</span></a><span class="sd">        `raise_exception` parameter is `True`.</span>
</span><span id="Connection-762"><a href="#Connection-762"><span class="linenos"> 762</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Connection-763"><a href="#Connection-763"><span class="linenos"> 763</span></a>
</span><span id="Connection-764"><a href="#Connection-764"><span class="linenos"> 764</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Connection-765"><a href="#Connection-765"><span class="linenos"> 765</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">system_service</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</span><span id="Connection-766"><a href="#Connection-766"><span class="linenos"> 766</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="Connection-767"><a href="#Connection-767"><span class="linenos"> 767</span></a>        <span class="k">except</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="Connection-768"><a href="#Connection-768"><span class="linenos"> 768</span></a>            <span class="k">if</span> <span class="n">raise_exception</span><span class="p">:</span>
</span><span id="Connection-769"><a href="#Connection-769"><span class="linenos"> 769</span></a>                <span class="k">raise</span>
</span><span id="Connection-770"><a href="#Connection-770"><span class="linenos"> 770</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Connection-771"><a href="#Connection-771"><span class="linenos"> 771</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="Connection-772"><a href="#Connection-772"><span class="linenos"> 772</span></a>            <span class="k">if</span> <span class="n">raise_exception</span><span class="p">:</span>
</span><span id="Connection-773"><a href="#Connection-773"><span class="linenos"> 773</span></a>                <span class="k">raise</span> <span class="n">Error</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="Connection-774"><a href="#Connection-774"><span class="linenos"> 774</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Connection-775"><a href="#Connection-775"><span class="linenos"> 775</span></a>
</span><span id="Connection-776"><a href="#Connection-776"><span class="linenos"> 776</span></a>    <span class="k">def</span> <span class="nf">is_link</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
</span><span id="Connection-777"><a href="#Connection-777"><span class="linenos"> 777</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Connection-778"><a href="#Connection-778"><span class="linenos"> 778</span></a><span class="sd">        Indicates if the given object is a link. An object is a link if</span>
</span><span id="Connection-779"><a href="#Connection-779"><span class="linenos"> 779</span></a><span class="sd">        it has an `href` attribute.</span>
</span><span id="Connection-780"><a href="#Connection-780"><span class="linenos"> 780</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Connection-781"><a href="#Connection-781"><span class="linenos"> 781</span></a>
</span><span id="Connection-782"><a href="#Connection-782"><span class="linenos"> 782</span></a>        <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">href</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="Connection-783"><a href="#Connection-783"><span class="linenos"> 783</span></a>
</span><span id="Connection-784"><a href="#Connection-784"><span class="linenos"> 784</span></a>    <span class="k">def</span> <span class="nf">follow_link</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
</span><span id="Connection-785"><a href="#Connection-785"><span class="linenos"> 785</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Connection-786"><a href="#Connection-786"><span class="linenos"> 786</span></a><span class="sd">        Follows the `href` attribute of this object, retrieves the object</span>
</span><span id="Connection-787"><a href="#Connection-787"><span class="linenos"> 787</span></a><span class="sd">        and returns it.</span>
</span><span id="Connection-788"><a href="#Connection-788"><span class="linenos"> 788</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Connection-789"><a href="#Connection-789"><span class="linenos"> 789</span></a>
</span><span id="Connection-790"><a href="#Connection-790"><span class="linenos"> 790</span></a>        <span class="c1"># Check that the &quot;href&quot; attribute has a values, as it is needed</span>
</span><span id="Connection-791"><a href="#Connection-791"><span class="linenos"> 791</span></a>        <span class="c1"># in order to retrieve the representation of the object:</span>
</span><span id="Connection-792"><a href="#Connection-792"><span class="linenos"> 792</span></a>        <span class="n">href</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">href</span>
</span><span id="Connection-793"><a href="#Connection-793"><span class="linenos"> 793</span></a>        <span class="k">if</span> <span class="n">href</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Connection-794"><a href="#Connection-794"><span class="linenos"> 794</span></a>            <span class="k">raise</span> <span class="n">Error</span><span class="p">(</span>
</span><span id="Connection-795"><a href="#Connection-795"><span class="linenos"> 795</span></a>                <span class="s2">&quot;Can&#39;t follow link because the &#39;href&#39; attribute does&#39;t &quot;</span>
</span><span id="Connection-796"><a href="#Connection-796"><span class="linenos"> 796</span></a>                <span class="s2">&quot;have a value&quot;</span>
</span><span id="Connection-797"><a href="#Connection-797"><span class="linenos"> 797</span></a>            <span class="p">)</span>
</span><span id="Connection-798"><a href="#Connection-798"><span class="linenos"> 798</span></a>
</span><span id="Connection-799"><a href="#Connection-799"><span class="linenos"> 799</span></a>        <span class="c1"># Check that the value of the &quot;href&quot; attribute is compatible with the</span>
</span><span id="Connection-800"><a href="#Connection-800"><span class="linenos"> 800</span></a>        <span class="c1"># base URL of the connection:</span>
</span><span id="Connection-801"><a href="#Connection-801"><span class="linenos"> 801</span></a>        <span class="n">prefix</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_url</span><span class="p">)</span><span class="o">.</span><span class="n">path</span>
</span><span id="Connection-802"><a href="#Connection-802"><span class="linenos"> 802</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">prefix</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">):</span>
</span><span id="Connection-803"><a href="#Connection-803"><span class="linenos"> 803</span></a>            <span class="n">prefix</span> <span class="o">+=</span> <span class="s1">&#39;/&#39;</span>
</span><span id="Connection-804"><a href="#Connection-804"><span class="linenos"> 804</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">href</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">prefix</span><span class="p">):</span>
</span><span id="Connection-805"><a href="#Connection-805"><span class="linenos"> 805</span></a>            <span class="k">raise</span> <span class="n">Error</span><span class="p">(</span>
</span><span id="Connection-806"><a href="#Connection-806"><span class="linenos"> 806</span></a>                <span class="s2">&quot;The URL &#39;</span><span class="si">%s</span><span class="s2">&#39; isn&#39;t compatible with the base URL of the &quot;</span>
</span><span id="Connection-807"><a href="#Connection-807"><span class="linenos"> 807</span></a>                <span class="s2">&quot;connection&quot;</span> <span class="o">%</span> <span class="n">href</span>
</span><span id="Connection-808"><a href="#Connection-808"><span class="linenos"> 808</span></a>            <span class="p">)</span>
</span><span id="Connection-809"><a href="#Connection-809"><span class="linenos"> 809</span></a>
</span><span id="Connection-810"><a href="#Connection-810"><span class="linenos"> 810</span></a>        <span class="c1"># Remove the prefix from the URL, follow the path to the relevant</span>
</span><span id="Connection-811"><a href="#Connection-811"><span class="linenos"> 811</span></a>        <span class="c1"># service and invoke the &quot;get&quot;, or &quot;list method to retrieve its representation:</span>
</span><span id="Connection-812"><a href="#Connection-812"><span class="linenos"> 812</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="n">href</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">prefix</span><span class="p">):]</span>
</span><span id="Connection-813"><a href="#Connection-813"><span class="linenos"> 813</span></a>        <span class="n">service</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</span><span id="Connection-814"><a href="#Connection-814"><span class="linenos"> 814</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">List</span><span class="p">):</span>
</span><span id="Connection-815"><a href="#Connection-815"><span class="linenos"> 815</span></a>            <span class="k">return</span> <span class="n">service</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
</span><span id="Connection-816"><a href="#Connection-816"><span class="linenos"> 816</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Connection-817"><a href="#Connection-817"><span class="linenos"> 817</span></a>            <span class="k">return</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</span><span id="Connection-818"><a href="#Connection-818"><span class="linenos"> 818</span></a>
</span><span id="Connection-819"><a href="#Connection-819"><span class="linenos"> 819</span></a>    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">logout</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="Connection-820"><a href="#Connection-820"><span class="linenos"> 820</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Connection-821"><a href="#Connection-821"><span class="linenos"> 821</span></a><span class="sd">        Releases the resources used by this connection.</span>
</span><span id="Connection-822"><a href="#Connection-822"><span class="linenos"> 822</span></a>
</span><span id="Connection-823"><a href="#Connection-823"><span class="linenos"> 823</span></a><span class="sd">        `logout` A boolean, which specify if token should be revoked,</span>
</span><span id="Connection-824"><a href="#Connection-824"><span class="linenos"> 824</span></a><span class="sd">        and so user should be logged out.</span>
</span><span id="Connection-825"><a href="#Connection-825"><span class="linenos"> 825</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Connection-826"><a href="#Connection-826"><span class="linenos"> 826</span></a>
</span><span id="Connection-827"><a href="#Connection-827"><span class="linenos"> 827</span></a>        <span class="c1"># Revoke access token:</span>
</span><span id="Connection-828"><a href="#Connection-828"><span class="linenos"> 828</span></a>        <span class="k">if</span> <span class="n">logout</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sso_token</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Connection-829"><a href="#Connection-829"><span class="linenos"> 829</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_revoke_access_token</span><span class="p">()</span>
</span><span id="Connection-830"><a href="#Connection-830"><span class="linenos"> 830</span></a>
</span><span id="Connection-831"><a href="#Connection-831"><span class="linenos"> 831</span></a>        <span class="c1"># Release resources used by the cURL handle:</span>
</span><span id="Connection-832"><a href="#Connection-832"><span class="linenos"> 832</span></a>        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_curl_lock</span><span class="p">:</span>
</span><span id="Connection-833"><a href="#Connection-833"><span class="linenos"> 833</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_multi</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="Connection-834"><a href="#Connection-834"><span class="linenos"> 834</span></a>
</span><span id="Connection-835"><a href="#Connection-835"><span class="linenos"> 835</span></a>    <span class="k">def</span> <span class="nf">_build_url</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">query</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Connection-836"><a href="#Connection-836"><span class="linenos"> 836</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Connection-837"><a href="#Connection-837"><span class="linenos"> 837</span></a><span class="sd">        Builds a request URL from a path, and the set of query parameters.</span>
</span><span id="Connection-838"><a href="#Connection-838"><span class="linenos"> 838</span></a>
</span><span id="Connection-839"><a href="#Connection-839"><span class="linenos"> 839</span></a><span class="sd">        This method is intended for internal use by other components of the</span>
</span><span id="Connection-840"><a href="#Connection-840"><span class="linenos"> 840</span></a><span class="sd">        SDK. Refrain from using it directly, as backwards compatibility isn&#39;t</span>
</span><span id="Connection-841"><a href="#Connection-841"><span class="linenos"> 841</span></a><span class="sd">        guaranteed.</span>
</span><span id="Connection-842"><a href="#Connection-842"><span class="linenos"> 842</span></a>
</span><span id="Connection-843"><a href="#Connection-843"><span class="linenos"> 843</span></a><span class="sd">        This method supports the following parameters:</span>
</span><span id="Connection-844"><a href="#Connection-844"><span class="linenos"> 844</span></a>
</span><span id="Connection-845"><a href="#Connection-845"><span class="linenos"> 845</span></a><span class="sd">        `path` The path that will be added to the base URL. The default is an</span>
</span><span id="Connection-846"><a href="#Connection-846"><span class="linenos"> 846</span></a><span class="sd">        empty string.</span>
</span><span id="Connection-847"><a href="#Connection-847"><span class="linenos"> 847</span></a>
</span><span id="Connection-848"><a href="#Connection-848"><span class="linenos"> 848</span></a><span class="sd">        `query` A dictionary containing the query parameters to add to the</span>
</span><span id="Connection-849"><a href="#Connection-849"><span class="linenos"> 849</span></a><span class="sd">        URL. The keys of the dictionary should be strings containing the names</span>
</span><span id="Connection-850"><a href="#Connection-850"><span class="linenos"> 850</span></a><span class="sd">        of the parameters, and the values should be strings containing the</span>
</span><span id="Connection-851"><a href="#Connection-851"><span class="linenos"> 851</span></a><span class="sd">        values.</span>
</span><span id="Connection-852"><a href="#Connection-852"><span class="linenos"> 852</span></a>
</span><span id="Connection-853"><a href="#Connection-853"><span class="linenos"> 853</span></a><span class="sd">        The returned value is an string containing the URL.</span>
</span><span id="Connection-854"><a href="#Connection-854"><span class="linenos"> 854</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Connection-855"><a href="#Connection-855"><span class="linenos"> 855</span></a>
</span><span id="Connection-856"><a href="#Connection-856"><span class="linenos"> 856</span></a>        <span class="c1"># Add the path and the parameters:</span>
</span><span id="Connection-857"><a href="#Connection-857"><span class="linenos"> 857</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_url</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
</span><span id="Connection-858"><a href="#Connection-858"><span class="linenos"> 858</span></a>        <span class="k">if</span> <span class="n">query</span><span class="p">:</span>
</span><span id="Connection-859"><a href="#Connection-859"><span class="linenos"> 859</span></a>            <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">?</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">urlencode</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">items</span><span class="p">())))</span>
</span><span id="Connection-860"><a href="#Connection-860"><span class="linenos"> 860</span></a>        <span class="k">return</span> <span class="n">url</span>
</span><span id="Connection-861"><a href="#Connection-861"><span class="linenos"> 861</span></a>
</span><span id="Connection-862"><a href="#Connection-862"><span class="linenos"> 862</span></a>    <span class="k">def</span> <span class="nf">check_xml_content_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">response</span><span class="p">):</span>
</span><span id="Connection-863"><a href="#Connection-863"><span class="linenos"> 863</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Connection-864"><a href="#Connection-864"><span class="linenos"> 864</span></a><span class="sd">         Checks that the content type of the given response is XML. If it is</span>
</span><span id="Connection-865"><a href="#Connection-865"><span class="linenos"> 865</span></a><span class="sd">         XML then it does nothing. If it isn&#39;t XML then it raises an</span>
</span><span id="Connection-866"><a href="#Connection-866"><span class="linenos"> 866</span></a><span class="sd">         exception.</span>
</span><span id="Connection-867"><a href="#Connection-867"><span class="linenos"> 867</span></a>
</span><span id="Connection-868"><a href="#Connection-868"><span class="linenos"> 868</span></a><span class="sd">         `response` The HTTP response to check.</span>
</span><span id="Connection-869"><a href="#Connection-869"><span class="linenos"> 869</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Connection-870"><a href="#Connection-870"><span class="linenos"> 870</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_content_type</span><span class="p">(</span>
</span><span id="Connection-871"><a href="#Connection-871"><span class="linenos"> 871</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__XML_CONTENT_TYPE_RE</span><span class="p">,</span>
</span><span id="Connection-872"><a href="#Connection-872"><span class="linenos"> 872</span></a>            <span class="s1">&#39;XML&#39;</span><span class="p">,</span>
</span><span id="Connection-873"><a href="#Connection-873"><span class="linenos"> 873</span></a>            <span class="n">response</span><span class="o">.</span><span class="n">headers</span>
</span><span id="Connection-874"><a href="#Connection-874"><span class="linenos"> 874</span></a>        <span class="p">)</span>
</span><span id="Connection-875"><a href="#Connection-875"><span class="linenos"> 875</span></a>
</span><span id="Connection-876"><a href="#Connection-876"><span class="linenos"> 876</span></a>    <span class="k">def</span> <span class="nf">check_json_content_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">response</span><span class="p">):</span>
</span><span id="Connection-877"><a href="#Connection-877"><span class="linenos"> 877</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Connection-878"><a href="#Connection-878"><span class="linenos"> 878</span></a><span class="sd">         Checks that the content type of the given response is JSON. If it is</span>
</span><span id="Connection-879"><a href="#Connection-879"><span class="linenos"> 879</span></a><span class="sd">         JSON then it does nothing. If it isn&#39;t JSON then it raises an</span>
</span><span id="Connection-880"><a href="#Connection-880"><span class="linenos"> 880</span></a><span class="sd">         exception.</span>
</span><span id="Connection-881"><a href="#Connection-881"><span class="linenos"> 881</span></a>
</span><span id="Connection-882"><a href="#Connection-882"><span class="linenos"> 882</span></a><span class="sd">         `response` The HTTP response to check.</span>
</span><span id="Connection-883"><a href="#Connection-883"><span class="linenos"> 883</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Connection-884"><a href="#Connection-884"><span class="linenos"> 884</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_content_type</span><span class="p">(</span>
</span><span id="Connection-885"><a href="#Connection-885"><span class="linenos"> 885</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__JSON_CONTENT_TYPE_RE</span><span class="p">,</span>
</span><span id="Connection-886"><a href="#Connection-886"><span class="linenos"> 886</span></a>            <span class="s1">&#39;JSON&#39;</span><span class="p">,</span>
</span><span id="Connection-887"><a href="#Connection-887"><span class="linenos"> 887</span></a>            <span class="n">response</span><span class="o">.</span><span class="n">headers</span>
</span><span id="Connection-888"><a href="#Connection-888"><span class="linenos"> 888</span></a>        <span class="p">)</span>
</span><span id="Connection-889"><a href="#Connection-889"><span class="linenos"> 889</span></a>
</span><span id="Connection-890"><a href="#Connection-890"><span class="linenos"> 890</span></a>    <span class="k">def</span> <span class="nf">_check_content_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expected_re</span><span class="p">,</span> <span class="n">expected_name</span><span class="p">,</span> <span class="n">headers</span><span class="p">):</span>
</span><span id="Connection-891"><a href="#Connection-891"><span class="linenos"> 891</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Connection-892"><a href="#Connection-892"><span class="linenos"> 892</span></a><span class="sd">        Checks the given content type and raises an exception if it isn&#39;t the</span>
</span><span id="Connection-893"><a href="#Connection-893"><span class="linenos"> 893</span></a><span class="sd">        expected one.</span>
</span><span id="Connection-894"><a href="#Connection-894"><span class="linenos"> 894</span></a>
</span><span id="Connection-895"><a href="#Connection-895"><span class="linenos"> 895</span></a><span class="sd">        `expected_re` The regular expression used to check the expected</span>
</span><span id="Connection-896"><a href="#Connection-896"><span class="linenos"> 896</span></a><span class="sd">                        content type.</span>
</span><span id="Connection-897"><a href="#Connection-897"><span class="linenos"> 897</span></a><span class="sd">        `expected_name` The name of the expected content type.</span>
</span><span id="Connection-898"><a href="#Connection-898"><span class="linenos"> 898</span></a><span class="sd">        `headers` The HTTP headers to check.</span>
</span><span id="Connection-899"><a href="#Connection-899"><span class="linenos"> 899</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Connection-900"><a href="#Connection-900"><span class="linenos"> 900</span></a>        <span class="n">content_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_header_value</span><span class="p">(</span><span class="n">headers</span><span class="p">,</span> <span class="s1">&#39;content-type&#39;</span><span class="p">)</span>
</span><span id="Connection-901"><a href="#Connection-901"><span class="linenos"> 901</span></a>        <span class="k">if</span> <span class="n">expected_re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">content_type</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Connection-902"><a href="#Connection-902"><span class="linenos"> 902</span></a>            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;The response content type &#39;</span><span class="si">{}</span><span class="s2">&#39; isn&#39;t the expected </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="Connection-903"><a href="#Connection-903"><span class="linenos"> 903</span></a>                <span class="n">content_type</span><span class="p">,</span>
</span><span id="Connection-904"><a href="#Connection-904"><span class="linenos"> 904</span></a>                <span class="n">expected_name</span><span class="p">,</span>
</span><span id="Connection-905"><a href="#Connection-905"><span class="linenos"> 905</span></a>            <span class="p">)</span>
</span><span id="Connection-906"><a href="#Connection-906"><span class="linenos"> 906</span></a>            <span class="n">url</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_url</span><span class="p">)</span>
</span><span id="Connection-907"><a href="#Connection-907"><span class="linenos"> 907</span></a>            <span class="k">if</span> <span class="n">url</span><span class="o">.</span><span class="n">path</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__TYPICAL_PATH</span><span class="p">:</span>
</span><span id="Connection-908"><a href="#Connection-908"><span class="linenos"> 908</span></a>                <span class="n">msg</span> <span class="o">+=</span> <span class="p">(</span>
</span><span id="Connection-909"><a href="#Connection-909"><span class="linenos"> 909</span></a>                    <span class="s2">&quot;. Is the path &#39;</span><span class="si">{}</span><span class="s2">&#39; included in the &#39;url&#39; &quot;</span>
</span><span id="Connection-910"><a href="#Connection-910"><span class="linenos"> 910</span></a>                    <span class="s2">&quot;parameter correct?&quot;</span>
</span><span id="Connection-911"><a href="#Connection-911"><span class="linenos"> 911</span></a>                <span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">url</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
</span><span id="Connection-912"><a href="#Connection-912"><span class="linenos"> 912</span></a>                <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot; The typical one is &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__TYPICAL_PATH</span><span class="p">)</span>
</span><span id="Connection-913"><a href="#Connection-913"><span class="linenos"> 913</span></a>            <span class="k">raise</span> <span class="n">Error</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="Connection-914"><a href="#Connection-914"><span class="linenos"> 914</span></a>
</span><span id="Connection-915"><a href="#Connection-915"><span class="linenos"> 915</span></a>    <span class="k">def</span> <span class="nf">_read_reponse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
</span><span id="Connection-916"><a href="#Connection-916"><span class="linenos"> 916</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Connection-917"><a href="#Connection-917"><span class="linenos"> 917</span></a><span class="sd">        Read the response.</span>
</span><span id="Connection-918"><a href="#Connection-918"><span class="linenos"> 918</span></a>
</span><span id="Connection-919"><a href="#Connection-919"><span class="linenos"> 919</span></a><span class="sd">        `context` tuple which contains cur easy, response body,</span>
</span><span id="Connection-920"><a href="#Connection-920"><span class="linenos"> 920</span></a><span class="sd">        response headers, original request</span>
</span><span id="Connection-921"><a href="#Connection-921"><span class="linenos"> 921</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Connection-922"><a href="#Connection-922"><span class="linenos"> 922</span></a>        <span class="c1"># Extract the response code and body:</span>
</span><span id="Connection-923"><a href="#Connection-923"><span class="linenos"> 923</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="n">Response</span><span class="p">()</span>
</span><span id="Connection-924"><a href="#Connection-924"><span class="linenos"> 924</span></a>        <span class="n">response</span><span class="o">.</span><span class="n">code</span> <span class="o">=</span> <span class="n">context</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">getinfo</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">HTTP_CODE</span><span class="p">)</span>
</span><span id="Connection-925"><a href="#Connection-925"><span class="linenos"> 925</span></a>        <span class="n">response</span><span class="o">.</span><span class="n">body</span> <span class="o">=</span> <span class="n">context</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
</span><span id="Connection-926"><a href="#Connection-926"><span class="linenos"> 926</span></a>
</span><span id="Connection-927"><a href="#Connection-927"><span class="linenos"> 927</span></a>        <span class="c1"># The response code can be extracted directly, but cURL doesn&#39;t</span>
</span><span id="Connection-928"><a href="#Connection-928"><span class="linenos"> 928</span></a>        <span class="c1"># have a method to extract the response message, so we have to</span>
</span><span id="Connection-929"><a href="#Connection-929"><span class="linenos"> 929</span></a>        <span class="c1"># parse the first header line to find it:</span>
</span><span id="Connection-930"><a href="#Connection-930"><span class="linenos"> 930</span></a>        <span class="n">response</span><span class="o">.</span><span class="n">reason</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="Connection-931"><a href="#Connection-931"><span class="linenos"> 931</span></a>        <span class="n">headers_text</span> <span class="o">=</span> <span class="n">context</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">)</span>
</span><span id="Connection-932"><a href="#Connection-932"><span class="linenos"> 932</span></a>        <span class="n">header_lines</span> <span class="o">=</span> <span class="n">headers_text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Connection-933"><a href="#Connection-933"><span class="linenos"> 933</span></a>        <span class="n">response</span><span class="o">.</span><span class="n">headers</span> <span class="o">=</span> <span class="n">header_lines</span>
</span><span id="Connection-934"><a href="#Connection-934"><span class="linenos"> 934</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">header_lines</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Connection-935"><a href="#Connection-935"><span class="linenos"> 935</span></a>            <span class="n">response_line</span> <span class="o">=</span> <span class="n">header_lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Connection-936"><a href="#Connection-936"><span class="linenos"> 936</span></a>            <span class="n">response_fields</span> <span class="o">=</span> <span class="n">response_line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</span><span id="Connection-937"><a href="#Connection-937"><span class="linenos"> 937</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">response_fields</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">:</span>
</span><span id="Connection-938"><a href="#Connection-938"><span class="linenos"> 938</span></a>                <span class="n">response</span><span class="o">.</span><span class="n">reason</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">response_fields</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span>
</span><span id="Connection-939"><a href="#Connection-939"><span class="linenos"> 939</span></a>
</span><span id="Connection-940"><a href="#Connection-940"><span class="linenos"> 940</span></a>        <span class="n">context</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="Connection-941"><a href="#Connection-941"><span class="linenos"> 941</span></a>        <span class="c1"># Return the response:</span>
</span><span id="Connection-942"><a href="#Connection-942"><span class="linenos"> 942</span></a>        <span class="k">return</span> <span class="n">response</span>
</span><span id="Connection-943"><a href="#Connection-943"><span class="linenos"> 943</span></a>
</span><span id="Connection-944"><a href="#Connection-944"><span class="linenos"> 944</span></a>    <span class="k">def</span> <span class="nf">__parse_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">error</span><span class="p">):</span>
</span><span id="Connection-945"><a href="#Connection-945"><span class="linenos"> 945</span></a>        <span class="n">e_code</span> <span class="o">=</span> <span class="n">error</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Connection-946"><a href="#Connection-946"><span class="linenos"> 946</span></a>        <span class="n">clazz</span> <span class="o">=</span> <span class="n">Error</span>
</span><span id="Connection-947"><a href="#Connection-947"><span class="linenos"> 947</span></a>        <span class="n">error_msg</span> <span class="o">=</span> <span class="s2">&quot;Error while sending HTTP request: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
</span><span id="Connection-948"><a href="#Connection-948"><span class="linenos"> 948</span></a>
</span><span id="Connection-949"><a href="#Connection-949"><span class="linenos"> 949</span></a>        <span class="k">if</span> <span class="n">e_code</span> <span class="ow">in</span> <span class="p">[</span>
</span><span id="Connection-950"><a href="#Connection-950"><span class="linenos"> 950</span></a>            <span class="n">pycurl</span><span class="o">.</span><span class="n">E_COULDNT_CONNECT</span><span class="p">,</span> <span class="n">pycurl</span><span class="o">.</span><span class="n">E_COULDNT_RESOLVE_HOST</span>
</span><span id="Connection-951"><a href="#Connection-951"><span class="linenos"> 951</span></a>        <span class="p">]:</span>
</span><span id="Connection-952"><a href="#Connection-952"><span class="linenos"> 952</span></a>            <span class="n">clazz</span> <span class="o">=</span> <span class="ne">ConnectionError</span>
</span><span id="Connection-953"><a href="#Connection-953"><span class="linenos"> 953</span></a>        <span class="k">elif</span> <span class="n">e_code</span> <span class="o">==</span> <span class="n">pycurl</span><span class="o">.</span><span class="n">E_OPERATION_TIMEOUTED</span><span class="p">:</span>
</span><span id="Connection-954"><a href="#Connection-954"><span class="linenos"> 954</span></a>            <span class="n">clazz</span> <span class="o">=</span> <span class="ne">TimeoutError</span>
</span><span id="Connection-955"><a href="#Connection-955"><span class="linenos"> 955</span></a>
</span><span id="Connection-956"><a href="#Connection-956"><span class="linenos"> 956</span></a>        <span class="k">raise</span> <span class="n">clazz</span><span class="p">(</span><span class="n">error_msg</span><span class="p">)</span><span class="o">.</span><span class="n">with_traceback</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">2</span><span class="p">])</span>
</span><span id="Connection-957"><a href="#Connection-957"><span class="linenos"> 957</span></a>
</span><span id="Connection-958"><a href="#Connection-958"><span class="linenos"> 958</span></a>    <span class="k">def</span> <span class="nf">_get_header_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">headers</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
</span><span id="Connection-959"><a href="#Connection-959"><span class="linenos"> 959</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Connection-960"><a href="#Connection-960"><span class="linenos"> 960</span></a><span class="sd">        Return header value by its name.</span>
</span><span id="Connection-961"><a href="#Connection-961"><span class="linenos"> 961</span></a>
</span><span id="Connection-962"><a href="#Connection-962"><span class="linenos"> 962</span></a><span class="sd">        `headers` list of headers</span>
</span><span id="Connection-963"><a href="#Connection-963"><span class="linenos"> 963</span></a><span class="sd">        `name` name of the header</span>
</span><span id="Connection-964"><a href="#Connection-964"><span class="linenos"> 964</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Connection-965"><a href="#Connection-965"><span class="linenos"> 965</span></a>        <span class="k">return</span> <span class="nb">next</span><span class="p">(</span>
</span><span id="Connection-966"><a href="#Connection-966"><span class="linenos"> 966</span></a>            <span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">headers</span> <span class="k">if</span> <span class="n">h</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">name</span><span class="p">)),</span>
</span><span id="Connection-967"><a href="#Connection-967"><span class="linenos"> 967</span></a>            <span class="kc">None</span>
</span><span id="Connection-968"><a href="#Connection-968"><span class="linenos"> 968</span></a>        <span class="p">)</span>
</span><span id="Connection-969"><a href="#Connection-969"><span class="linenos"> 969</span></a>
</span><span id="Connection-970"><a href="#Connection-970"><span class="linenos"> 970</span></a>    <span class="k">def</span> <span class="nf">_curl_debug</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">debug_type</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span><span id="Connection-971"><a href="#Connection-971"><span class="linenos"> 971</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Connection-972"><a href="#Connection-972"><span class="linenos"> 972</span></a><span class="sd">        This is the implementation of the cURL debug callback.</span>
</span><span id="Connection-973"><a href="#Connection-973"><span class="linenos"> 973</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Connection-974"><a href="#Connection-974"><span class="linenos"> 974</span></a>
</span><span id="Connection-975"><a href="#Connection-975"><span class="linenos"> 975</span></a>        <span class="c1"># Exclude all types of debug data that we don&#39;t know how to</span>
</span><span id="Connection-976"><a href="#Connection-976"><span class="linenos"> 976</span></a>        <span class="c1"># handle, as trying to decode and manipulate that data as</span>
</span><span id="Connection-977"><a href="#Connection-977"><span class="linenos"> 977</span></a>        <span class="c1"># strings will likely fail.</span>
</span><span id="Connection-978"><a href="#Connection-978"><span class="linenos"> 978</span></a>        <span class="k">if</span> <span class="n">debug_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__KNOWN_DEBUG_TYPES</span><span class="p">:</span>
</span><span id="Connection-979"><a href="#Connection-979"><span class="linenos"> 979</span></a>            <span class="k">return</span>
</span><span id="Connection-980"><a href="#Connection-980"><span class="linenos"> 980</span></a>
</span><span id="Connection-981"><a href="#Connection-981"><span class="linenos"> 981</span></a>        <span class="c1"># Some versions of PycURL provide the debug data as strings, and</span>
</span><span id="Connection-982"><a href="#Connection-982"><span class="linenos"> 982</span></a>        <span class="c1"># some as arrays of bytes, so we need to check the type of the</span>
</span><span id="Connection-983"><a href="#Connection-983"><span class="linenos"> 983</span></a>        <span class="c1"># provided data and convert it to strings before trying to</span>
</span><span id="Connection-984"><a href="#Connection-984"><span class="linenos"> 984</span></a>        <span class="c1"># manipulate it with the &quot;replace&quot;, &quot;strip&quot; and &quot;split&quot; methods:</span>
</span><span id="Connection-985"><a href="#Connection-985"><span class="linenos"> 985</span></a>        <span class="n">text</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)</span> <span class="k">else</span> <span class="n">data</span>
</span><span id="Connection-986"><a href="#Connection-986"><span class="linenos"> 986</span></a>
</span><span id="Connection-987"><a href="#Connection-987"><span class="linenos"> 987</span></a>        <span class="c1"># Split the debug data into lines and send a debug message for</span>
</span><span id="Connection-988"><a href="#Connection-988"><span class="linenos"> 988</span></a>        <span class="c1"># each line:</span>
</span><span id="Connection-989"><a href="#Connection-989"><span class="linenos"> 989</span></a>        <span class="n">lines</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\r\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Connection-990"><a href="#Connection-990"><span class="linenos"> 990</span></a>        <span class="n">prefix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__DEBUG_PREFIXES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">debug_type</span><span class="p">)</span>
</span><span id="Connection-991"><a href="#Connection-991"><span class="linenos"> 991</span></a>        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
</span><span id="Connection-992"><a href="#Connection-992"><span class="linenos"> 992</span></a>            <span class="k">if</span> <span class="n">prefix</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Connection-993"><a href="#Connection-993"><span class="linenos"> 993</span></a>                <span class="n">line</span> <span class="o">=</span> <span class="n">prefix</span> <span class="o">+</span> <span class="n">line</span>
</span><span id="Connection-994"><a href="#Connection-994"><span class="linenos"> 994</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="Connection-995"><a href="#Connection-995"><span class="linenos"> 995</span></a>
</span><span id="Connection-996"><a href="#Connection-996"><span class="linenos"> 996</span></a>    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Connection-997"><a href="#Connection-997"><span class="linenos"> 997</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="Connection-998"><a href="#Connection-998"><span class="linenos"> 998</span></a>
</span><span id="Connection-999"><a href="#Connection-999"><span class="linenos"> 999</span></a>    <span class="k">def</span> <span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_value</span><span class="p">,</span> <span class="n">traceback</span><span class="p">):</span>
</span><span id="Connection-1000"><a href="#Connection-1000"><span class="linenos">1000</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>This class is responsible for managing an HTTP connection to the engine
server. It is intended as the entry point for the SDK, and it provides
access to the <code>system</code> service and, from there, to the rest of the
services provided by the API.</p>
</div>


                            <div id="Connection.__init__" class="classattr">
                                        <input id="Connection.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Connection</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">url</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">username</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">password</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">token</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">insecure</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">ca_file</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">debug</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">log</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">kerberos</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">timeout</span><span class="o">=</span><span class="mi">0</span>,</span><span class="param">	<span class="n">compress</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">sso_url</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">sso_revoke_url</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">sso_token_name</span><span class="o">=</span><span class="s1">&#39;access_token&#39;</span>,</span><span class="param">	<span class="n">headers</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">pipeline</span><span class="o">=</span><span class="mi">0</span>,</span><span class="param">	<span class="n">connections</span><span class="o">=</span><span class="mi">0</span></span>)</span>

                <label class="view-source-button" for="Connection.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Connection.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Connection.__init__-214"><a href="#Connection.__init__-214"><span class="linenos">214</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="Connection.__init__-215"><a href="#Connection.__init__-215"><span class="linenos">215</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Connection.__init__-216"><a href="#Connection.__init__-216"><span class="linenos">216</span></a>        <span class="n">url</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Connection.__init__-217"><a href="#Connection.__init__-217"><span class="linenos">217</span></a>        <span class="n">username</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Connection.__init__-218"><a href="#Connection.__init__-218"><span class="linenos">218</span></a>        <span class="n">password</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Connection.__init__-219"><a href="#Connection.__init__-219"><span class="linenos">219</span></a>        <span class="n">token</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Connection.__init__-220"><a href="#Connection.__init__-220"><span class="linenos">220</span></a>        <span class="n">insecure</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="Connection.__init__-221"><a href="#Connection.__init__-221"><span class="linenos">221</span></a>        <span class="n">ca_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Connection.__init__-222"><a href="#Connection.__init__-222"><span class="linenos">222</span></a>        <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="Connection.__init__-223"><a href="#Connection.__init__-223"><span class="linenos">223</span></a>        <span class="n">log</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Connection.__init__-224"><a href="#Connection.__init__-224"><span class="linenos">224</span></a>        <span class="n">kerberos</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="Connection.__init__-225"><a href="#Connection.__init__-225"><span class="linenos">225</span></a>        <span class="n">timeout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="Connection.__init__-226"><a href="#Connection.__init__-226"><span class="linenos">226</span></a>        <span class="n">compress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="Connection.__init__-227"><a href="#Connection.__init__-227"><span class="linenos">227</span></a>        <span class="n">sso_url</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Connection.__init__-228"><a href="#Connection.__init__-228"><span class="linenos">228</span></a>        <span class="n">sso_revoke_url</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Connection.__init__-229"><a href="#Connection.__init__-229"><span class="linenos">229</span></a>        <span class="n">sso_token_name</span><span class="o">=</span><span class="s1">&#39;access_token&#39;</span><span class="p">,</span>
</span><span id="Connection.__init__-230"><a href="#Connection.__init__-230"><span class="linenos">230</span></a>        <span class="n">headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Connection.__init__-231"><a href="#Connection.__init__-231"><span class="linenos">231</span></a>        <span class="n">pipeline</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="Connection.__init__-232"><a href="#Connection.__init__-232"><span class="linenos">232</span></a>        <span class="n">connections</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="Connection.__init__-233"><a href="#Connection.__init__-233"><span class="linenos">233</span></a>    <span class="p">):</span>
</span><span id="Connection.__init__-234"><a href="#Connection.__init__-234"><span class="linenos">234</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Connection.__init__-235"><a href="#Connection.__init__-235"><span class="linenos">235</span></a><span class="sd">        Creates a new connection to the API server.</span>
</span><span id="Connection.__init__-236"><a href="#Connection.__init__-236"><span class="linenos">236</span></a>
</span><span id="Connection.__init__-237"><a href="#Connection.__init__-237"><span class="linenos">237</span></a><span class="sd">        This method supports the following parameters:</span>
</span><span id="Connection.__init__-238"><a href="#Connection.__init__-238"><span class="linenos">238</span></a>
</span><span id="Connection.__init__-239"><a href="#Connection.__init__-239"><span class="linenos">239</span></a><span class="sd">        `url` \n</span>
</span><span id="Connection.__init__-240"><a href="#Connection.__init__-240"><span class="linenos">240</span></a><span class="sd">        A string containing the base URL of the server, usually</span>
</span><span id="Connection.__init__-241"><a href="#Connection.__init__-241"><span class="linenos">241</span></a><span class="sd">        something like `https://server.example.com/ovirt-engine/api`.</span>
</span><span id="Connection.__init__-242"><a href="#Connection.__init__-242"><span class="linenos">242</span></a>
</span><span id="Connection.__init__-243"><a href="#Connection.__init__-243"><span class="linenos">243</span></a><span class="sd">        `username` \n</span>
</span><span id="Connection.__init__-244"><a href="#Connection.__init__-244"><span class="linenos">244</span></a><span class="sd">        The name of the user, something like `admin@internal`.</span>
</span><span id="Connection.__init__-245"><a href="#Connection.__init__-245"><span class="linenos">245</span></a>
</span><span id="Connection.__init__-246"><a href="#Connection.__init__-246"><span class="linenos">246</span></a><span class="sd">        `password` \n</span>
</span><span id="Connection.__init__-247"><a href="#Connection.__init__-247"><span class="linenos">247</span></a><span class="sd">        The name password of the user.</span>
</span><span id="Connection.__init__-248"><a href="#Connection.__init__-248"><span class="linenos">248</span></a>
</span><span id="Connection.__init__-249"><a href="#Connection.__init__-249"><span class="linenos">249</span></a><span class="sd">        `token` \n</span>
</span><span id="Connection.__init__-250"><a href="#Connection.__init__-250"><span class="linenos">250</span></a><span class="sd">        The token to be used to access API. Optionally, user can</span>
</span><span id="Connection.__init__-251"><a href="#Connection.__init__-251"><span class="linenos">251</span></a><span class="sd">        use token, instead of username and password to access API. If user</span>
</span><span id="Connection.__init__-252"><a href="#Connection.__init__-252"><span class="linenos">252</span></a><span class="sd">        don&#39;t specify `token` parameter, SDK will automatically create one.</span>
</span><span id="Connection.__init__-253"><a href="#Connection.__init__-253"><span class="linenos">253</span></a>
</span><span id="Connection.__init__-254"><a href="#Connection.__init__-254"><span class="linenos">254</span></a><span class="sd">        `insecure` \n</span>
</span><span id="Connection.__init__-255"><a href="#Connection.__init__-255"><span class="linenos">255</span></a><span class="sd">        A boolean flag that indicates if the server TLS</span>
</span><span id="Connection.__init__-256"><a href="#Connection.__init__-256"><span class="linenos">256</span></a><span class="sd">        certificate and host name should be checked.</span>
</span><span id="Connection.__init__-257"><a href="#Connection.__init__-257"><span class="linenos">257</span></a>
</span><span id="Connection.__init__-258"><a href="#Connection.__init__-258"><span class="linenos">258</span></a><span class="sd">        `ca_file` \n</span>
</span><span id="Connection.__init__-259"><a href="#Connection.__init__-259"><span class="linenos">259</span></a><span class="sd">        A PEM file containing the trusted CA certificates. The</span>
</span><span id="Connection.__init__-260"><a href="#Connection.__init__-260"><span class="linenos">260</span></a><span class="sd">        certificate presented by the server will be verified using these CA</span>
</span><span id="Connection.__init__-261"><a href="#Connection.__init__-261"><span class="linenos">261</span></a><span class="sd">        certificates. If `ca_file` parameter is not set, system wide</span>
</span><span id="Connection.__init__-262"><a href="#Connection.__init__-262"><span class="linenos">262</span></a><span class="sd">        CA certificate store is used.</span>
</span><span id="Connection.__init__-263"><a href="#Connection.__init__-263"><span class="linenos">263</span></a>
</span><span id="Connection.__init__-264"><a href="#Connection.__init__-264"><span class="linenos">264</span></a><span class="sd">        `debug` \n</span>
</span><span id="Connection.__init__-265"><a href="#Connection.__init__-265"><span class="linenos">265</span></a><span class="sd">        A boolean flag indicating if debug output should be</span>
</span><span id="Connection.__init__-266"><a href="#Connection.__init__-266"><span class="linenos">266</span></a><span class="sd">        generated. If the value is `True` and the `log` parameter isn&#39;t</span>
</span><span id="Connection.__init__-267"><a href="#Connection.__init__-267"><span class="linenos">267</span></a><span class="sd">        `None` then the data sent to and received from the server will</span>
</span><span id="Connection.__init__-268"><a href="#Connection.__init__-268"><span class="linenos">268</span></a><span class="sd">        be written to the log. Be aware that user names and passwords will</span>
</span><span id="Connection.__init__-269"><a href="#Connection.__init__-269"><span class="linenos">269</span></a><span class="sd">        also be written, so handle it with care.</span>
</span><span id="Connection.__init__-270"><a href="#Connection.__init__-270"><span class="linenos">270</span></a>
</span><span id="Connection.__init__-271"><a href="#Connection.__init__-271"><span class="linenos">271</span></a><span class="sd">        `log` \n</span>
</span><span id="Connection.__init__-272"><a href="#Connection.__init__-272"><span class="linenos">272</span></a><span class="sd">        The logger where the log messages will be written.</span>
</span><span id="Connection.__init__-273"><a href="#Connection.__init__-273"><span class="linenos">273</span></a>
</span><span id="Connection.__init__-274"><a href="#Connection.__init__-274"><span class="linenos">274</span></a><span class="sd">        `kerberos` \n</span>
</span><span id="Connection.__init__-275"><a href="#Connection.__init__-275"><span class="linenos">275</span></a><span class="sd">        A boolean flag indicating if Kerberos</span>
</span><span id="Connection.__init__-276"><a href="#Connection.__init__-276"><span class="linenos">276</span></a><span class="sd">        authentication should be used instead of the default basic</span>
</span><span id="Connection.__init__-277"><a href="#Connection.__init__-277"><span class="linenos">277</span></a><span class="sd">        authentication.</span>
</span><span id="Connection.__init__-278"><a href="#Connection.__init__-278"><span class="linenos">278</span></a>
</span><span id="Connection.__init__-279"><a href="#Connection.__init__-279"><span class="linenos">279</span></a><span class="sd">        `timeout` \n</span>
</span><span id="Connection.__init__-280"><a href="#Connection.__init__-280"><span class="linenos">280</span></a><span class="sd">        The maximum total time to wait for the response, in</span>
</span><span id="Connection.__init__-281"><a href="#Connection.__init__-281"><span class="linenos">281</span></a><span class="sd">        seconds. A value of zero (the default) means wait for ever. If</span>
</span><span id="Connection.__init__-282"><a href="#Connection.__init__-282"><span class="linenos">282</span></a><span class="sd">        the timeout expires before the response is received an exception</span>
</span><span id="Connection.__init__-283"><a href="#Connection.__init__-283"><span class="linenos">283</span></a><span class="sd">        will be raised.</span>
</span><span id="Connection.__init__-284"><a href="#Connection.__init__-284"><span class="linenos">284</span></a>
</span><span id="Connection.__init__-285"><a href="#Connection.__init__-285"><span class="linenos">285</span></a><span class="sd">        `compress` \n</span>
</span><span id="Connection.__init__-286"><a href="#Connection.__init__-286"><span class="linenos">286</span></a><span class="sd">        A boolean flag indicating if the SDK should ask</span>
</span><span id="Connection.__init__-287"><a href="#Connection.__init__-287"><span class="linenos">287</span></a><span class="sd">        the server to send compressed responses. The default is `True`.</span>
</span><span id="Connection.__init__-288"><a href="#Connection.__init__-288"><span class="linenos">288</span></a><span class="sd">        Note that this is a hint for the server, and that it may return</span>
</span><span id="Connection.__init__-289"><a href="#Connection.__init__-289"><span class="linenos">289</span></a><span class="sd">        uncompressed data even when this parameter is set to `True`.</span>
</span><span id="Connection.__init__-290"><a href="#Connection.__init__-290"><span class="linenos">290</span></a><span class="sd">        Note that compression will be disabled if user pass `debug`</span>
</span><span id="Connection.__init__-291"><a href="#Connection.__init__-291"><span class="linenos">291</span></a><span class="sd">        parameter set to `true`, so the debug messages are in plain text.</span>
</span><span id="Connection.__init__-292"><a href="#Connection.__init__-292"><span class="linenos">292</span></a>
</span><span id="Connection.__init__-293"><a href="#Connection.__init__-293"><span class="linenos">293</span></a><span class="sd">        `sso_url` \n</span>
</span><span id="Connection.__init__-294"><a href="#Connection.__init__-294"><span class="linenos">294</span></a><span class="sd">        A string containing the base SSO URL of the serve.</span>
</span><span id="Connection.__init__-295"><a href="#Connection.__init__-295"><span class="linenos">295</span></a><span class="sd">        Default SSO url is computed from the `url` if no `sso_url` is provided.</span>
</span><span id="Connection.__init__-296"><a href="#Connection.__init__-296"><span class="linenos">296</span></a>
</span><span id="Connection.__init__-297"><a href="#Connection.__init__-297"><span class="linenos">297</span></a><span class="sd">        `sso_revoke_url` \n</span>
</span><span id="Connection.__init__-298"><a href="#Connection.__init__-298"><span class="linenos">298</span></a><span class="sd">        A string containing the base URL of the SSO</span>
</span><span id="Connection.__init__-299"><a href="#Connection.__init__-299"><span class="linenos">299</span></a><span class="sd">        revoke service. This needs to be specified only when using</span>
</span><span id="Connection.__init__-300"><a href="#Connection.__init__-300"><span class="linenos">300</span></a><span class="sd">        an external authentication service. By default this URL</span>
</span><span id="Connection.__init__-301"><a href="#Connection.__init__-301"><span class="linenos">301</span></a><span class="sd">        is automatically calculated from the value of the `url` parameter,</span>
</span><span id="Connection.__init__-302"><a href="#Connection.__init__-302"><span class="linenos">302</span></a><span class="sd">        so that SSO token revoke will be performed using the SSO service</span>
</span><span id="Connection.__init__-303"><a href="#Connection.__init__-303"><span class="linenos">303</span></a><span class="sd">        that is part of the engine.</span>
</span><span id="Connection.__init__-304"><a href="#Connection.__init__-304"><span class="linenos">304</span></a>
</span><span id="Connection.__init__-305"><a href="#Connection.__init__-305"><span class="linenos">305</span></a><span class="sd">        `sso_token_name` \n</span>
</span><span id="Connection.__init__-306"><a href="#Connection.__init__-306"><span class="linenos">306</span></a><span class="sd">        The token name in the JSON SSO response returned</span>
</span><span id="Connection.__init__-307"><a href="#Connection.__init__-307"><span class="linenos">307</span></a><span class="sd">        from the SSO server. Default value is `access_token`.</span>
</span><span id="Connection.__init__-308"><a href="#Connection.__init__-308"><span class="linenos">308</span></a>
</span><span id="Connection.__init__-309"><a href="#Connection.__init__-309"><span class="linenos">309</span></a><span class="sd">        `headers` \n</span>
</span><span id="Connection.__init__-310"><a href="#Connection.__init__-310"><span class="linenos">310</span></a><span class="sd">        A dictionary with headers which should be send with every</span>
</span><span id="Connection.__init__-311"><a href="#Connection.__init__-311"><span class="linenos">311</span></a><span class="sd">        request.</span>
</span><span id="Connection.__init__-312"><a href="#Connection.__init__-312"><span class="linenos">312</span></a>
</span><span id="Connection.__init__-313"><a href="#Connection.__init__-313"><span class="linenos">313</span></a><span class="sd">        `connections` \n</span>
</span><span id="Connection.__init__-314"><a href="#Connection.__init__-314"><span class="linenos">314</span></a><span class="sd">        The maximum number of connections to open to the host.</span>
</span><span id="Connection.__init__-315"><a href="#Connection.__init__-315"><span class="linenos">315</span></a><span class="sd">        If the value is `0` (the default) then the number of connections will</span>
</span><span id="Connection.__init__-316"><a href="#Connection.__init__-316"><span class="linenos">316</span></a><span class="sd">        be unlimited.</span>
</span><span id="Connection.__init__-317"><a href="#Connection.__init__-317"><span class="linenos">317</span></a>
</span><span id="Connection.__init__-318"><a href="#Connection.__init__-318"><span class="linenos">318</span></a><span class="sd">        `pipeline` \n</span>
</span><span id="Connection.__init__-319"><a href="#Connection.__init__-319"><span class="linenos">319</span></a><span class="sd">        The maximum number of request to put in an HTTP pipeline</span>
</span><span id="Connection.__init__-320"><a href="#Connection.__init__-320"><span class="linenos">320</span></a><span class="sd">        without waiting for the response. If the value is `0` (the default)</span>
</span><span id="Connection.__init__-321"><a href="#Connection.__init__-321"><span class="linenos">321</span></a><span class="sd">        then pipelining is disabled.</span>
</span><span id="Connection.__init__-322"><a href="#Connection.__init__-322"><span class="linenos">322</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Connection.__init__-323"><a href="#Connection.__init__-323"><span class="linenos">323</span></a>
</span><span id="Connection.__init__-324"><a href="#Connection.__init__-324"><span class="linenos">324</span></a>        <span class="c1"># Check mandatory parameters:</span>
</span><span id="Connection.__init__-325"><a href="#Connection.__init__-325"><span class="linenos">325</span></a>        <span class="k">if</span> <span class="n">url</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Connection.__init__-326"><a href="#Connection.__init__-326"><span class="linenos">326</span></a>            <span class="k">raise</span> <span class="n">Error</span><span class="p">(</span><span class="s1">&#39;The </span><span class="se">\&#39;</span><span class="s1">url</span><span class="se">\&#39;</span><span class="s1"> parameter is mandatory&#39;</span><span class="p">)</span>
</span><span id="Connection.__init__-327"><a href="#Connection.__init__-327"><span class="linenos">327</span></a>
</span><span id="Connection.__init__-328"><a href="#Connection.__init__-328"><span class="linenos">328</span></a>        <span class="c1"># Check that the CA file exists if insecure is not set:</span>
</span><span id="Connection.__init__-329"><a href="#Connection.__init__-329"><span class="linenos">329</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">insecure</span><span class="p">:</span>
</span><span id="Connection.__init__-330"><a href="#Connection.__init__-330"><span class="linenos">330</span></a>            <span class="k">if</span> <span class="n">ca_file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">ca_file</span><span class="p">):</span>
</span><span id="Connection.__init__-331"><a href="#Connection.__init__-331"><span class="linenos">331</span></a>                <span class="k">raise</span> <span class="n">Error</span><span class="p">(</span><span class="s1">&#39;The CA file </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1"> doesn</span><span class="se">\&#39;</span><span class="s1">t exist&#39;</span> <span class="o">%</span> <span class="n">ca_file</span><span class="p">)</span>
</span><span id="Connection.__init__-332"><a href="#Connection.__init__-332"><span class="linenos">332</span></a>
</span><span id="Connection.__init__-333"><a href="#Connection.__init__-333"><span class="linenos">333</span></a>        <span class="c1"># Save the URL:</span>
</span><span id="Connection.__init__-334"><a href="#Connection.__init__-334"><span class="linenos">334</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_url</span> <span class="o">=</span> <span class="n">url</span>
</span><span id="Connection.__init__-335"><a href="#Connection.__init__-335"><span class="linenos">335</span></a>
</span><span id="Connection.__init__-336"><a href="#Connection.__init__-336"><span class="linenos">336</span></a>        <span class="c1"># Save the logger:</span>
</span><span id="Connection.__init__-337"><a href="#Connection.__init__-337"><span class="linenos">337</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span> <span class="o">=</span> <span class="n">log</span>
</span><span id="Connection.__init__-338"><a href="#Connection.__init__-338"><span class="linenos">338</span></a>
</span><span id="Connection.__init__-339"><a href="#Connection.__init__-339"><span class="linenos">339</span></a>        <span class="c1"># Save the credentials:</span>
</span><span id="Connection.__init__-340"><a href="#Connection.__init__-340"><span class="linenos">340</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_username</span> <span class="o">=</span> <span class="n">username</span>
</span><span id="Connection.__init__-341"><a href="#Connection.__init__-341"><span class="linenos">341</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_password</span> <span class="o">=</span> <span class="n">password</span>
</span><span id="Connection.__init__-342"><a href="#Connection.__init__-342"><span class="linenos">342</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sso_token</span> <span class="o">=</span> <span class="n">token</span>
</span><span id="Connection.__init__-343"><a href="#Connection.__init__-343"><span class="linenos">343</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_kerberos</span> <span class="o">=</span> <span class="n">kerberos</span>
</span><span id="Connection.__init__-344"><a href="#Connection.__init__-344"><span class="linenos">344</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_ca_file</span> <span class="o">=</span> <span class="n">ca_file</span>
</span><span id="Connection.__init__-345"><a href="#Connection.__init__-345"><span class="linenos">345</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_insecure</span> <span class="o">=</span> <span class="n">insecure</span>
</span><span id="Connection.__init__-346"><a href="#Connection.__init__-346"><span class="linenos">346</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_timeout</span> <span class="o">=</span> <span class="n">timeout</span>
</span><span id="Connection.__init__-347"><a href="#Connection.__init__-347"><span class="linenos">347</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_debug</span> <span class="o">=</span> <span class="n">debug</span>
</span><span id="Connection.__init__-348"><a href="#Connection.__init__-348"><span class="linenos">348</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_compress</span> <span class="o">=</span> <span class="n">compress</span>
</span><span id="Connection.__init__-349"><a href="#Connection.__init__-349"><span class="linenos">349</span></a>
</span><span id="Connection.__init__-350"><a href="#Connection.__init__-350"><span class="linenos">350</span></a>        <span class="c1"># The curl object can be used by several threads, but not</span>
</span><span id="Connection.__init__-351"><a href="#Connection.__init__-351"><span class="linenos">351</span></a>        <span class="c1"># simultaneously, so we need a lock to prevent that:</span>
</span><span id="Connection.__init__-352"><a href="#Connection.__init__-352"><span class="linenos">352</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_curl_lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
</span><span id="Connection.__init__-353"><a href="#Connection.__init__-353"><span class="linenos">353</span></a>
</span><span id="Connection.__init__-354"><a href="#Connection.__init__-354"><span class="linenos">354</span></a>        <span class="c1"># Set SSO attributes:</span>
</span><span id="Connection.__init__-355"><a href="#Connection.__init__-355"><span class="linenos">355</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sso_url</span> <span class="o">=</span> <span class="n">sso_url</span>
</span><span id="Connection.__init__-356"><a href="#Connection.__init__-356"><span class="linenos">356</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sso_revoke_url</span> <span class="o">=</span> <span class="n">sso_revoke_url</span>
</span><span id="Connection.__init__-357"><a href="#Connection.__init__-357"><span class="linenos">357</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sso_token_name</span> <span class="o">=</span> <span class="n">sso_token_name</span>
</span><span id="Connection.__init__-358"><a href="#Connection.__init__-358"><span class="linenos">358</span></a>
</span><span id="Connection.__init__-359"><a href="#Connection.__init__-359"><span class="linenos">359</span></a>        <span class="c1"># Headers:</span>
</span><span id="Connection.__init__-360"><a href="#Connection.__init__-360"><span class="linenos">360</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_headers</span> <span class="o">=</span> <span class="n">headers</span> <span class="ow">or</span> <span class="p">{}</span>
</span><span id="Connection.__init__-361"><a href="#Connection.__init__-361"><span class="linenos">361</span></a>
</span><span id="Connection.__init__-362"><a href="#Connection.__init__-362"><span class="linenos">362</span></a>        <span class="c1"># Create the curl handle that manages the pool of connections:</span>
</span><span id="Connection.__init__-363"><a href="#Connection.__init__-363"><span class="linenos">363</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_multi</span> <span class="o">=</span> <span class="n">pycurl</span><span class="o">.</span><span class="n">CurlMulti</span><span class="p">()</span>
</span><span id="Connection.__init__-364"><a href="#Connection.__init__-364"><span class="linenos">364</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_multi</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">M_PIPELINING</span><span class="p">,</span> <span class="nb">bool</span><span class="p">(</span><span class="n">pipeline</span><span class="p">))</span>
</span><span id="Connection.__init__-365"><a href="#Connection.__init__-365"><span class="linenos">365</span></a>        <span class="c1"># Since libcurl 7.30.0:</span>
</span><span id="Connection.__init__-366"><a href="#Connection.__init__-366"><span class="linenos">366</span></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">pycurl</span><span class="p">,</span> <span class="s1">&#39;M_MAX_PIPELINE_LENGTH&#39;</span><span class="p">):</span>
</span><span id="Connection.__init__-367"><a href="#Connection.__init__-367"><span class="linenos">367</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_multi</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">M_MAX_PIPELINE_LENGTH</span><span class="p">,</span> <span class="n">pipeline</span><span class="p">)</span>
</span><span id="Connection.__init__-368"><a href="#Connection.__init__-368"><span class="linenos">368</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_multi</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">pycurl</span><span class="o">.</span><span class="n">M_MAX_HOST_CONNECTIONS</span><span class="p">,</span> <span class="n">connections</span><span class="p">)</span>
</span><span id="Connection.__init__-369"><a href="#Connection.__init__-369"><span class="linenos">369</span></a>
</span><span id="Connection.__init__-370"><a href="#Connection.__init__-370"><span class="linenos">370</span></a>        <span class="c1"># Connections:</span>
</span><span id="Connection.__init__-371"><a href="#Connection.__init__-371"><span class="linenos">371</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_curls</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="Connection.__init__-372"><a href="#Connection.__init__-372"><span class="linenos">372</span></a>
</span><span id="Connection.__init__-373"><a href="#Connection.__init__-373"><span class="linenos">373</span></a>        <span class="c1"># Initialize the reference to the system service:</span>
</span><span id="Connection.__init__-374"><a href="#Connection.__init__-374"><span class="linenos">374</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__system_service</span> <span class="o">=</span> <span class="kc">None</span>
</span></pre></div>


            <div class="docstring"><p>Creates a new connection to the API server.</p>

<p>This method supports the following parameters:</p>

<p><code><a href="#Connection.url">url</a></code> </p>

<p>A string containing the base URL of the server, usually
something like <code>https://server.example.com/ovirt-engine/api</code>.</p>

<p><code>username</code> </p>

<p>The name of the user, something like <code>admin@internal</code>.</p>

<p><code>password</code> </p>

<p>The name password of the user.</p>

<p><code>token</code> </p>

<p>The token to be used to access API. Optionally, user can
use token, instead of username and password to access API. If user
don't specify <code>token</code> parameter, SDK will automatically create one.</p>

<p><code>insecure</code> </p>

<p>A boolean flag that indicates if the server TLS
certificate and host name should be checked.</p>

<p><code>ca_file</code> </p>

<p>A PEM file containing the trusted CA certificates. The
certificate presented by the server will be verified using these CA
certificates. If <code>ca_file</code> parameter is not set, system wide
CA certificate store is used.</p>

<p><code>debug</code> </p>

<p>A boolean flag indicating if debug output should be
generated. If the value is <code>True</code> and the <code>log</code> parameter isn't
<code>None</code> then the data sent to and received from the server will
be written to the log. Be aware that user names and passwords will
also be written, so handle it with care.</p>

<p><code>log</code> </p>

<p>The logger where the log messages will be written.</p>

<p><code>kerberos</code> </p>

<p>A boolean flag indicating if Kerberos
authentication should be used instead of the default basic
authentication.</p>

<p><code>timeout</code> </p>

<p>The maximum total time to wait for the response, in
seconds. A value of zero (the default) means wait for ever. If
the timeout expires before the response is received an exception
will be raised.</p>

<p><code>compress</code> </p>

<p>A boolean flag indicating if the SDK should ask
the server to send compressed responses. The default is <code>True</code>.
Note that this is a hint for the server, and that it may return
uncompressed data even when this parameter is set to <code>True</code>.
Note that compression will be disabled if user pass <code>debug</code>
parameter set to <code>true</code>, so the debug messages are in plain text.</p>

<p><code>sso_url</code> </p>

<p>A string containing the base SSO URL of the serve.
Default SSO url is computed from the <code><a href="#Connection.url">url</a></code> if no <code>sso_url</code> is provided.</p>

<p><code>sso_revoke_url</code> </p>

<p>A string containing the base URL of the SSO
revoke service. This needs to be specified only when using
an external authentication service. By default this URL
is automatically calculated from the value of the <code><a href="#Connection.url">url</a></code> parameter,
so that SSO token revoke will be performed using the SSO service
that is part of the engine.</p>

<p><code>sso_token_name</code> </p>

<p>The token name in the JSON SSO response returned
from the SSO server. Default value is <code>access_token</code>.</p>

<p><code>headers</code> </p>

<p>A dictionary with headers which should be send with every
request.</p>

<p><code>connections</code> </p>

<p>The maximum number of connections to open to the host.
If the value is <code>0</code> (the default) then the number of connections will
be unlimited.</p>

<p><code>pipeline</code> </p>

<p>The maximum number of request to put in an HTTP pipeline
without waiting for the response. If the value is <code>0</code> (the default)
then pipelining is disabled.</p>
</div>


                            </div>
                            <div id="Connection.send" class="classattr">
                                        <input id="Connection.send-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">send</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">request</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Connection.send-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Connection.send"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Connection.send-376"><a href="#Connection.send-376"><span class="linenos">376</span></a>    <span class="k">def</span> <span class="nf">send</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
</span><span id="Connection.send-377"><a href="#Connection.send-377"><span class="linenos">377</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Connection.send-378"><a href="#Connection.send-378"><span class="linenos">378</span></a><span class="sd">        Sends an HTTP request and waits for the response.</span>
</span><span id="Connection.send-379"><a href="#Connection.send-379"><span class="linenos">379</span></a>
</span><span id="Connection.send-380"><a href="#Connection.send-380"><span class="linenos">380</span></a><span class="sd">        This method is intended for internal use by other components of the</span>
</span><span id="Connection.send-381"><a href="#Connection.send-381"><span class="linenos">381</span></a><span class="sd">        SDK. Refrain from using it directly, as backwards compatibility isn&#39;t</span>
</span><span id="Connection.send-382"><a href="#Connection.send-382"><span class="linenos">382</span></a><span class="sd">        guaranteed.</span>
</span><span id="Connection.send-383"><a href="#Connection.send-383"><span class="linenos">383</span></a>
</span><span id="Connection.send-384"><a href="#Connection.send-384"><span class="linenos">384</span></a><span class="sd">        This method supports the following parameters.</span>
</span><span id="Connection.send-385"><a href="#Connection.send-385"><span class="linenos">385</span></a>
</span><span id="Connection.send-386"><a href="#Connection.send-386"><span class="linenos">386</span></a><span class="sd">        `request` \n</span>
</span><span id="Connection.send-387"><a href="#Connection.send-387"><span class="linenos">387</span></a><span class="sd">        The Request object containing the details of the HTTP</span>
</span><span id="Connection.send-388"><a href="#Connection.send-388"><span class="linenos">388</span></a><span class="sd">        request to send.</span>
</span><span id="Connection.send-389"><a href="#Connection.send-389"><span class="linenos">389</span></a>
</span><span id="Connection.send-390"><a href="#Connection.send-390"><span class="linenos">390</span></a><span class="sd">        The returned value is a Request object containing the details of the</span>
</span><span id="Connection.send-391"><a href="#Connection.send-391"><span class="linenos">391</span></a><span class="sd">        HTTP response received.</span>
</span><span id="Connection.send-392"><a href="#Connection.send-392"><span class="linenos">392</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Connection.send-393"><a href="#Connection.send-393"><span class="linenos">393</span></a>
</span><span id="Connection.send-394"><a href="#Connection.send-394"><span class="linenos">394</span></a>        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_curl_lock</span><span class="p">:</span>
</span><span id="Connection.send-395"><a href="#Connection.send-395"><span class="linenos">395</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__send</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Sends an HTTP request and waits for the response.</p>

<p>This method is intended for internal use by other components of the
SDK. Refrain from using it directly, as backwards compatibility isn't
guaranteed.</p>

<p>This method supports the following parameters.</p>

<p><code>request</code> </p>

<p>The Request object containing the details of the HTTP
request to send.</p>

<p>The returned value is a Request object containing the details of the
HTTP response received.</p>
</div>


                            </div>
                            <div id="Connection.authenticate" class="classattr">
                                        <input id="Connection.authenticate-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">authenticate</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Connection.authenticate-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Connection.authenticate"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Connection.authenticate-397"><a href="#Connection.authenticate-397"><span class="linenos">397</span></a>    <span class="k">def</span> <span class="nf">authenticate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Connection.authenticate-398"><a href="#Connection.authenticate-398"><span class="linenos">398</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Connection.authenticate-399"><a href="#Connection.authenticate-399"><span class="linenos">399</span></a><span class="sd">        Return token which can be used for authentication instead of credentials.</span>
</span><span id="Connection.authenticate-400"><a href="#Connection.authenticate-400"><span class="linenos">400</span></a><span class="sd">        It will be created, if it not exists, yet. By default the token will be</span>
</span><span id="Connection.authenticate-401"><a href="#Connection.authenticate-401"><span class="linenos">401</span></a><span class="sd">        revoked when the connection is closed, unless the `logout` parameter of</span>
</span><span id="Connection.authenticate-402"><a href="#Connection.authenticate-402"><span class="linenos">402</span></a><span class="sd">        the `close` method is `False`.</span>
</span><span id="Connection.authenticate-403"><a href="#Connection.authenticate-403"><span class="linenos">403</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Connection.authenticate-404"><a href="#Connection.authenticate-404"><span class="linenos">404</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Connection.authenticate-405"><a href="#Connection.authenticate-405"><span class="linenos">405</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sso_token</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Connection.authenticate-406"><a href="#Connection.authenticate-406"><span class="linenos">406</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_sso_token</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_access_token</span><span class="p">()</span>
</span><span id="Connection.authenticate-407"><a href="#Connection.authenticate-407"><span class="linenos">407</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sso_token</span>
</span><span id="Connection.authenticate-408"><a href="#Connection.authenticate-408"><span class="linenos">408</span></a>        <span class="k">except</span> <span class="n">pycurl</span><span class="o">.</span><span class="n">error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="Connection.authenticate-409"><a href="#Connection.authenticate-409"><span class="linenos">409</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__parse_error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return token which can be used for authentication instead of credentials.
It will be created, if it not exists, yet. By default the token will be
revoked when the connection is closed, unless the <code>logout</code> parameter of
the <code><a href="#Connection.close">close</a></code> method is <code>False</code>.</p>
</div>


                            </div>
                            <div id="Connection.wait" class="classattr">
                                        <input id="Connection.wait-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">wait</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">context</span>, </span><span class="param"><span class="n">failed_auth</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Connection.wait-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Connection.wait"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Connection.wait-517"><a href="#Connection.wait-517"><span class="linenos">517</span></a>    <span class="k">def</span> <span class="nf">wait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">failed_auth</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="Connection.wait-518"><a href="#Connection.wait-518"><span class="linenos">518</span></a>        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_curl_lock</span><span class="p">:</span>
</span><span id="Connection.wait-519"><a href="#Connection.wait-519"><span class="linenos">519</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="Connection.wait-520"><a href="#Connection.wait-520"><span class="linenos">520</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__wait</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">failed_auth</span><span class="p">)</span>
</span><span id="Connection.wait-521"><a href="#Connection.wait-521"><span class="linenos">521</span></a>            <span class="k">except</span> <span class="n">pycurl</span><span class="o">.</span><span class="n">error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="Connection.wait-522"><a href="#Connection.wait-522"><span class="linenos">522</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">__parse_error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="Connection.url" class="classattr">
                                        <input id="Connection.url-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">url</span>

                <label class="view-source-button" for="Connection.url-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Connection.url"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Connection.url-558"><a href="#Connection.url-558"><span class="linenos">558</span></a>    <span class="nd">@property</span>
</span><span id="Connection.url-559"><a href="#Connection.url-559"><span class="linenos">559</span></a>    <span class="k">def</span> <span class="nf">url</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Connection.url-560"><a href="#Connection.url-560"><span class="linenos">560</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Connection.url-561"><a href="#Connection.url-561"><span class="linenos">561</span></a><span class="sd">        Returns a string containing the base URL used by this connection.</span>
</span><span id="Connection.url-562"><a href="#Connection.url-562"><span class="linenos">562</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Connection.url-563"><a href="#Connection.url-563"><span class="linenos">563</span></a>
</span><span id="Connection.url-564"><a href="#Connection.url-564"><span class="linenos">564</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_url</span>
</span></pre></div>


            <div class="docstring"><p>Returns a string containing the base URL used by this connection.</p>
</div>


                            </div>
                            <div id="Connection.system_service" class="classattr">
                                        <input id="Connection.system_service-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">system_service</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Connection.system_service-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Connection.system_service"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Connection.system_service-730"><a href="#Connection.system_service-730"><span class="linenos">730</span></a>    <span class="k">def</span> <span class="nf">system_service</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Connection.system_service-731"><a href="#Connection.system_service-731"><span class="linenos">731</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Connection.system_service-732"><a href="#Connection.system_service-732"><span class="linenos">732</span></a><span class="sd">        Returns the reference to the root of the services tree.</span>
</span><span id="Connection.system_service-733"><a href="#Connection.system_service-733"><span class="linenos">733</span></a>
</span><span id="Connection.system_service-734"><a href="#Connection.system_service-734"><span class="linenos">734</span></a><span class="sd">        The returned value is an instance of the `SystemService` class.</span>
</span><span id="Connection.system_service-735"><a href="#Connection.system_service-735"><span class="linenos">735</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Connection.system_service-736"><a href="#Connection.system_service-736"><span class="linenos">736</span></a>
</span><span id="Connection.system_service-737"><a href="#Connection.system_service-737"><span class="linenos">737</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__system_service</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Connection.system_service-738"><a href="#Connection.system_service-738"><span class="linenos">738</span></a>            <span class="kn">from</span> <span class="nn">ovirtsdk4.services</span> <span class="kn">import</span> <span class="n">SystemService</span>
</span><span id="Connection.system_service-739"><a href="#Connection.system_service-739"><span class="linenos">739</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__system_service</span> <span class="o">=</span> <span class="n">SystemService</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="Connection.system_service-740"><a href="#Connection.system_service-740"><span class="linenos">740</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__system_service</span>
</span></pre></div>


            <div class="docstring"><p>Returns the reference to the root of the services tree.</p>

<p>The returned value is an instance of the <code>SystemService</code> class.</p>
</div>


                            </div>
                            <div id="Connection.service" class="classattr">
                                        <input id="Connection.service-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">service</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">path</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Connection.service-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Connection.service"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Connection.service-742"><a href="#Connection.service-742"><span class="linenos">742</span></a>    <span class="k">def</span> <span class="nf">service</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
</span><span id="Connection.service-743"><a href="#Connection.service-743"><span class="linenos">743</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Connection.service-744"><a href="#Connection.service-744"><span class="linenos">744</span></a><span class="sd">        Returns a reference to the service corresponding to the given</span>
</span><span id="Connection.service-745"><a href="#Connection.service-745"><span class="linenos">745</span></a><span class="sd">        path. For example, if the `path` parameter is</span>
</span><span id="Connection.service-746"><a href="#Connection.service-746"><span class="linenos">746</span></a><span class="sd">        `vms/123/diskattachments` then it will return a reference to</span>
</span><span id="Connection.service-747"><a href="#Connection.service-747"><span class="linenos">747</span></a><span class="sd">        the service that manages the disk attachments for the virtual</span>
</span><span id="Connection.service-748"><a href="#Connection.service-748"><span class="linenos">748</span></a><span class="sd">        machine with identifier `123`.</span>
</span><span id="Connection.service-749"><a href="#Connection.service-749"><span class="linenos">749</span></a>
</span><span id="Connection.service-750"><a href="#Connection.service-750"><span class="linenos">750</span></a><span class="sd">        If there is no service corresponding to the given path an exception</span>
</span><span id="Connection.service-751"><a href="#Connection.service-751"><span class="linenos">751</span></a><span class="sd">        will be raised.</span>
</span><span id="Connection.service-752"><a href="#Connection.service-752"><span class="linenos">752</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Connection.service-753"><a href="#Connection.service-753"><span class="linenos">753</span></a>
</span><span id="Connection.service-754"><a href="#Connection.service-754"><span class="linenos">754</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">system_service</span><span class="p">()</span><span class="o">.</span><span class="n">service</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Returns a reference to the service corresponding to the given
path. For example, if the <code>path</code> parameter is
<code>vms/123/diskattachments</code> then it will return a reference to
the service that manages the disk attachments for the virtual
machine with identifier <code>123</code>.</p>

<p>If there is no service corresponding to the given path an exception
will be raised.</p>
</div>


                            </div>
                            <div id="Connection.test" class="classattr">
                                        <input id="Connection.test-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">test</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">raise_exception</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Connection.test-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Connection.test"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Connection.test-756"><a href="#Connection.test-756"><span class="linenos">756</span></a>    <span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raise_exception</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="Connection.test-757"><a href="#Connection.test-757"><span class="linenos">757</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Connection.test-758"><a href="#Connection.test-758"><span class="linenos">758</span></a><span class="sd">        Tests the connectivity with the server. If connectivity works</span>
</span><span id="Connection.test-759"><a href="#Connection.test-759"><span class="linenos">759</span></a><span class="sd">        correctly it returns `True`. If there is any connectivy problem</span>
</span><span id="Connection.test-760"><a href="#Connection.test-760"><span class="linenos">760</span></a><span class="sd">        it will either return `False` or raise an exception if the</span>
</span><span id="Connection.test-761"><a href="#Connection.test-761"><span class="linenos">761</span></a><span class="sd">        `raise_exception` parameter is `True`.</span>
</span><span id="Connection.test-762"><a href="#Connection.test-762"><span class="linenos">762</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Connection.test-763"><a href="#Connection.test-763"><span class="linenos">763</span></a>
</span><span id="Connection.test-764"><a href="#Connection.test-764"><span class="linenos">764</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Connection.test-765"><a href="#Connection.test-765"><span class="linenos">765</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">system_service</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</span><span id="Connection.test-766"><a href="#Connection.test-766"><span class="linenos">766</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="Connection.test-767"><a href="#Connection.test-767"><span class="linenos">767</span></a>        <span class="k">except</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="Connection.test-768"><a href="#Connection.test-768"><span class="linenos">768</span></a>            <span class="k">if</span> <span class="n">raise_exception</span><span class="p">:</span>
</span><span id="Connection.test-769"><a href="#Connection.test-769"><span class="linenos">769</span></a>                <span class="k">raise</span>
</span><span id="Connection.test-770"><a href="#Connection.test-770"><span class="linenos">770</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Connection.test-771"><a href="#Connection.test-771"><span class="linenos">771</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="Connection.test-772"><a href="#Connection.test-772"><span class="linenos">772</span></a>            <span class="k">if</span> <span class="n">raise_exception</span><span class="p">:</span>
</span><span id="Connection.test-773"><a href="#Connection.test-773"><span class="linenos">773</span></a>                <span class="k">raise</span> <span class="n">Error</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="Connection.test-774"><a href="#Connection.test-774"><span class="linenos">774</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span></pre></div>


            <div class="docstring"><p>Tests the connectivity with the server. If connectivity works
correctly it returns <code>True</code>. If there is any connectivy problem
it will either return <code>False</code> or raise an exception if the
<code>raise_exception</code> parameter is <code>True</code>.</p>
</div>


                            </div>
                            <div id="Connection.is_link" class="classattr">
                                        <input id="Connection.is_link-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_link</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">obj</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Connection.is_link-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Connection.is_link"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Connection.is_link-776"><a href="#Connection.is_link-776"><span class="linenos">776</span></a>    <span class="k">def</span> <span class="nf">is_link</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
</span><span id="Connection.is_link-777"><a href="#Connection.is_link-777"><span class="linenos">777</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Connection.is_link-778"><a href="#Connection.is_link-778"><span class="linenos">778</span></a><span class="sd">        Indicates if the given object is a link. An object is a link if</span>
</span><span id="Connection.is_link-779"><a href="#Connection.is_link-779"><span class="linenos">779</span></a><span class="sd">        it has an `href` attribute.</span>
</span><span id="Connection.is_link-780"><a href="#Connection.is_link-780"><span class="linenos">780</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Connection.is_link-781"><a href="#Connection.is_link-781"><span class="linenos">781</span></a>
</span><span id="Connection.is_link-782"><a href="#Connection.is_link-782"><span class="linenos">782</span></a>        <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">href</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span></pre></div>


            <div class="docstring"><p>Indicates if the given object is a link. An object is a link if
it has an <code>href</code> attribute.</p>
</div>


                            </div>
                            <div id="Connection.follow_link" class="classattr">
                                        <input id="Connection.follow_link-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">follow_link</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">obj</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Connection.follow_link-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Connection.follow_link"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Connection.follow_link-784"><a href="#Connection.follow_link-784"><span class="linenos">784</span></a>    <span class="k">def</span> <span class="nf">follow_link</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
</span><span id="Connection.follow_link-785"><a href="#Connection.follow_link-785"><span class="linenos">785</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Connection.follow_link-786"><a href="#Connection.follow_link-786"><span class="linenos">786</span></a><span class="sd">        Follows the `href` attribute of this object, retrieves the object</span>
</span><span id="Connection.follow_link-787"><a href="#Connection.follow_link-787"><span class="linenos">787</span></a><span class="sd">        and returns it.</span>
</span><span id="Connection.follow_link-788"><a href="#Connection.follow_link-788"><span class="linenos">788</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Connection.follow_link-789"><a href="#Connection.follow_link-789"><span class="linenos">789</span></a>
</span><span id="Connection.follow_link-790"><a href="#Connection.follow_link-790"><span class="linenos">790</span></a>        <span class="c1"># Check that the &quot;href&quot; attribute has a values, as it is needed</span>
</span><span id="Connection.follow_link-791"><a href="#Connection.follow_link-791"><span class="linenos">791</span></a>        <span class="c1"># in order to retrieve the representation of the object:</span>
</span><span id="Connection.follow_link-792"><a href="#Connection.follow_link-792"><span class="linenos">792</span></a>        <span class="n">href</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">href</span>
</span><span id="Connection.follow_link-793"><a href="#Connection.follow_link-793"><span class="linenos">793</span></a>        <span class="k">if</span> <span class="n">href</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Connection.follow_link-794"><a href="#Connection.follow_link-794"><span class="linenos">794</span></a>            <span class="k">raise</span> <span class="n">Error</span><span class="p">(</span>
</span><span id="Connection.follow_link-795"><a href="#Connection.follow_link-795"><span class="linenos">795</span></a>                <span class="s2">&quot;Can&#39;t follow link because the &#39;href&#39; attribute does&#39;t &quot;</span>
</span><span id="Connection.follow_link-796"><a href="#Connection.follow_link-796"><span class="linenos">796</span></a>                <span class="s2">&quot;have a value&quot;</span>
</span><span id="Connection.follow_link-797"><a href="#Connection.follow_link-797"><span class="linenos">797</span></a>            <span class="p">)</span>
</span><span id="Connection.follow_link-798"><a href="#Connection.follow_link-798"><span class="linenos">798</span></a>
</span><span id="Connection.follow_link-799"><a href="#Connection.follow_link-799"><span class="linenos">799</span></a>        <span class="c1"># Check that the value of the &quot;href&quot; attribute is compatible with the</span>
</span><span id="Connection.follow_link-800"><a href="#Connection.follow_link-800"><span class="linenos">800</span></a>        <span class="c1"># base URL of the connection:</span>
</span><span id="Connection.follow_link-801"><a href="#Connection.follow_link-801"><span class="linenos">801</span></a>        <span class="n">prefix</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_url</span><span class="p">)</span><span class="o">.</span><span class="n">path</span>
</span><span id="Connection.follow_link-802"><a href="#Connection.follow_link-802"><span class="linenos">802</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">prefix</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">):</span>
</span><span id="Connection.follow_link-803"><a href="#Connection.follow_link-803"><span class="linenos">803</span></a>            <span class="n">prefix</span> <span class="o">+=</span> <span class="s1">&#39;/&#39;</span>
</span><span id="Connection.follow_link-804"><a href="#Connection.follow_link-804"><span class="linenos">804</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">href</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">prefix</span><span class="p">):</span>
</span><span id="Connection.follow_link-805"><a href="#Connection.follow_link-805"><span class="linenos">805</span></a>            <span class="k">raise</span> <span class="n">Error</span><span class="p">(</span>
</span><span id="Connection.follow_link-806"><a href="#Connection.follow_link-806"><span class="linenos">806</span></a>                <span class="s2">&quot;The URL &#39;</span><span class="si">%s</span><span class="s2">&#39; isn&#39;t compatible with the base URL of the &quot;</span>
</span><span id="Connection.follow_link-807"><a href="#Connection.follow_link-807"><span class="linenos">807</span></a>                <span class="s2">&quot;connection&quot;</span> <span class="o">%</span> <span class="n">href</span>
</span><span id="Connection.follow_link-808"><a href="#Connection.follow_link-808"><span class="linenos">808</span></a>            <span class="p">)</span>
</span><span id="Connection.follow_link-809"><a href="#Connection.follow_link-809"><span class="linenos">809</span></a>
</span><span id="Connection.follow_link-810"><a href="#Connection.follow_link-810"><span class="linenos">810</span></a>        <span class="c1"># Remove the prefix from the URL, follow the path to the relevant</span>
</span><span id="Connection.follow_link-811"><a href="#Connection.follow_link-811"><span class="linenos">811</span></a>        <span class="c1"># service and invoke the &quot;get&quot;, or &quot;list method to retrieve its representation:</span>
</span><span id="Connection.follow_link-812"><a href="#Connection.follow_link-812"><span class="linenos">812</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="n">href</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">prefix</span><span class="p">):]</span>
</span><span id="Connection.follow_link-813"><a href="#Connection.follow_link-813"><span class="linenos">813</span></a>        <span class="n">service</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</span><span id="Connection.follow_link-814"><a href="#Connection.follow_link-814"><span class="linenos">814</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">List</span><span class="p">):</span>
</span><span id="Connection.follow_link-815"><a href="#Connection.follow_link-815"><span class="linenos">815</span></a>            <span class="k">return</span> <span class="n">service</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
</span><span id="Connection.follow_link-816"><a href="#Connection.follow_link-816"><span class="linenos">816</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Connection.follow_link-817"><a href="#Connection.follow_link-817"><span class="linenos">817</span></a>            <span class="k">return</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Follows the <code>href</code> attribute of this object, retrieves the object
and returns it.</p>
</div>


                            </div>
                            <div id="Connection.close" class="classattr">
                                        <input id="Connection.close-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">close</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">logout</span><span class="o">=</span><span class="kc">True</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Connection.close-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Connection.close"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Connection.close-819"><a href="#Connection.close-819"><span class="linenos">819</span></a>    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">logout</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="Connection.close-820"><a href="#Connection.close-820"><span class="linenos">820</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Connection.close-821"><a href="#Connection.close-821"><span class="linenos">821</span></a><span class="sd">        Releases the resources used by this connection.</span>
</span><span id="Connection.close-822"><a href="#Connection.close-822"><span class="linenos">822</span></a>
</span><span id="Connection.close-823"><a href="#Connection.close-823"><span class="linenos">823</span></a><span class="sd">        `logout` A boolean, which specify if token should be revoked,</span>
</span><span id="Connection.close-824"><a href="#Connection.close-824"><span class="linenos">824</span></a><span class="sd">        and so user should be logged out.</span>
</span><span id="Connection.close-825"><a href="#Connection.close-825"><span class="linenos">825</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Connection.close-826"><a href="#Connection.close-826"><span class="linenos">826</span></a>
</span><span id="Connection.close-827"><a href="#Connection.close-827"><span class="linenos">827</span></a>        <span class="c1"># Revoke access token:</span>
</span><span id="Connection.close-828"><a href="#Connection.close-828"><span class="linenos">828</span></a>        <span class="k">if</span> <span class="n">logout</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sso_token</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Connection.close-829"><a href="#Connection.close-829"><span class="linenos">829</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_revoke_access_token</span><span class="p">()</span>
</span><span id="Connection.close-830"><a href="#Connection.close-830"><span class="linenos">830</span></a>
</span><span id="Connection.close-831"><a href="#Connection.close-831"><span class="linenos">831</span></a>        <span class="c1"># Release resources used by the cURL handle:</span>
</span><span id="Connection.close-832"><a href="#Connection.close-832"><span class="linenos">832</span></a>        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_curl_lock</span><span class="p">:</span>
</span><span id="Connection.close-833"><a href="#Connection.close-833"><span class="linenos">833</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_multi</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Releases the resources used by this connection.</p>

<p><code>logout</code> A boolean, which specify if token should be revoked,
and so user should be logged out.</p>
</div>


                            </div>
                            <div id="Connection.check_xml_content_type" class="classattr">
                                        <input id="Connection.check_xml_content_type-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">check_xml_content_type</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">response</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Connection.check_xml_content_type-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Connection.check_xml_content_type"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Connection.check_xml_content_type-862"><a href="#Connection.check_xml_content_type-862"><span class="linenos">862</span></a>    <span class="k">def</span> <span class="nf">check_xml_content_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">response</span><span class="p">):</span>
</span><span id="Connection.check_xml_content_type-863"><a href="#Connection.check_xml_content_type-863"><span class="linenos">863</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Connection.check_xml_content_type-864"><a href="#Connection.check_xml_content_type-864"><span class="linenos">864</span></a><span class="sd">         Checks that the content type of the given response is XML. If it is</span>
</span><span id="Connection.check_xml_content_type-865"><a href="#Connection.check_xml_content_type-865"><span class="linenos">865</span></a><span class="sd">         XML then it does nothing. If it isn&#39;t XML then it raises an</span>
</span><span id="Connection.check_xml_content_type-866"><a href="#Connection.check_xml_content_type-866"><span class="linenos">866</span></a><span class="sd">         exception.</span>
</span><span id="Connection.check_xml_content_type-867"><a href="#Connection.check_xml_content_type-867"><span class="linenos">867</span></a>
</span><span id="Connection.check_xml_content_type-868"><a href="#Connection.check_xml_content_type-868"><span class="linenos">868</span></a><span class="sd">         `response` The HTTP response to check.</span>
</span><span id="Connection.check_xml_content_type-869"><a href="#Connection.check_xml_content_type-869"><span class="linenos">869</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Connection.check_xml_content_type-870"><a href="#Connection.check_xml_content_type-870"><span class="linenos">870</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_content_type</span><span class="p">(</span>
</span><span id="Connection.check_xml_content_type-871"><a href="#Connection.check_xml_content_type-871"><span class="linenos">871</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__XML_CONTENT_TYPE_RE</span><span class="p">,</span>
</span><span id="Connection.check_xml_content_type-872"><a href="#Connection.check_xml_content_type-872"><span class="linenos">872</span></a>            <span class="s1">&#39;XML&#39;</span><span class="p">,</span>
</span><span id="Connection.check_xml_content_type-873"><a href="#Connection.check_xml_content_type-873"><span class="linenos">873</span></a>            <span class="n">response</span><span class="o">.</span><span class="n">headers</span>
</span><span id="Connection.check_xml_content_type-874"><a href="#Connection.check_xml_content_type-874"><span class="linenos">874</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Checks that the content type of the given response is XML. If it is
XML then it does nothing. If it isn't XML then it raises an
exception.</p>

<p><code>response</code> The HTTP response to check.</p>
</div>


                            </div>
                            <div id="Connection.check_json_content_type" class="classattr">
                                        <input id="Connection.check_json_content_type-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">check_json_content_type</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">response</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Connection.check_json_content_type-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Connection.check_json_content_type"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Connection.check_json_content_type-876"><a href="#Connection.check_json_content_type-876"><span class="linenos">876</span></a>    <span class="k">def</span> <span class="nf">check_json_content_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">response</span><span class="p">):</span>
</span><span id="Connection.check_json_content_type-877"><a href="#Connection.check_json_content_type-877"><span class="linenos">877</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Connection.check_json_content_type-878"><a href="#Connection.check_json_content_type-878"><span class="linenos">878</span></a><span class="sd">         Checks that the content type of the given response is JSON. If it is</span>
</span><span id="Connection.check_json_content_type-879"><a href="#Connection.check_json_content_type-879"><span class="linenos">879</span></a><span class="sd">         JSON then it does nothing. If it isn&#39;t JSON then it raises an</span>
</span><span id="Connection.check_json_content_type-880"><a href="#Connection.check_json_content_type-880"><span class="linenos">880</span></a><span class="sd">         exception.</span>
</span><span id="Connection.check_json_content_type-881"><a href="#Connection.check_json_content_type-881"><span class="linenos">881</span></a>
</span><span id="Connection.check_json_content_type-882"><a href="#Connection.check_json_content_type-882"><span class="linenos">882</span></a><span class="sd">         `response` The HTTP response to check.</span>
</span><span id="Connection.check_json_content_type-883"><a href="#Connection.check_json_content_type-883"><span class="linenos">883</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Connection.check_json_content_type-884"><a href="#Connection.check_json_content_type-884"><span class="linenos">884</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_content_type</span><span class="p">(</span>
</span><span id="Connection.check_json_content_type-885"><a href="#Connection.check_json_content_type-885"><span class="linenos">885</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__JSON_CONTENT_TYPE_RE</span><span class="p">,</span>
</span><span id="Connection.check_json_content_type-886"><a href="#Connection.check_json_content_type-886"><span class="linenos">886</span></a>            <span class="s1">&#39;JSON&#39;</span><span class="p">,</span>
</span><span id="Connection.check_json_content_type-887"><a href="#Connection.check_json_content_type-887"><span class="linenos">887</span></a>            <span class="n">response</span><span class="o">.</span><span class="n">headers</span>
</span><span id="Connection.check_json_content_type-888"><a href="#Connection.check_json_content_type-888"><span class="linenos">888</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Checks that the content type of the given response is JSON. If it is
JSON then it does nothing. If it isn't JSON then it raises an
exception.</p>

<p><code>response</code> The HTTP response to check.</p>
</div>


                            </div>
                </section>
                <section id="ConnectionBuilder">
                            <input id="ConnectionBuilder-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">ConnectionBuilder</span>:

                <label class="view-source-button" for="ConnectionBuilder-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ConnectionBuilder"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ConnectionBuilder-1003"><a href="#ConnectionBuilder-1003"><span class="linenos">1003</span></a><span class="k">class</span> <span class="nc">ConnectionBuilder</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span><span id="ConnectionBuilder-1004"><a href="#ConnectionBuilder-1004"><span class="linenos">1004</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ConnectionBuilder-1005"><a href="#ConnectionBuilder-1005"><span class="linenos">1005</span></a><span class="sd">    This class is a mechanism to simplify the repeated creation of</span>
</span><span id="ConnectionBuilder-1006"><a href="#ConnectionBuilder-1006"><span class="linenos">1006</span></a><span class="sd">    multiple connections. It stores the connection parameters given</span>
</span><span id="ConnectionBuilder-1007"><a href="#ConnectionBuilder-1007"><span class="linenos">1007</span></a><span class="sd">    in its constructor, and has a single `build` method that is</span>
</span><span id="ConnectionBuilder-1008"><a href="#ConnectionBuilder-1008"><span class="linenos">1008</span></a><span class="sd">    equivalent to calling the constructor of the `Connection`</span>
</span><span id="ConnectionBuilder-1009"><a href="#ConnectionBuilder-1009"><span class="linenos">1009</span></a><span class="sd">    class. Typical use will be like this:</span>
</span><span id="ConnectionBuilder-1010"><a href="#ConnectionBuilder-1010"><span class="linenos">1010</span></a>
</span><span id="ConnectionBuilder-1011"><a href="#ConnectionBuilder-1011"><span class="linenos">1011</span></a><span class="sd">    ```python</span>
</span><span id="ConnectionBuilder-1012"><a href="#ConnectionBuilder-1012"><span class="linenos">1012</span></a><span class="sd">    # Create the builder once:</span>
</span><span id="ConnectionBuilder-1013"><a href="#ConnectionBuilder-1013"><span class="linenos">1013</span></a><span class="sd">    builder = ConnectionBuilder(</span>
</span><span id="ConnectionBuilder-1014"><a href="#ConnectionBuilder-1014"><span class="linenos">1014</span></a><span class="sd">        url=&#39;https://enginer40.example.com/ovirt-engine/api&#39;,</span>
</span><span id="ConnectionBuilder-1015"><a href="#ConnectionBuilder-1015"><span class="linenos">1015</span></a><span class="sd">        username=&#39;admin@internal&#39;,</span>
</span><span id="ConnectionBuilder-1016"><a href="#ConnectionBuilder-1016"><span class="linenos">1016</span></a><span class="sd">        password=&#39;redhat123&#39;,</span>
</span><span id="ConnectionBuilder-1017"><a href="#ConnectionBuilder-1017"><span class="linenos">1017</span></a><span class="sd">        ca_file=&#39;ca.pem&#39;,</span>
</span><span id="ConnectionBuilder-1018"><a href="#ConnectionBuilder-1018"><span class="linenos">1018</span></a><span class="sd">    )</span>
</span><span id="ConnectionBuilder-1019"><a href="#ConnectionBuilder-1019"><span class="linenos">1019</span></a>
</span><span id="ConnectionBuilder-1020"><a href="#ConnectionBuilder-1020"><span class="linenos">1020</span></a><span class="sd">    # Create and use first connection:</span>
</span><span id="ConnectionBuilder-1021"><a href="#ConnectionBuilder-1021"><span class="linenos">1021</span></a><span class="sd">    with builder.build() as connection:</span>
</span><span id="ConnectionBuilder-1022"><a href="#ConnectionBuilder-1022"><span class="linenos">1022</span></a><span class="sd">       ...</span>
</span><span id="ConnectionBuilder-1023"><a href="#ConnectionBuilder-1023"><span class="linenos">1023</span></a>
</span><span id="ConnectionBuilder-1024"><a href="#ConnectionBuilder-1024"><span class="linenos">1024</span></a><span class="sd">    # Create and use a second connection:</span>
</span><span id="ConnectionBuilder-1025"><a href="#ConnectionBuilder-1025"><span class="linenos">1025</span></a><span class="sd">    with builder.build() as connection:</span>
</span><span id="ConnectionBuilder-1026"><a href="#ConnectionBuilder-1026"><span class="linenos">1026</span></a><span class="sd">       ...</span>
</span><span id="ConnectionBuilder-1027"><a href="#ConnectionBuilder-1027"><span class="linenos">1027</span></a><span class="sd">    ```</span>
</span><span id="ConnectionBuilder-1028"><a href="#ConnectionBuilder-1028"><span class="linenos">1028</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="ConnectionBuilder-1029"><a href="#ConnectionBuilder-1029"><span class="linenos">1029</span></a>
</span><span id="ConnectionBuilder-1030"><a href="#ConnectionBuilder-1030"><span class="linenos">1030</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="ConnectionBuilder-1031"><a href="#ConnectionBuilder-1031"><span class="linenos">1031</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ConnectionBuilder-1032"><a href="#ConnectionBuilder-1032"><span class="linenos">1032</span></a><span class="sd">        Creates a new connection builder. The parameters are the same</span>
</span><span id="ConnectionBuilder-1033"><a href="#ConnectionBuilder-1033"><span class="linenos">1033</span></a><span class="sd">        accepted by the constructor of the `Connnection` class.</span>
</span><span id="ConnectionBuilder-1034"><a href="#ConnectionBuilder-1034"><span class="linenos">1034</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ConnectionBuilder-1035"><a href="#ConnectionBuilder-1035"><span class="linenos">1035</span></a>
</span><span id="ConnectionBuilder-1036"><a href="#ConnectionBuilder-1036"><span class="linenos">1036</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>
</span><span id="ConnectionBuilder-1037"><a href="#ConnectionBuilder-1037"><span class="linenos">1037</span></a>
</span><span id="ConnectionBuilder-1038"><a href="#ConnectionBuilder-1038"><span class="linenos">1038</span></a>    <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ConnectionBuilder-1039"><a href="#ConnectionBuilder-1039"><span class="linenos">1039</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ConnectionBuilder-1040"><a href="#ConnectionBuilder-1040"><span class="linenos">1040</span></a><span class="sd">        Creates a new connection using the parameters passed to the</span>
</span><span id="ConnectionBuilder-1041"><a href="#ConnectionBuilder-1041"><span class="linenos">1041</span></a><span class="sd">        constructor, and returns it.</span>
</span><span id="ConnectionBuilder-1042"><a href="#ConnectionBuilder-1042"><span class="linenos">1042</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ConnectionBuilder-1043"><a href="#ConnectionBuilder-1043"><span class="linenos">1043</span></a>
</span><span id="ConnectionBuilder-1044"><a href="#ConnectionBuilder-1044"><span class="linenos">1044</span></a>        <span class="k">return</span> <span class="n">Connection</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>This class is a mechanism to simplify the repeated creation of
multiple connections. It stores the connection parameters given
in its constructor, and has a single <code><a href="#ConnectionBuilder.build">build</a></code> method that is
equivalent to calling the constructor of the <code><a href="#Connection">Connection</a></code>
class. Typical use will be like this:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="c1"># Create the builder once:</span>
<span class="n">builder</span> <span class="o">=</span> <span class="n">ConnectionBuilder</span><span class="p">(</span>
    <span class="n">url</span><span class="o">=</span><span class="s1">&#39;https://enginer40.example.com/ovirt-engine/api&#39;</span><span class="p">,</span>
    <span class="n">username</span><span class="o">=</span><span class="s1">&#39;admin@internal&#39;</span><span class="p">,</span>
    <span class="n">password</span><span class="o">=</span><span class="s1">&#39;redhat123&#39;</span><span class="p">,</span>
    <span class="n">ca_file</span><span class="o">=</span><span class="s1">&#39;ca.pem&#39;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Create and use first connection:</span>
<span class="k">with</span> <span class="n">builder</span><span class="o">.</span><span class="n">build</span><span class="p">()</span> <span class="k">as</span> <span class="n">connection</span><span class="p">:</span>
   <span class="o">...</span>

<span class="c1"># Create and use a second connection:</span>
<span class="k">with</span> <span class="n">builder</span><span class="o">.</span><span class="n">build</span><span class="p">()</span> <span class="k">as</span> <span class="n">connection</span><span class="p">:</span>
   <span class="o">...</span>
</code></pre>
</div>
</div>


                            <div id="ConnectionBuilder.__init__" class="classattr">
                                        <input id="ConnectionBuilder.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">ConnectionBuilder</span><span class="signature pdoc-code condensed">(<span class="param"><span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="ConnectionBuilder.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ConnectionBuilder.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ConnectionBuilder.__init__-1030"><a href="#ConnectionBuilder.__init__-1030"><span class="linenos">1030</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="ConnectionBuilder.__init__-1031"><a href="#ConnectionBuilder.__init__-1031"><span class="linenos">1031</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ConnectionBuilder.__init__-1032"><a href="#ConnectionBuilder.__init__-1032"><span class="linenos">1032</span></a><span class="sd">        Creates a new connection builder. The parameters are the same</span>
</span><span id="ConnectionBuilder.__init__-1033"><a href="#ConnectionBuilder.__init__-1033"><span class="linenos">1033</span></a><span class="sd">        accepted by the constructor of the `Connnection` class.</span>
</span><span id="ConnectionBuilder.__init__-1034"><a href="#ConnectionBuilder.__init__-1034"><span class="linenos">1034</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ConnectionBuilder.__init__-1035"><a href="#ConnectionBuilder.__init__-1035"><span class="linenos">1035</span></a>
</span><span id="ConnectionBuilder.__init__-1036"><a href="#ConnectionBuilder.__init__-1036"><span class="linenos">1036</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>
</span></pre></div>


            <div class="docstring"><p>Creates a new connection builder. The parameters are the same
accepted by the constructor of the <code>Connnection</code> class.</p>
</div>


                            </div>
                            <div id="ConnectionBuilder.build" class="classattr">
                                        <input id="ConnectionBuilder.build-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">build</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ConnectionBuilder.build-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ConnectionBuilder.build"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ConnectionBuilder.build-1038"><a href="#ConnectionBuilder.build-1038"><span class="linenos">1038</span></a>    <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ConnectionBuilder.build-1039"><a href="#ConnectionBuilder.build-1039"><span class="linenos">1039</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ConnectionBuilder.build-1040"><a href="#ConnectionBuilder.build-1040"><span class="linenos">1040</span></a><span class="sd">        Creates a new connection using the parameters passed to the</span>
</span><span id="ConnectionBuilder.build-1041"><a href="#ConnectionBuilder.build-1041"><span class="linenos">1041</span></a><span class="sd">        constructor, and returns it.</span>
</span><span id="ConnectionBuilder.build-1042"><a href="#ConnectionBuilder.build-1042"><span class="linenos">1042</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ConnectionBuilder.build-1043"><a href="#ConnectionBuilder.build-1043"><span class="linenos">1043</span></a>
</span><span id="ConnectionBuilder.build-1044"><a href="#ConnectionBuilder.build-1044"><span class="linenos">1044</span></a>        <span class="k">return</span> <span class="n">Connection</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Creates a new connection using the parameters passed to the
constructor, and returns it.</p>
</div>


                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>